<b> : </b>How can I tell how many tokens a string has before I embed it?<svg aria-hidden=true class=anchor-heading-icon xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 20 20" stroke-width="0" fill="currentColor" stroke="currentColor"><path clip-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" fill-rule="evenodd"></path></svg></H3></A></DIV>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; MARGIN-BOTTOM: 15px; FONT-FAMILY: S&#246;hne, helvetica, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(53,55,64); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; LINE-HEIGHT: 1.5; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; scrollbar-width: thin; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">In Python, you can split a string into tokens with OpenAI's tokenizer<SPAN>&nbsp;</SPAN><A style="BOX-SIZING: border-box; CURSOR: pointer; TEXT-DECORATION: none; COLOR: ; scrollbar-width: thin" href="https://github.com/openai/tiktoken" rel="noopener noreferrer" target=_blank><CODE style="BOX-SIZING: border-box; FONT-SIZE: 14px; BORDER-TOP: 0px; FONT-FAMILY: var(--monospace); BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px; FONT-WEIGHT: 500; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0.3em; BORDER-LEFT: 0px; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 0.3em; scrollbar-width: thin; border-radius: 4px; background-size: ; background-origin: ; background-clip: ; box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 0px 1px">tiktoken</CODE></A>.</P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; MARGIN-BOTTOM: 15px; FONT-FAMILY: S&#246;hne, helvetica, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(53,55,64); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; LINE-HEIGHT: 1.5; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; scrollbar-width: thin; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">Example code:</P>
<DIV class=code-sample style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: S&#246;hne, helvetica, sans-serif; BACKGROUND: none transparent scroll repeat 0% 0%; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(53,55,64); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 24px 0px; DISPLAY: flex; LETTER-SPACING: normal; TEXT-INDENT: 0px; scrollbar-width: thin; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; border-radius: 8px; flex-direction: column">
<DIV class="code-sample-body code-sample-body-large" style="BOX-SIZING: border-box; POSITION: relative; scrollbar-width: thin; flex-shrink: 0; flex-grow: 1"><PRE class="hljs syntax-highlighter dark-mode code-sample-pre" style="BOX-SIZING: border-box; FONT-SIZE: 15px; HEIGHT: 240px; FONT-FAMILY: var(--monospace); BACKGROUND: none transparent scroll repeat 0% 0%; OVERFLOW-X: auto; COLOR: ; PADDING-BOTTOM: 12px; PADDING-TOP: 12px; PADDING-LEFT: 16px; MIN-HEIGHT: 44px; MARGIN: 0px; LINE-HEIGHT: 24px; PADDING-RIGHT: 16px; scrollbar-width: thin; border-radius: 8px; --sh-fg: 25, 25, 39; --sh-bg: var(--code-snippet-bg)"><CODE class=language-python style="BOX-SIZING: border-box; FONT-FAMILY: var(--monospace); WHITE-SPACE: pre; scrollbar-width: thin"><CODE style="BOX-SIZING: border-box; FONT-FAMILY: var(--monospace); FLOAT: left; PADDING-RIGHT: 10px; scrollbar-width: thin"><SPAN class=react-syntax-highlighter-line-number style="BOX-SIZING: border-box; COLOR: ; scrollbar-width: thin; user-select: none">1
</SPAN><SPAN class=react-syntax-highlighter-line-number style="BOX-SIZING: border-box; COLOR: ; scrollbar-width: thin; user-select: none">2
</SPAN><SPAN class=react-syntax-highlighter-line-number style="BOX-SIZING: border-box; COLOR: ; scrollbar-width: thin; user-select: none">3
</SPAN><SPAN class=react-syntax-highlighter-line-number style="BOX-SIZING: border-box; COLOR: ; scrollbar-width: thin; user-select: none">4
</SPAN><SPAN class=react-syntax-highlighter-line-number style="BOX-SIZING: border-box; COLOR: ; scrollbar-width: thin; user-select: none">5
</SPAN><SPAN class=react-syntax-highlighter-line-number style="BOX-SIZING: border-box; COLOR: ; scrollbar-width: thin; user-select: none">6
</SPAN><SPAN class=react-syntax-highlighter-line-number style="BOX-SIZING: border-box; COLOR: ; scrollbar-width: thin; user-select: none">7
</SPAN><SPAN class=react-syntax-highlighter-line-number style="BOX-SIZING: border-box; COLOR: ; scrollbar-width: thin; user-select: none">8
</SPAN><SPAN class=react-syntax-highlighter-line-number style="BOX-SIZING: border-box; COLOR: ; scrollbar-width: thin; user-select: none">9
</SPAN></CODE><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin"><SPAN class=hljs-keyword style="BOX-SIZING: border-box; COLOR: rgb(46,149,211); scrollbar-width: thin">import</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin"> tiktoken
</SPAN></SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">
</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin"><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin"></SPAN><SPAN class="hljs-function hljs-keyword" style="BOX-SIZING: border-box; COLOR: rgb(46,149,211); scrollbar-width: thin">def</SPAN><SPAN class=hljs-function style="BOX-SIZING: border-box; scrollbar-width: thin"> </SPAN><SPAN class="hljs-function hljs-title" style="BOX-SIZING: border-box; COLOR: rgb(242,44,61); scrollbar-width: thin">num_tokens_from_string</SPAN><SPAN class=hljs-function style="BOX-SIZING: border-box; scrollbar-width: thin">(</SPAN><SPAN class="hljs-function hljs-params" style="BOX-SIZING: border-box; scrollbar-width: thin">string: </SPAN><SPAN class="hljs-function hljs-params hljs-built_in" style="BOX-SIZING: border-box; COLOR: rgb(233,149,12); scrollbar-width: thin">str</SPAN><SPAN class="hljs-function hljs-params" style="BOX-SIZING: border-box; scrollbar-width: thin">, encoding_name: </SPAN><SPAN class="hljs-function hljs-params hljs-built_in" style="BOX-SIZING: border-box; COLOR: rgb(233,149,12); scrollbar-width: thin">str</SPAN><SPAN class=hljs-function style="BOX-SIZING: border-box; scrollbar-width: thin">) -&gt; </SPAN><SPAN class="hljs-function hljs-built_in" style="BOX-SIZING: border-box; COLOR: rgb(233,149,12); scrollbar-width: thin">int</SPAN><SPAN class=hljs-function style="BOX-SIZING: border-box; scrollbar-width: thin">:</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">
</SPAN></SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin"><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">    </SPAN><SPAN class=hljs-string style="BOX-SIZING: border-box; COLOR: rgb(0,166,125); scrollbar-width: thin">"""Returns the number of tokens in a text string."""</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">
</SPAN></SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">    encoding = tiktoken.get_encoding(encoding_name)
</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin"><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">    num_tokens = </SPAN><SPAN class=hljs-built_in style="BOX-SIZING: border-box; COLOR: rgb(233,149,12); scrollbar-width: thin">len</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">(encoding.encode(string))
</SPAN></SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin"><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">    </SPAN><SPAN class=hljs-keyword style="BOX-SIZING: border-box; COLOR: rgb(46,149,211); scrollbar-width: thin">return</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin"> num_tokens
</SPAN></SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">
</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin"><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">num_tokens_from_string(</SPAN><SPAN class=hljs-string style="BOX-SIZING: border-box; COLOR: rgb(0,166,125); scrollbar-width: thin">"tiktoken is great!"</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">, </SPAN><SPAN class=hljs-string style="BOX-SIZING: border-box; COLOR: rgb(0,166,125); scrollbar-width: thin">"cl100k_base"</SPAN><SPAN style="BOX-SIZING: border-box; scrollbar-width: thin">)</SPAN></SPAN></CODE></PRE></DIV></DIV>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; MARGIN-BOTTOM: 15px; FONT-FAMILY: S&#246;hne, helvetica, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(53,55,64); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; LINE-HEIGHT: 1.5; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; scrollbar-width: thin; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">For third-generation embedding models like<SPAN>&nbsp;</SPAN><CODE style="BOX-SIZING: border-box; FONT-SIZE: 14px; BORDER-TOP: 0px; FONT-FAMILY: var(--monospace); BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px; FONT-WEIGHT: 500; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0.3em; BORDER-LEFT: 0px; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 0.3em; scrollbar-width: thin; border-radius: 4px; background-size: ; background-origin: ; background-clip: ; box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 0px 1px">text-embedding-3-small</CODE>, use the<SPAN>&nbsp;</SPAN><CODE style="BOX-SIZING: border-box; FONT-SIZE: 14px; BORDER-TOP: 0px; FONT-FAMILY: var(--monospace); BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px; FONT-WEIGHT: 500; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0.3em; BORDER-LEFT: 0px; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 0.3em; scrollbar-width: thin; border-radius: 4px; background-size: ; background-origin: ; background-clip: ; box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 0px 1px">cl100k_base</CODE><SPAN>&nbsp;</SPAN>encoding.</P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; MARGIN-BOTTOM: 15px; FONT-FAMILY: S&#246;hne, helvetica, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(53,55,64); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; LINE-HEIGHT: 1.5; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; scrollbar-width: thin; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">More details and example code are in the OpenAI Cookbook guide<SPAN>&nbsp;</SPAN><A style="BOX-SIZING: border-box; CURSOR: pointer; TEXT-DECORATION: none; COLOR: ; scrollbar-width: thin" href="https://cookbook.openai.com/examples/how_to_count_tokens_with_tiktoken" rel="noopener noreferrer" target=_blank>how to count tokens with tiktoken</A>.</P>
<DIV class=anchor-heading-root style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: S&#246;hne, helvetica, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(53,55,64); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; scrollbar-width: thin; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><A class=anchor-heading-link style="BOX-SIZING: border-box; CURSOR: pointer; TEXT-DECORATION: none; COLOR: ; DISPLAY: inline-block; scrollbar-width: thin" href="https://platform.openai.com/docs/guides/embeddings/how-can-i-retrieve-k-nearest-embedding-vectors-quickly">