<b> : </b>Local Area</H4>
<P style="BOX-SIZING: border-box; MARGIN: 0px 0px 10px"><IMG style="BOX-SIZING: border-box; BORDER-TOP: 0px; BORDER-RIGHT: 0px; VERTICAL-ALIGN: middle; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px" alt="local area" src="https://xuezhaokun.github.io/150-algorithm/img/local_area.png" width="45%" align=right height=200>The local area consists of the set of nodes that a process must have full control of to ensure successful completion of an operation. As we see, the local area for insertion is just made of nodes involved in the rotation fix-up operation. With the local area concept, if several concurrents in a localized region have overlapping areas, only the one that obtains all the flags in its local area will be able to proceed. Other concurrents will have to re-attempt to gain control of their local areas. As one insertion concurrent completes its processing in one part of the tree, it may either finish entirely (and release all its flags) or move up the tree. In the later case, the concurrent first obtains the flags of nodes in its new local area, moves up, and then releases the flags that it set for the nodes in its old local area. Releasing flags allows other processes that may have been waiting to advance. The figure on the right shows the "local area" defined by Ma. The following slides demonstrate how local area works for insertion case 1.</P>
<DIV id=local-arae-demo class="carousel slide" style="BOX-SIZING: border-box; WIDTH: 585px; POSITION: relative" data-ride="carousel">
<DIV class=carousel-inner style="BOX-SIZING: border-box; OVERFLOW: hidden; WIDTH: 585px; POSITION: relative">
<DIV class="item active" style="BOX-SIZING: border-box; POSITION: relative; LEFT: 0px; DISPLAY: block; transition: transform 0.6s ease-in-out; backface-visibility: hidden; perspective: 1000px; transform: translate3d(0px, 0px, 0px)"><IMG style="BOX-SIZING: border-box; MAX-WIDTH: 100%; BORDER-TOP: 0px; HEIGHT: auto; BORDER-RIGHT: 0px; WIDTH: 585px; VERTICAL-ALIGN: middle; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; DISPLAY: block; LINE-HEIGHT: 1" alt="Step 1" src="https://xuezhaokun.github.io/150-algorithm/img/local_area_demo/Slide1.gif"></DIV></DIV><A class="left carousel-control ui-link" style="BOX-SIZING: border-box; FONT-SIZE: 20px; TEXT-DECORATION: none; WIDTH: 87px; BACKGROUND-REPEAT: repeat-x; POSITION: absolute; FONT-WEIGHT: 700; COLOR: rgb(51,136,204); TEXT-ALIGN: center; LEFT: 0px; TOP: 0px; BOTTOM: 0px; text-shadow: rgba(0, 0, 0, 0.6) 0px 1px 2px; opacity: 0.5" href="https://xuezhaokun.github.io/150-algorithm/#local-arae-demo" data-slide="prev"><SPAN class="glyphicon glyphicon-chevron-left" style='BOX-SIZING: border-box; FONT-SIZE: 30px; HEIGHT: 30px; FONT-FAMILY: "Glyphicons Halflings"; WIDTH: 30px; MARGIN-TOP: -10px; POSITION: absolute; FONT-WEIGHT: 400; FONT-STYLE: normal; MARGIN-LEFT: -10px; LEFT: 43px; Z-INDEX: 5; DISPLAY: inline-block; LINE-HEIGHT: 1; TOP: 164px; -webkit-font-smoothing: antialiased'></SPAN><SPAN class=sr-only style="BOX-SIZING: border-box; OVERFLOW: hidden; BORDER-TOP: 0px; CLIP: rect(0px 0px 0px 0px); HEIGHT: 1px; BORDER-RIGHT: 0px; WIDTH: 1px; BORDER-BOTTOM: 0px; POSITION: absolute; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; BORDER-LEFT: 0px; MARGIN: -1px; PADDING-RIGHT: 0px">Previous</SPAN></A><A class="right carousel-control ui-link" style="BOX-SIZING: border-box; FONT-SIZE: 20px; TEXT-DECORATION: none; WIDTH: 87px; BACKGROUND-REPEAT: repeat-x; POSITION: absolute; FONT-WEIGHT: 700; COLOR: rgb(51,136,204); TEXT-ALIGN: center; text-shadow: rgba(0, 0, 0, 0.6) 0px 1px 2px; opacity: 0.5; inset: 0px 0px 0px auto" href="https://xuezhaokun.github.io/150-algorithm/#local-arae-demo" data-slide="next"><SPAN class="glyphicon glyphicon-chevron-right" style='BOX-SIZING: border-box; FONT-SIZE: 30px; HEIGHT: 30px; FONT-FAMILY: "Glyphicons Halflings"; WIDTH: 30px; RIGHT: 43px; MARGIN-TOP: -10px; POSITION: absolute; FONT-WEIGHT: 400; FONT-STYLE: normal; Z-INDEX: 5; DISPLAY: inline-block; LINE-HEIGHT: 1; TOP: 164px; MARGIN-RIGHT: -10px; -webkit-font-smoothing: antialiased'></SPAN><SPAN class=sr-only style="BOX-SIZING: border-box; OVERFLOW: hidden; BORDER-TOP: 0px; CLIP: rect(0px 0px 0px 0px); HEIGHT: 1px; BORDER-RIGHT: 0px; WIDTH: 1px; BORDER-BOTTOM: 0px; POSITION: absolute; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; BORDER-LEFT: 0px; MARGIN: -1px; PADDING-RIGHT: 0px">Next</SPAN></A></DIV>
<P style="BOX-SIZING: border-box; MARGIN: 0px 0px 10px"></P><BR style="BOX-SIZING: border-box">
<P style="BOX-SIZING: border-box; MARGIN: 0px 0px 10px"><IMG style="BOX-SIZING: border-box; BORDER-TOP: 0px; BORDER-RIGHT: 0px; VERTICAL-ALIGN: middle; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px" alt=insertion src="https://xuezhaokun.github.io/150-algorithm/img/insertion_pseudo.png" width="45%" align=right height=550>With the idea of Ma's Algorithm, I add a<SPAN>&nbsp;</SPAN><I style="BOX-SIZING: border-box">flag</I><SPAN>&nbsp;</SPAN>field to my "LockFreeRBNode" object, which indicates whether the current node is occupied by any concurrent. And then I added<SPAN>&nbsp;</SPAN><I style="BOX-SIZING: border-box">CAS</I><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><I style="BOX-SIZING: border-box">SetupLocalAreaForInsert</I><SPAN>&nbsp;</SPAN>functions to the regular sequential insertion operation as Kim's pseudocode did. The pseudocode on the right shows the shows the necessary changes for<SPAN>&nbsp;</SPAN><I style="BOX-SIZING: border-box">insertion</I><SPAN>&nbsp;</SPAN>function, and the red text indicates the differences from sequential algorithm.<IMG style="BOX-SIZING: border-box; BORDER-TOP: 0px; BORDER-RIGHT: 0px; VERTICAL-ALIGN: middle; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px" alt=insertion src="https://xuezhaokun.github.io/150-algorithm/img/object.png" width="55%" align=left height=300></P></DIV></DIV>
<DIV class=container style='BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: "Helvetica Neue", Helvetica, Arial, sans-serif; WIDTH: 1170px; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(51,51,51); FONT-STYLE: normal; PADDING-LEFT: 15px; MARGIN-LEFT: auto; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 15px; MARGIN-RIGHT: auto; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<DIV class=row style="BOX-SIZING: border-box; MARGIN-LEFT: -15px; MARGIN-RIGHT: -15px">