<H3 class="post-title entry-title" style='WHITE-SPACE: normal; WORD-SPACING: 0px; POSITION: relative; TEXT-TRANSFORM: none; COLOR: rgb(102,102,102); FONT: 22px "Trebuchet MS", Trebuchet, Verdana, sans-serif; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.75em 0px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial' itemprop="name">How about RLU? Is RLU a generic concurrency control?</H3>
<DIV class=post-header style='FONT-SIZE: 10px; FONT-FAMILY: "Trebuchet MS", Trebuchet, Verdana, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(102,102,102); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 1.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.6; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-variant-ligatures: normal; font-variant-caps: normal'>
<DIV class=post-header-line-1></DIV></DIV>
<DIV id=post-body-8482114938228712020 class="post-body entry-content" style='FONT-SIZE: 13px; FONT-FAMILY: "Trebuchet MS", Trebuchet, Verdana, sans-serif; WIDTH: 546px; WHITE-SPACE: normal; WORD-SPACING: 0px; POSITION: relative; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(102,102,102); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; LINE-HEIGHT: 1.4; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; font-variant-ligatures: normal; font-variant-caps: normal' itemprop="description articleBody">On the previous post we went over why RCU is not a generic concurrency control. This time we'll talk about R<SPAN style="COLOR: red"><B>L</B></SPAN>U (it's an<SPAN>&nbsp;</SPAN><B>L</B>, not a<SPAN>&nbsp;</SPAN><B>C</B>):<BR><A style="TEXT-DECORATION: none; COLOR: rgb(34,136,187)" href="http://alchem.usc.edu/courses-ee599/downloads/rlu-sosp15.pdf">http://alchem.usc.edu/courses-ee599/downloads/rlu-sosp15.pdf</A><BR><BR>R<B>L</B>U is a synchronization technique which contains inside it an efficient userspace RCU.<BR>It supports multi-atomic updates, making them visible in one-shot to the readers, without having to make an replica of the entire data, like on RCU.<BR><BR>The idea of RLU is that during a write operation, each modified object is first copied into a per-thread log, then it makes the modifications to the object in the log. When all modifications have been made, it increments the global clock, thus making all modifications atomically visible to readers. I'm over-simplifying, but it's ok for this post.<BR><BR>RLU is certainly more generic and efficient than RCU but it does not allow for generic code to be used. In fact, RLU does write-read synchronization but it does not handle write-write synchronization and the the paper itself mentions this explicitly:<BR>"<I>The basic idea of RLU described above provides read-write synchronization for object accesses. It does not however ensure write-write synchronization, which must be managedby the programmer if needed (as with RCU)</I>".<BR><BR><BR>To better understand why RLU is not a generic approach to concurrency, let's consider the canonical example of two threads 1 and 2 with cross dependencies. They are attempting to execute the following operations, where x and y start both at false:<BR><SPAN style='FONT-FAMILY: "courier new", courier, monospace'>Thread 1:<BR>&nbsp; if (!x) y = true;<BR><BR>Thread 2:<BR>&nbsp; if (!y) x = true;</SPAN><BR>&nbsp;<BR>As I'm sure you're aware, any serializable execution of these two operations will either result in x and y being<SPAN>&nbsp;</SPAN><SPAN style='FONT-FAMILY: "courier new", courier, monospace'>{true,false}</SPAN><SPAN>&nbsp;</SPAN>or<SPAN>&nbsp;</SPAN><SPAN style='FONT-FAMILY: "courier new", courier, monospace'>{false,true}</SPAN><SPAN>&nbsp;</SPAN>but never<SPAN>&nbsp;</SPAN><SPAN style="COLOR: red"><SPAN style='FONT-FAMILY: "courier new", courier, monospace'>{true,true}</SPAN></SPAN>. One of the operations has to "<I>happen before</I>" the other. If T1 executes before T2 then the end result will be<SPAN>&nbsp;</SPAN><SPAN style='FONT-FAMILY: "courier new", courier, monospace'>{false,true}</SPAN><SPAN>&nbsp;</SPAN>and if T2 executes before T1 then the end result will be<SPAN>&nbsp;</SPAN><SPAN style='FONT-FAMILY: "courier new", courier, monospace'>{true,false}</SPAN>.<BR>If you run this code without modification on RLU, it can happen that T1 reads x and sees false while T2 reads y and sees false, then T1 acquires the lock on y while T2 acquires the lock on x and each write to their log that the variables will be true and each advance the global clock and commit. In case you're wondering, this scenario is<SPAN>&nbsp;</SPAN><B>not</B><SPAN>&nbsp;</SPAN>linearizable.<BR><IMG  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABGsAAAF8CAYAAAB4wjYZAAAgAElEQVR4nO3dXYhc55kn8GNb/pIUj2oQwvYsjpI2M1kmZpRsg3YWzyCbxLWMySBmDB3sixHJzTQDRt5Z2LhhyIBNdvqqQ3BAm70Q2Ji+lG/6xhh00UtuYiKNCcYEGnlM0IVSoWMjgoUx71603+pTVae7qk7XOeetPr8fPGD6o+p0qep1Pf96P7IAAAAAQDKypi8AAAAAgF3CGgAAAICECGsAAAAAEiKsAQAAAEiIsAYAAAAgIcIaAAAAgIQIawAAAAASIqwBAAAASIiwBgAAACAhwhoAAACAhAhrAAAAABIirAEAAABIiLAGAAAAICHCGgAAAICECGsAAAAAEiKsAQAAAEiIsAYAAAAgIcIaAAAAgIQIawAAAAASIqwBAAAASIiwBgAAACAhwhoAAACAhAhrAAAAABIirAEAAABIiLAGAAAAICHCGgAAgAKrq6thcXExZFkWskzrBNTHiAMAADBkZWWlH9IIa4C6GXEAAABytra2+gHNpUuXQq/Xa/qSgJYR1gAAAORsbm6GLMvC0tJS05cCtJSwBgAAICeGNaurq01fCtBSwhoAAIAcYQ3QNGENAABAjrAGaJqwBgAAIGd9fV1YAzQqubCm1+uF5eXlsLCwELIsC91ut+lLAgAAWuL69ethcXExZFkWNjc3m74coKWSC2viwBhLWAMAAFSt2+32e5BOp2NWDdCopMKaON2w0+mEjY2Npi8HAABoCWENkJKkwprV1dWQZVm4dOlS05cCAAC00MbGRuh0OpZBAY1KMqwxKAIAAE25dOmSDYaBRglrAAAAcuLR3UtLS01fCtBSwhoAAICcGNY47ARoSlJhzfLysrAGAABolLAGaFoyYU3cyKvT6YRer9f05QAAAC0lrAGa1nhYE4/Hy7IsLCwsOLIbAABolLAGaJqwBgAAICeGNYuLi01fCtBSjYc1IYTQ6/X6x+NZBgUAADSp1+v1P1BeXV3VnwC1SyKsiZaWlmwwDAAANG5lZWVgFUCWJdU6AYdcUiNOPLr70qVLTV8KAADQcuvr62FxcVFYA9QuqREnhjWrq6tNXwoAAABAI4Q1AAAAAAkR1gAAAAAkRFgDAAAAkJAkw5qVlZWmLwUAAACgEUmFNRsbGyHLstDpdML6+nrTlwMAAABQu6TCmhDCwNF4WZaFbrfb9CUBAAAA1Ca5sKbX64XV1dWwsLAgrAEAAA61jY2N0Ol0wsLCQrh+/frEvxf7pjo/7F5ZWQnLy8uV3X78G1Law7TX64Vutxs2NjaavhRaJrmwBgAAoC263e7UIUWv1xsJaaoOay5duhSyLAuLi4uh1+tVch8phjXXr18PnU4ndDqdqcI0dm1uboalpaVw6dKlpi9lrghrAAAAGlJmZk0MTjqdTi0zPuLeogsLC5UFNSHsbomR2v6l6+vr/cd7a2ur6cuZO059LkdYAwAAMEeWlpZqCzW2trZCp9MJWZZVPrMkzjLa3Nys9H7KiIGDbTqmJ6wpR1gDAAAwR+oMNWIwVEejnXJYE0K6M39SJ6wpR1gDAABQo9i8DtekIUVdocb169f7y5/qMO7v6vV6/cdqr+Vf+Z+Z9ZKlzc3NSh6PuMxsr789//152TcnvxfTuBqW//rW1lZYXl7uz+7qdrsjj0H8dym6rfy17PW8Wl9fH9gDanFxcaJA7vr162FhYSEsLCxUsjxOWAMAAFCjacOavX7+IIHPJJaXl2udETFJCBWvaa9TqeL+MlUtV4pN/az3ClpZWSncF6jX6/WDinnaoHcWYU3c3Hn454f3DjpIWBOfT0U17uSz/O+urKxM+QiNJ6wBAABoUKphTWyU69pUd5KwJjbmnU6n8PtVL1WKmzvP+gjz/Alf+cY/LkNbWlqayf1MGqLMMqCbdhlUPpTpdDr9kGpra6v/GOVvq2xYE69rcXFx4Hvr6+v95/5+oVw+rKniSPvWhjX5DaKm2dE8TsNaWFio7Mmc1+v1QrfbrWywyT+xU1obGv/uOna3BwCAJqW4DKruJVAhTP53xV5suFfY2traN8iZhaqWQoWw+5jHxyAuf+p0OjM7hWvewprhJU9FM6fKhjX7bZwd72e/kMwyqIqUSZ/3moZVZVgTk9QqkroQ0g1r4mNd9AJlMuvr66Hb7Sb17woAwKgUw5rYJ9R5+tGkf1ec3TLcSMevV7EkJW+/YOCg4t+wsLDQ7z3n/f182bCmaNlX0fOyTFgzyfO76uBvnNaGNWVm1sTgZHFxsZYAIa5bnNWUtyJVbsB1UDHNHF6TyGRS300fAIAdKYY1TRxVPenfFWfQZFk20MvFJTJV9w5VhjUh7PadVU4KqFPZsGbS5/dBwppJqimtDWvKqHPNZpzyNrzBVBWafhLup4n/SRwWwhoAgPkgrBm8z0n+rhhoxO0i4hKiKj/ojqrun/InE83675mnZVDCGiZW1z9Wr9frr8Oso9Fu+kk4TtWbhB1WwhoAgPmQYlgTPzxO9UPTeH0xzIirEurY87LK/im/uiL2hLM8BeowhjX5vX6KxH5y2mVQTUu3Q6/AXk/MSdUValS1w/heJvm74hN8rydz/H4VSXYVm3jll3/tNaCnvERsL5Omw8P/jsOD1ebm5sD0y+Xl5ZEZXuM+bdnvedXr9cLq6urARt1LS0sTDchVb+QFAFC3FMOaJjYYnlZ8L7m1tdV/f1i1Kh+X4Q2F8ydfzfM+ntPO0pr29ZD/neGeJW6tMXx7sdc7yObNsS/pdDqVTCwQ1uwTUhzkbPiDqHNWTQiThTVbW1v9ZWDDyW588VW5ZCuGQbNMyuNRa3uFYkU7jaduFmFNfkDL1+Li4sDvlA1r8scSFtW4gS5/RF7Vm8cBANQhxbAmhOaO7p608Y3vR+OHjHXs71LVB+v5fivf88T3vouLi5Vvj1GV/JKjS5cujf07yoQ18bGLHzLHD4fzfcbw7cXHdmFhIWxsbAxc1+bmZlheXt53VtPw7c/6ddKqsCZv3Lq2EJoJa5pIsCf9G4o2/M1POasy7a1iUMwn1UVmufxq0ufRLP+HO83/xPOPRXz+xd/b3Nws3Im+bFgTr2tpaan/PMoPpuM2lM6HNXXNPgMAmKVJ+oz9PjCsK6yJ77vqCEHy/dmkH5bmNxquK1Sq4kPk/O0Or1To9Xr99+Lz/EHlfh/WDivTGw0HJ7EWFhb6Yd7w7Y37EHncc3/4Q+5Zvx6FNVMELbMOZorUvQQqhOn+rvhEjwNofHJXPYBXsRQqhN1ZTMODbRz4Z3VU27yENXul9kX/oy4T1uTDyKJEPd7Pfgm2ZVAAwLybl7Am/4FeHbM6pp1Zk/+dOmbDV9WTxH1q9nqc4/KoKkKiuhRtgzDLsCaEMHD7nU6nP8tmv42r4/fzoU2n0wlLS0thfX197PM+/1oW1sxIqmHNtJsvzcI0f1d+8+Nx+9jMWhWPfwzHhhPs+PV5Tq/LhjVFM6SKnpdlwppxz+94HXXs4g8AwHjxPWWqR0iXCXjm4b6YD/kZPbMONIU1iYU1TQyG0/5d+aVPdaXsIVTz+OenTub/jhhEzfPMjbJhzaQOEtYc5JMkAADqk99LJbVNbuMHrHVsIRHvy/tUQtiZxLC+vl7pEjVhjbCmf5+Tyk/Dq3PQrurxj0u7YkIew6hZzu6Yp2VQkxLWAAC0Q37vyhQ2ue31ev3w5DAuByNtwz1Nt9ut5HkhrEksrInrFVOdZphP1uO1VnkKVF5Vj38Mn2I4E/+uWa4HPYxhzX6fLuSPPc9rYpkfAAAHF98jD58QWqf8e9ZY++11OAvXr18PnU5n7o/PZnbyH1pXuSROWJNYWNPEBsPTGN5QOAYCVV9v1adkxX14tra2+pvXzrtpZmmVeT3E3yn6H3b+xKa8GIwdZOZM3GC40+lYLwwAUKPl5eVG338NnxhVx2a7vV4vdLtdQQ21E9YkFtbUfXR3DCcmSYqL0vT8ni9VDtxVh1gxHY1Log7DzI/8Udjj/kdW5vWQ37sofqKxtbXVfwz3ur0YjHW73YFZP71eL2xsbISlpaV9ZwMNTzuc532FAAAAirQqrJlkGcp+TXodYU0Iu81s1WsvQxhsfPf72/P71AyHOvlQoKrGOc7oqSo9z4dOhyUAyC9ZG7cnTJmwJoS9j53sdrv9f7NhcSpp2eVgcc10XWuUAQAA6iasSTCsGbdx6yxNMrMm3/Tv9fjExryKNawxSKh6tlEMHg7T5rZbW1theXl5JByZVVjT6/UGbn9hYWFkidx+1xWDyfi7y8vLEwVy+ZBIWAMAABw2rQpr5kWv1+s3vxrR3ca86vWxdd0PB5efEWZHfgAA4LAR1iQqLjuq66SlVO134lAV93MYNhY+zHq9XlhfXx84kQwAAOCwEdYkLJ6oc5iW5UwjLs3pdDqVBVa9Xq8f1JjJlLbhjYW73W6rg0wAAODwEtYkLu4F07YZBHET2klOqSojv0fL8IlGpCm/l5OlagAAwGEmrElcr9cL3W63ksAiZVX/3fmwptvtVnbKFAAA8yPuYbiwsBBWVlbM4gUaI6wBAAAIgydOVnXSKcAkhDUAAAA5+QMNzMAGmiCsAQAAGLKyshKyLAurq6tNXwrQQsIaAACAIfFwA2EN0ARhDQAAwBBhDdAkYQ0AAMAQYQ3QJGENAADAkM3NzZBlWVhZWWn6UoAWSiKsyR+Nd+nSpaYvBwAAaLmtra2QZVnodDphfX296csBWiapsCaW9BoAAGja+vp6WFhY6Pcp3W636UsCWiKJsCaEEHq9Xn9daJZlodfrNX1JAABAi12/fl1YAzQimbAmWlxcDFmWhc3NzaYvBQAAaKlerxc6nU7odDphY2Oj6csBWia5sKbb7QprAACARtlgGGiSsAYAAGBIDGsc3Q00QVgDAAAwRFgDNCm5sCZuMmxdKAAA0BRhDdCk5MKa9fX1kGVZWFxcNLsGAABohLAGaFJyYU0IIaysrIROp9M/Is8ACQAA1ElYAzQpybBmfX1dWAMAADRmZWVFLwI0JrmwJibYi4uL4fr1601fDgAA0DL5D4/1JEATkgtrbDAMAAA0IZ5MG6vb7TZ9SUBLJRvW2FwYAACoUwxrFhYWwurqauj1ek1fEtBSwhoAAACAhAhrAAAAABIirAEAAABIiLAGAAAAICHJhTWLi4vCGgAAAKC1kglrer1ef1ZNp9Np+nIAAAAAGpFEWJNl2UCtrq42fUkAAAAAjUgqrFlcXAzr6+tNXw4AAABAY5IIawAAAADYIawBAAAASIiwBgAAACAhwhoAAACAhAhrAAAAABIirAEAAABIiLAGAAAAICHCGgAAAICECGsAAAAAEiKsAQAAAEiIsAYAAAAgIcIaAAAAgIQIawAAAAASIqwBAAAASIiwBgAAACAhwhoAAACAhAhrAACAVrl27Vr4sz/7s3DPPfeEe+65Jxw/fjycOHEinDhxIpw+fXqkzpw5M1Dnzp0bqfPnz4/UhQsXRurixYsj9cMf/nCgbty40fRDBDRMWAMAALTK6dOnQ5ZlSdeFCxeafpiABglrAACAVpmHsCbLsnDx4sWmHyqgIcIaAACgVa5cudJ4EDNpXb58uemHC2iAsAYAAGidwnDkwSMh+9kzo7X21GC9+uRovXx2tF785mh9/4nR+u7XduvYvSPXdfXq1aYfLqBmwhoAAKB19pzN8vRjIXvrfHO19tTINZ04cSJcu3at6YcMqJGwBgAAaJ19lx+tPdVsYPPqk4WBjVOioD1qDWuuXbsWHn/88dJH5FV9TJ60GgAA2mHfsOaPH2g2rHnr/M7yqILAZtK9boD5VuureB52XT9//nydDwkAANCAsb3B959oPrB5+rHSfQ0w34Q1BeWIPAAAmH8PP/zw5H1AUTDys2eaD2zOPiKsgRaq9VXsiDwAAKAuU/UAbz4bslNHB7/2+Inmw5q3zofs6yeFNdAytb+KiwaS41kWNrMs3BiqawV1taCuFNTlglorqH/9ok4IbAAA4FCZKuD42TM7x20Pf/3FbzYf1rz5bMi+8kfCGmiRJMKaLMvC+SwLocG6tsd1Xb16te6HCAAAmIGpwpp4ZPfwsqN7705jOdSbz4bs2L0j133ixIlw6tSpcP/99wtr4BBJJqzJvpgR02Rgc3WP6/rHf/xHCTYAAMyZqcKaY/fuhDJvPjv6vSdOThes/O+/mvx+4+/882LIvnFq9+uPnwjZv/zl4O2uPVV4G9euXQt/+7d/qy+BQySpsOZ4w2HNXoHNkSNHhDUAADBn8u/Tjx49Go4fP96vkffy990Tsr/56k4oUnBsdvby2cnDmv/z7ZD9w58PVpaF7OFjo19/63zInvvTne9/49TO1/77V3bv958XB2/71SdHru3EiRPhW9/6lr4EDpGkwposy8LzCQQ2axMGM8IaAABIV/59+lNPPRVu3LjRr+eee27wvfzRIyH78dO7ocjwHjFH7j7YMqYYxhR978k/GZ1Fs3xmN+AZ/vkXvznShxw9elRfAodIJa/iaY7Iu1jwtasJBDZF1yWsAQCA+TEc1uTduHFj9P382Ud2A5GfPTP6/f/2aDVhTVG98Te791v0/aKjxvUlcGhU8iqeKtzIsnB66GunEghrQpaFC8IaAACYW/uFNSGEsLa2NvqePr/c6TsLo99feyqNsGZMYAPMtyTCmqsFX/9eAmFNyLJwruDa7rnnnnDs2LFw7Nix8OCDDxoUAQAgQePCmhBCOHPmzOD7/bjRcDyB6dTg8qLs/nvqCWv+5S93fufxE/v/3NdPCmvgEEoirNlrFsu1BMKakGXhTFGY9L3vhf/4j/8I3/72tw2KAACQoP3Cmom2bjhzqnBD3+xbX64+rIknQw1vMDxcbz47ur9OloXLly+H73znO5P1ZEByGg9r/v2LQGQ7G10O9cdThiqrJUKikGVhI8tCN/e960Pf394jsFlbW3NEHgAAJGq/sGaivuHYvTuByNlHBr9+Vza4GfGsw5q4ufCkP//mszvXOnT9p06dmujvBNJTeVhz9OjRcPLkyX7dfffdA9//L7lQ5GrBwPE/KwxrNrIsLBR8b7PgtovCpCzLwje+8Q0DHQAAJOjAYU2W7Zy8VBSGPHRfNWHNj58K2fF7d+qNv5n89teemvxvEtZA8ioNa+6///6wtrY28L0LFy6MDA755U7nCwaPG1MENvnKz5YpCmC6X4Q16xP8bPjiOk4Y6AAAYC7MJKz5yh/thCEvnx393t//6WzDmnxQ8+MSGxkXLdkS1sBcqj2s2d7eDqdPnx4YHE5k+89g+U8VhTW9KX421lUDHQAAzIX8vjSlw5os213yNLyZ711ZyP7vM7MJaw4a1MQqCpX0MDB3ag9rQgjh6tWrIwPE+VwgcqVgAPlfFYQ1ZX92v8AGAABIw+XLl8Px48fHhjX5rRuOHDkyGsg8c3onCPnZM6M9QOeBg4c1swpqYhUcOX7kyJFw6tSpcOrUqXD8+PFw//3362EgYY2ENSGEcPHixZEB5GouEBleDnVXNv1yqKrCmr0CpSzLwvb2tl3XAQAgAdvb2/333nuFNcM9y40bN0bfu599ZDcI+e7XRr//wn8+WFjz8LGd7z/5JyH7hz8frX/5y+kDm6cfG7nOc+fOhRBC+MlPfhIeeughfQkkrNawZqLj8bIs/FO2sxxq+OsnEwprQpaFfy24xsceeyw89tjowCisAQCA+j3//PNThTUhhLC2tjb6/v3ls7tByPBR2XdlO7NuyoY1x0dPchqoJ/+k3Ayb4WVbWRYuXrworIE5UGtYM0mAkWU7e9aErHj2yg8SCmtCloULE/5NwhoAAKhfnCkzTVgTQghnzpwZfP9+7N7dQKbo5KVTRw++fGnW9eazo8FSloUXXnhBWAOJSzKsybLdJVHnhr5+1xRhSh1hTciKT7AS1gAAQBoeffTRqcOascuhCpYZZd97ovmApiiwOXV05FqPHj2qL4GEVfLKPHny5IHDmme/CEJuFHxv0uVQdYU1RaGSsAYAANJw5cqVsLy8PPC1cWFNCGOWQxWFIHffNX45VBNVNBNIzwJJq+TVt7y8fOCwJsuy8O9fBCFrBd/7XmJhzXaWhTMF13ns2DG7rgMAQGL2Cmsm3Wczy7KQnX989Gv/6Xjz4UxRvfqksAbmSCWvvu3t7XDfffftG9Y88MAD/ePxTp48OTANL1b+OO+iIORaQmFNDGxOF1zn5cuXQwh2XQcAgFTsFdZMFWY8/djO0qjhr1/4evPhTFG9fFZYA3Oislffo48+Gu666649B77hNaMhjG7idSLbPa77RsHAcfSAAczqmIGpWyKwufHFdQ/f1pUrV4Q1AACQiFls3ZBlWch+/PTo1+65O83lUG+dD9n3nxDWwByo7NV3+fLlkGXZVGFN0SZe53JByMWCweO5fYKTpS9+ppNlYaumsCZkOzN+im7vxRdfFNYAAEACZrV1Q/b9J0L24jdHv/7YQ80HM3tV0ebIwhpISmWvvu3t7anDmhCKN/G6kgtCThcMIOOWQzVRVwuu88EHHwzHjh0z8AEAQMMm2bphojp2704AUnBEdvb9BE+HivX1kyPXe+TIkXDfffcJayABlb76fvjDH/b3awlhsrAmhBDOnTs38LP55VBFIcj9CYQzRXWl4FrvuusuAx8AACRg3NYNJ06cCMePH+9X/rCQft13T8j+/k93lj0VhTmnjg7WV/5op75+crfOPrJbTz+2W99Z2K3vfm23vv/Ebr34zd16+exOvfrkYK09tVM/e2awigKmoQKaUeurb9KwJs7Kyde5XAhyoWAQeSqBcKaoik6yMiACAEDzxm3dcPTo0XD58uWBeuyxoSVE998Tsh/91c5sle8sTP3eP/UCmpFMWDPNEXk/yYqXQ+WXS6VUReGSAREAAJo1buuGkydPjvxO0T6b2dlHdpcXnRo95XaeC2hGMmHNNAPGhWyPPWGy3eVSqdV5AyIAACRnv60bisKaEIr32cxePrsT1rz6ZOMBi7AG5l+tr754PN5Bw5rsi1CmKAD5rwkEM3vVOQMiAAAkbZKwJoQQzpw5M/g+/ti9IXvz2eK9a+IeMXHvmLWnBveUiXvNvHx2cA+a/N40+T1r8nvZ5Pe4ifve5PfD+frJ3X1y8nvnHLt3t/QmkJxaX33Ly8v93cUPGtZcyLKwnc3XcqjtLAtnhDUAAJCsScOaPZdDFYU1TZ/8NEnpTSAptb76tre3+zuoHzSs+dIXAUjRiUvZFyHO6S/CkVjncnU+VxdydTFX/zpUa1/U5VxdydXVXF3L1Y2hGhfYAAAAzZg0rAlhj+VQ3/2asAY4sNpffc8///zYsCZ/PN7x48fDsWPHwt133z3wM3dlWfinbPr9YOahAACAZkwT1oRQsByqqJoOYoQ1MHdqf/Vdu3ZtbFhz8uTJcOPGjYFaX18fGTiWs93lRU0HLMIaAACYf9OGNYXLoYQ1wAE18up7+OGHx4Y1Rc6fHx1ErmX7L4eaxwIAAJoxbVgTwh7LoQ5BWPPXf/3XFT/awF4aSQauXLkSlpeXBy9kgkFxe3s7nD59euBnT2e7G/g2HbIIawAAYL7FbRumCWtCmHA51BzVQw89FDY2Nip8pIH9JJMMTJpgX716dWQguZDtbNw7EnrMQQlrAAAgHVevXg1Hjx6dOqyZaDnUHNWXv/zl6h5kYKxkkoFJw5oQQrh48eLIYLImrAEAAGbg1KlTU4c1IUywHGqO6kc/+lFFjy4wiWSSgWnCmqLlUIWhxxyUsAYAANJy+fLl8MADD0wd1oRweJZDffLJJxU8ssCkkkkGpglrQiheDiWsAQAADmp7e3vivqTod8+dOxdOnDgR1tbWKri6an3pS18K58+fb/oyoPWSSQamDWtCKF4ONe9hzVe/+tWKH2kAAGCc559/vlRYM+9Onz4d3n333aYvA1ovmbDm4YcfnjqsCeHwTDOM9W//9m8VPsoAAMAktre3w5NPPtn0ZQAtlUxYE9eFThvWHLZd1z/++OMKH2UAAAAgdcmENSGEcPLkyanDmhDGL4eapwIAAADaLal04Ac/+EHrd10HAAAA2i2pdOAgu67fuHFjbnddP3v2bHjkkUeavgwAAAAgAUmFNSG0c9f15557Lly6dKnpywAAAAASkFxYc+PGDbuuAwAAAK2VXFgDAAAA0GbCGgAAAICECGsAAAAAEiKsAQAAAEiIsAYAAAAgIcIaAAAAgIQIawAAAAASIqwBAAAASIiwBgAAACAhwhoAAACAhAhrAAAAABIirAEAAABIiLAGAAAAICHCGgAAAICECGsAAAAAEiKsAQAAAEiIsAYAAAAgIcIaAAAAgIQIawAAAAASIqwBAAAASIiwBgAAACAhwhoAAACAhAhrAAAAABIirAEAAABIiLAGAAAAICHCGgAAAICECGsAAAAAEiKsAQAAAEiIsAYAAAAgIcIaAAAAgIQIawAAAAASIqwBAAAASIiwBgAAACAhwhoAAACAhAhrAAAAABIirAEAAABIiLAGAAAAICHCGgAAAICECGsAAAAAEiKsAQAAAEiIsAYAAAAgIcIaAAAAgIQIawAAAAASIqwBAAAASIiwBgAAACAhwhoAAACAhAhrAAAAABIirAEAAABIiLAGAAAAICHCGgAAAICECGsAAAAAEiKsAWrxF3+3plQSRTs0/TxTKhYAlCGsAWrxF3+3Fr71P/6fUo2Wxqk9jDkqhTLmAFCWsAaohcZJpVAap/Yw5qgUypgDQFnCGqAWGieVQmmc2sOYo1IoYw4AZQlrgFponFQKpXFqD2OOSqGMOQCUJawBaqFxUimUxqk9jDkqhTLmAFCWsAaohcZJpVAap/Yw5qgUypgDQFnCGqAWGieVQmmc2sOYo1IoYw4AZQlrgFponFQKpXFqD2OOSqGMOQCUJawBaqFxUimUxqk9jDkqhTLmAFCWsAaohcZJpVAap/Yw5qgUypgDQFnCGqAWGieVQmmc2sOYo1IoYy5s7nYAAAyoSURBVA4AZQlrgFponFQKpXFqD2OOSqGMOQCUJawBaqFxUimUxqk9jDkqhTLmAFCWsAaohcZJpVAap/Yw5qgUypgDQFnCGqAWGieVQmmc2sOYo1IoYw4AZQlrgFponFQKpXFqD2OOSqGMOQCUJawBaqFxUimUxqk9jDkqhTLmAFCWsAaohcZJpVAap/Yw5qgUypgDQFnCGqAWGieVQmmc2sOYo1IoYw4AZQlrgFponFQKpXFqD2OOSqGMOQCUJawBaqFxUimUxqk9jDkqhTLmAFCWsAaohcZJpVAap/Yw5qgUypgDQFnCGqAWGieVQmmc2sOYo1IoYw4AZQlrgFponFQKpXFqD2OOSqGMOQCUJawBaqFxUimUxqk9jDkqhTLmAFCWsAaohcZJpVAap/Yw5qgUypgDQFnCGqAWGieVQmmc2sOYo1IoYw4AZQlrgFponFQKpXFqD2OOSqGMOQCUJawBaqFxOli99Np74f0PPwkf3/5s4HH9+a9+d+Db/s1v/1D4b9b031xFaZzaw5hz8Hpr82bh+HDQ2/35r35X+G/20ytbjf/Nsy5jDgBlCWuAWmicyterr38QPr3zeeHjKqyZrjRO7WHMOVi9/+Enez62B71tYQ0AjCesAWqhcSpfWzdvhxBCuPX7O+HV1z+o9L5+emWr/2/W9N9dRWmc2sOYU75eff2D/uP4zru3wguv/KLS+4uENQCwS1gD1ELjVL7irJqXXnuv8vsS1nBYGHPK1zvv3gohhPD+h5/Ucn+RsAYAdglrgFponA7eyNRxX8IaDgtjTvmKy5RmscxykoqENQCwS1gD1KKqxumNtz/q30fRG/3896teQlR1IzPJz7702nvhnXdvjexDs3Xz9kSN0LRhzTvv3gq3fn+n/zsf3/4s/PLX2/vOAvrpla3+0q74Oz//1e8qX2qhcWqXqsacX/56O4Swsyxx3M/UNTNl1jVNWPPCK78Ib23eDFs3bw/srXXr93fCW5s3J7q/aJIx6o23PxoYPz6983l4/8NP9v3dF175Rfj5r343sEH7pGOiMQeApghrgFpU+Sl3bIw+vv3ZQMP/wiu/6DcP77x7q/EGaNLaa8PfItP+7htvf7TvfU8T1ux3X7/57R8Kf+etzZt7/s6t39+pPLDROLVHVWPOS6+917+PvULJGArMy0yR/Ot+nOEAZ6/NgqNf/np77P1H4x6vcfdV9DsvvPKLgUB52KSBkjEHgLoJa4BaVBnW5N+M5xuD+Onr1s3bM7mfSUOUgy4dOEhY8/6Hn4Rf/np7oOl56bX3+o/Fx7c/m7hp2+/n4oylj29/NnBfr77+Qfj5r35XOKMg3vandz4faJB+emWr8N9P48RBVDnmxNdoUQicf20c9H7GhRPRXuHopHWQsOadd2+F9z/8JLzx9kf9sDXOZInG7bcVjZsdE+XHj5deey+8tXlzz5lO8d9q6+bt/nXkr+/TO59Xuh+YMQeAsoQ1QC2q3j8if3rJT69s9RumT+98PrPZGnWFNXs1Mge5jXyjM2nTtt/PxUZnmiAsBkZFDW6crfDpnc8rfZ5onNqjyjEnzhArCgjikdezmM1XV1iz1/0edCyLIey4GTPRfj+XD3snvf/4/4XhWZdV/FsZcwCYNWENUIs6NvuMJ5h8fPuz/vKneVmGMEkjU8ftTBrW5MOx9z/8ZKJPpsfdbgzDqtxbSOPUHlWPOXGMGX6+xq/XsQdTVTWrsCa+pmcR1uQf29/89g8Tje3j/o443s1q9mVRGXMAKEtYA9SirpNZ8htP1nWSSdUVTfKzcXr/fns07Pf70+xZM7z/zLjNhSdVZcCmcWqPqsecOCsjv3Qvzuib142FY00b1ry1eXPfmYezCmteff2DgU2Mx20u3NTMJGMOALMgrAFqUVdYkw8pZv1paerLoMZtpDnJ7Ux7GtRLr71XGA4Vbdo5KWENs1DX0sv83jQxLJ7V7LB5WAYVQ6v9zCqsieNcUThUFJAJawCYZ8IaoBZ1hDXxVKitm7f7p7HMci+C1MOauAxseAPfaW5n2rAmXy+99t5A4zbcsJa9XY0TZdQx5sSQ8tXXP+jvC7Xfkd7TVuphTX455M9/9buRpV+zXgY1XHEm4V6n/s1qOZcxB4AmCGuAWlTdOA1vKJzfjLLKPVDqqGjcz8XGqOhEpVlvMDzJdQw3XpNuNlplaZzao46wJi4FfP/DT/r/XfVR0HXUpCFH/Lm9AqpZbjBc5nrj/xeqnDkzrow5AJQlrAFqUWXj9NJr7/U/WX3j7Y/6X4+zPG79/s5cb/YZjfu5+Pd+fPuz/r4xcZlSfp+H/W5j0rBm6+btkSPCY3O018arsZn99M7n4Z13bw3sbbPfkd8aJ8qoI6x54ZVfhE/vfB4+vfN5+M1v/zDT0+earEnDmvy+VXEsiMuU4uzG/Pf2qkl+Lo4P+SPC49gRQ6GimZTxOoY3JX7hlV+EN97+KGzdvG3pJQBJEtYAtaiycYpv1If3qImNVAjFs03mpaJxP5cPWoZ9eufzftOy1+3vZ7hpG7ckbK/QZdz+FlV/Aq5xao+69snKP6fnfWPhWJOGNfkxtsheM2smWVI6PBaMWxK2Vyg/vClxEWENACkS1gC1qKpxivvU7PWJdpwGH8LgrJt5qmiSn33j7Y8GNvv9+PZn/b0kYoO01+3vZ7hp22tj4a2bt8cuAynaHPQ3v/3DyGwbjRMHUVdYkw9Jm1ziN8uaZq+XV1//YOAUvnhCUxwjih6XMmHNXhsL3/r9nfDOu7f2ndEU99PKz/b5+PZn/Zk6xhwAUiSsAWpRV+Ok1H6lcWqPusOa/KlQSsUy5gBQlrAGqIWwRqVQGqf2qGvPmjhb4zBsLKxmX8YcAMoS1gC1ENaoFErj1B5Vjzn5jW2bPG1IpV3GHADKEtYAtRDWqBRK49QeVY05w3umfHz7s0NxApSqpow5AJQlrAFqIaxRKZTGqT2qDmviBrWCGrVfGXMAKEtYA9RCWKNSKI1TexhzVAplzAGgLGENUAuNk0qhNE7tYcxRKZQxB4CyhDVALTROKoXSOLWHMUelUMYcAMoS1gC10DipFErj1B7GHJVCGXMAKEtYA9RC46RSKI1TexhzVAplzAGgLGENUAuNk0qhNE7tYcxRKZQxB4CyhDVALTROKoXSOLWHMUelUMYcAMoS1gC10DipFErj1B7GHJVCGXMAKEtYA9RC46RSKI1TexhzVAplzAGgLGENUAuNk0qhNE7tYcxRKZQxB4CyhDVALTROKoXSOLWHMUelUMYcAMoS1gC10DipFErj1B7GHJVCGXMAKEtYA9RC46RSKI1TexhzVAplzAGgLGENUAuNk0qhNE7tYcxRKZQxB4CyhDVALTROKoXSOLWHMUelUMYcAMoS1gC10DipFErj1B7GHJVCGXMAKEtYA9RC46RSKI1TexhzVAplzAGgLGENUAuNk0qhNE7tYcxRKZQxB4CyhDVALTROKoXSOLWHMUelUMYcAMoS1gC10DipFErj1B7GHJVCGXMAKEtYA9RC46RSKI1TexhzVAplzAGgLGENUAuNk0qhNE7tYcxRKZQxB4CyhDVALTROKoXSOLWHMUelUMYcAMoS1gC10DipFErj1B7GHJVCGXMAKEtYA9RC46RSKI1TexhzVAplzAGgLGENUAuNk0qhNE7tYcxRKZQxB4CyhDVALf7i79aUSqJoh6afZ0rFAoAyhDUAAAAACRHWAAAAACREWAMAAACQEGENAAAAQEKENQAAAAAJEdYAAAAAJERYAwAAAJAQYQ0AAABAQoQ1AAAAAAkR1gAAAAAkRFgDAAAAkBBhDQAAAEBChDUAAAAACRHWAAAAACREWAMAAACQEGENAAAAQEKENQAAAAAJEdYAAAAAJERYAwAAAJAQYQ0AAABAQoQ1AAAAAAkR1gAAAAAkRFgDAAAAkBBhDQAAAEBChDUAAAAACRHWAAAAACREWAMAAACQEGENAAAAQEKENQAAAAAJEdYAAAAAJERYAwAAAJAQYQ0AAABAQoQ1AAAAAAkR1gAAAAAkRFgDAAAAkBBhDQAAAEBChDUAAAAACRHWAAAAACREWAMAAACQEGENAAAAQEKENQAAAAAJEdYAAAAAJERYAwAAAJAQYQ0AAABAQoQ1AAAAAAkR1gAAAAAkRFgDAAAAkBBhDQAAAEBChDUAAAAACRHWAAAAACREWAMAAACQEGENAAAAQEKENQAAAAAJEdYAAAAAJERYAwAAAJAQYQ0AAABAQoQ1AAAAAAkR1gAAAAAkRFgDAAAAkBBhDQAAAEBChDUAAAAACRHWAAAAACREWAMAAACQkP8PDG2hfDtQ5kEAAAAASUVORK5CYII=" style="BORDER-TOP: rgb(238,238,238) 1px solid; BORDER-RIGHT: rgb(238,238,238) 1px solid; BACKGROUND: rgb(255,255,255); BORDER-BOTTOM: rgb(238,238,238) 1px solid; PADDING-BOTTOM: 5px; PADDING-TOP: 5px; PADDING-LEFT: 5px; BORDER-LEFT: rgb(238,238,238) 1px solid; PADDING-RIGHT: 5px; box-shadow: rgba(0, 0, 0, 0.1) 1px 1px 5px" alt="" width=640 height=215><BR><BR><BR><BR><BR><BR>In the database world, this kind of problem is called a<SPAN>&nbsp;</SPAN><B><I>write skew anomaly</I></B><SPAN>&nbsp;</SPAN>(see<SPAN>&nbsp;</SPAN><A style="TEXT-DECORATION: none; COLOR: rgb(34,136,187)" href="https://gts3.org/~sanidhya/pubs/2019/mvrlu.pdf">section 2.4 of the MV-RLU paper<SPAN>&nbsp;</SPAN></A>for a great explanation in the context of RLU). In the context of concurrent data structures, we call these<SPAN>&nbsp;</SPAN><B><I>bugs</I></B>!<BR>Handling cases like this is what an STM or a Universal Construction are supposed to do because an STM/UC must handle any sequential piece code (with some exceptions).<BR>Granted, if you're really careful how you write the code, you can use RLU as long as you avoid writing sequential code that has this kind of cross dependencies. The problem is, in practice, this is<SPAN>&nbsp;</SPAN><B>very hard to do</B><SPAN>&nbsp;</SPAN>and even when you do it, you're never really sure it's actually done correctly (did I miss some cross dependency?). If you write user-code that has one of these problems, it will be hard to find it and likely hard to fix it.<BR><BR>There is an easy solution for RLU and that is to<SPAN>&nbsp;</SPAN><B>use a global lock</B>, but then it looses some of its appeal because it no longer scales for writes.<BR>Keep in mind though that RLU scales for read-only transactions!<BR><BR>STMs like TinySTM or TL2 have time-based algorithms that<SPAN>&nbsp;</SPAN><B>keep a read-set of all loads done within the transaction and do validation of the read-set at commit time</B><SPAN>&nbsp;</SPAN>exactly to handle these kind of cross dependencies.<BR>If you're wondering how frequent are cross dependencies in real code, then even an ordered linked list is prone to these kind of issues (depending on how it is implemented), which helps to show that it's very hard to get away from this problem in practice.<BR><BR>If you ever read a paper where they say that they used RLU to make an STM, be very very suspicious: an STM<SPAN>&nbsp;</SPAN><B>must<SPAN>&nbsp;</SPAN></B>be able to handle cross dependencies and provide linearizable (globally serializable) operations regardless of what the underlying sequential user-code. If it works only for some small subset of user programs, then it's not an STM... sure it's a very valuable tool, but it's not an STM.</DIV>