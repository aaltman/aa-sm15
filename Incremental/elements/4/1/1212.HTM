<b> : </b><SPAN id=Filter_algorithm:_Peterson.27s_algorithm_for_more_than_two_processes></SPAN><SPAN id=Filter_algorithm class=anchor></SPAN>Filter algorithm: Peterson's algorithm for more than two processes</H3><SPAN class=mw-editsection style="FONT-SIZE: small; FONT-FAMILY: sans-serif; VERTICAL-ALIGN: baseline; FONT-WEIGHT: normal; MARGIN-LEFT: 1em; LINE-HEIGHT: 0; MARGIN-RIGHT: 0px; user-select: none"><SPAN class=mw-editsection-bracket style="COLOR: ; MARGIN-RIGHT: 0.25em">[</SPAN><A title="Edit section: Filter algorithm: Peterson's algorithm for more than two processes" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; WHITE-SPACE: nowrap; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/w/index.php?title=Peterson%27s_algorithm&amp;action=edit&amp;section=5"><SPAN>edit</SPAN></A><SPAN class=mw-editsection-bracket style="COLOR: ; MARGIN-LEFT: 0.25em">]</SPAN></SPAN></DIV><FIGURE class=mw-default-size style="FONT-SIZE: 16px; FONT-FAMILY: sans-serif; BORDER-TOP-COLOR: ; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; MIN-WIDTH: 100px; BORDER-BOTTOM: 0px; TEXT-TRANSFORM: none; FLOAT: right; BORDER-LEFT-COLOR: ; FONT-WEIGHT: 400; COLOR: rgb(32,33,34); FONT-STYLE: normal; TEXT-ALIGN: center; CLEAR: right; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.5em 0px 1.3em 1.4em; DISPLAY: table; BORDER-RIGHT-COLOR: ; LETTER-SPACING: normal; LINE-HEIGHT: 0; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; border-image-source: ; border-image-slice: ; border-image-width: ; border-image-outset: ; border-image-repeat: " typeof="mw:File/Thumb"><A class=mw-file-description style="TEXT-DECORATION: none; BORDER-TOP: 0px; BORDER-RIGHT: 0px; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: 0px; POSITION: relative; COLOR: ; BORDER-LEFT: 0px; DISPLAY: block; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/File:Snapshot_of_filter_algorithm_(Peterson%27s_algorithm_for_more_than_2_processes)_in_progress.png"><IMG class=mw-file-element style="BORDER-TOP: 1px solid; HEIGHT: auto; BORDER-RIGHT: 1px solid; VERTICAL-ALIGN: middle; BORDER-BOTTOM: 1px solid; BORDER-LEFT: 1px solid; MARGIN: 3px" src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/Snapshot_of_filter_algorithm_%28Peterson%27s_algorithm_for_more_than_2_processes%29_in_progress.png/220px-Snapshot_of_filter_algorithm_%28Peterson%27s_algorithm_for_more_than_2_processes%29_in_progress.png" width=220 height=381 data-file-height="725" data-file-width="419" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/7/74/Snapshot_of_filter_algorithm_%28Peterson%27s_algorithm_for_more_than_2_processes%29_in_progress.png/330px-Snapshot_of_filter_algorithm_%28Peterson%27s_algorithm_for_more_than_2_processes%29_in_progress.png 1.5x, //upload.wikimedia.org/wikipedia/commons/7/74/Snapshot_of_filter_algorithm_%28Peterson%27s_algorithm_for_more_than_2_processes%29_in_progress.png 2x" decoding="async"></A><FIGCAPTION style="FONT-SIZE: 14px; BORDER-TOP: 0px; BORDER-LEFT-COLOR: ; PADDING-BOTTOM: 6px; BORDER-BOTTOM-COLOR: ; TEXT-ALIGN: left; PADDING-TOP: 0px; PADDING-LEFT: 6px; DISPLAY: table-caption; BORDER-RIGHT-COLOR: ; LINE-HEIGHT: 1.4em; PADDING-RIGHT: 6px; CAPTION-SIDE: bottom; border-image-source: ; border-image-slice: ; border-image-width: ; border-image-outset: ; border-image-repeat: ">Snapshot of filter algorithm with 10 processes in progress. Last to enter are shown bold and underlined. (NB: Depending on scheduling, the last to enter may not be "correct".) At any time, updates to the table could be: the insertion of a new process at level 0, a change to the last to enter at a given level, or a process moving up one level (if it is not the last to enter OR there are no other processes at its own level or higher).</FIGCAPTION></FIGURE>
<P style="FONT-SIZE: 16px; FONT-FAMILY: sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(32,33,34); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.5em 0px 1em; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">The filter algorithm generalizes Peterson's algorithm to<SPAN>&nbsp;</SPAN><SPAN class=texhtml style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'><I>N</I><SPAN>&nbsp;</SPAN>&gt; 2</SPAN><SPAN>&nbsp;</SPAN>processes.<SUP id=cite_ref-art_6-0 class=reference style="FONT-SIZE: 12px; WHITE-SPACE: nowrap; FONT-WEIGHT: normal; FONT-STYLE: normal; LINE-HEIGHT: 1"><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/Peterson%27s_algorithm#cite_note-art-6"><FONT style="BACKGROUND-COLOR: #ffffff" face=Arial>[6]</FONT></A></SUP><SPAN>&nbsp;</SPAN>Instead of a boolean flag, it requires an integer variable per process, stored in a single-writer/multiple-reader (SWMR) atomic<SPAN>&nbsp;</SPAN><A title="Register machine" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/Register_machine">register</A>, and<SPAN>&nbsp;</SPAN><SPAN class=texhtml style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'><I>N</I>&nbsp;&#8722;&nbsp;1</SPAN><SPAN>&nbsp;</SPAN>additional variables in similar registers. The registers can be represented in<SPAN>&nbsp;</SPAN><A title=Pseudocode style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/Pseudocode">pseudocode</A><SPAN>&nbsp;</SPAN>as<SPAN>&nbsp;</SPAN><A title="Array data type" class=mw-redirect style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/Array_data_type">arrays</A>:</P><PRE style="FONT-SIZE: 16px; BORDER-TOP: 1px solid; FONT-FAMILY: monospace, monospace; BORDER-RIGHT: 1px solid; WHITE-SPACE: pre-wrap; WORD-SPACING: 0px; OVERFLOW-X: hidden; BORDER-BOTTOM: 1px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: ; PADDING-BOTTOM: 1em; FONT-STYLE: normal; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: 1px solid; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; LINE-HEIGHT: 1.3; PADDING-RIGHT: 1em; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; overflow-wrap: break-word">level&nbsp;: array of N integers
last_to_enter&nbsp;: array of N &#8722; 1 integers
</PRE>
<P style="FONT-SIZE: 16px; FONT-FAMILY: sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(32,33,34); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.5em 0px 1em; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">The<SPAN>&nbsp;</SPAN><SPAN class=monospaced style="FONT-FAMILY: monospace, monospace">level</SPAN><SPAN>&nbsp;</SPAN>variables take on values up to<SPAN>&nbsp;</SPAN><SPAN class=texhtml style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'><I>N</I>&nbsp;&#8722;&nbsp;1</SPAN>, each representing a distinct "waiting room" before the critical section.<SUP id=cite_ref-art_6-1 class=reference style="FONT-SIZE: 12px; WHITE-SPACE: nowrap; FONT-WEIGHT: normal; FONT-STYLE: normal; LINE-HEIGHT: 1"><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/Peterson%27s_algorithm#cite_note-art-6"><FONT style="BACKGROUND-COLOR: #ffffff" face=Arial>[6]</FONT></A></SUP><SPAN>&nbsp;</SPAN>Processes advance from one room to the next, finishing in room<SPAN>&nbsp;</SPAN><SPAN class=texhtml style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'><I>N</I>&nbsp;&#8722;&nbsp;1</SPAN>, which is the critical section. Specifically, to acquire a lock, process<SPAN>&nbsp;</SPAN><SPAN class="texhtml mvar" style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; FONT-STYLE: italic; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'>i</SPAN><SPAN>&nbsp;</SPAN>executes<SUP id=cite_ref-raynal_4-2 class=reference style="FONT-SIZE: 12px; WHITE-SPACE: nowrap; FONT-WEIGHT: normal; FONT-STYLE: normal; LINE-HEIGHT: 1"><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/Peterson%27s_algorithm#cite_note-raynal-4"><FONT style="BACKGROUND-COLOR: #ffffff" face=Arial>[4]</FONT></A></SUP><SUP class="reference nowrap" style="FONT-SIZE: 12px; WHITE-SPACE: nowrap; FONT-WEIGHT: normal; FONT-STYLE: normal; LINE-HEIGHT: 1"><SPAN title="Page / location: 22"><FONT style="BACKGROUND-COLOR: #ffffff" color=#202122 face=Arial>:&#8202;22&#8202;</FONT></SPAN></SUP></P><PRE style="FONT-SIZE: 16px; BORDER-TOP: 1px solid; FONT-FAMILY: monospace, monospace; BORDER-RIGHT: 1px solid; WHITE-SPACE: pre-wrap; WORD-SPACING: 0px; OVERFLOW-X: hidden; BORDER-BOTTOM: 1px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: ; PADDING-BOTTOM: 1em; FONT-STYLE: normal; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: 1px solid; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; LINE-HEIGHT: 1.3; PADDING-RIGHT: 1em; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; overflow-wrap: break-word">i &#8592; ProcessNo
<B>for</B> &#8467; <B>from</B> 0 <B>to</B> N &#8722; 1 <B>exclusive</B>
    level[i] &#8592; &#8467;
    last_to_enter[&#8467;] &#8592; i
    <B>while</B> last_to_enter[&#8467;] = i <B>and</B> there exists k &#8800; i, such that level[k] &#8805; &#8467;
        <B>wait</B>
</PRE>
<P style="FONT-SIZE: 16px; FONT-FAMILY: sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(32,33,34); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.5em 0px 1em; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">To release the lock upon exiting the critical section, process<SPAN>&nbsp;</SPAN><SPAN class="texhtml mvar" style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; FONT-STYLE: italic; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'>i</SPAN><SPAN>&nbsp;</SPAN>sets<SPAN>&nbsp;</SPAN><SPAN class=monospaced style="FONT-FAMILY: monospace, monospace">level[i]</SPAN><SPAN>&nbsp;</SPAN>to &#8722;1.</P>
<P style="FONT-SIZE: 16px; FONT-FAMILY: sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(32,33,34); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.5em 0px 1em; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">That this algorithm achieves mutual exclusion can be proven as follows. Process<SPAN>&nbsp;</SPAN><SPAN class="texhtml mvar" style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; FONT-STYLE: italic; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'>i</SPAN><SPAN>&nbsp;</SPAN>exits the inner loop when there is either no process with a higher level than<SPAN>&nbsp;</SPAN><SPAN class=monospaced style="FONT-FAMILY: monospace, monospace">level[i]</SPAN>, so the next waiting room is free; or, when<SPAN>&nbsp;</SPAN><SPAN class=monospaced style="FONT-FAMILY: monospace, monospace">i &#8800; last_to_enter[&#8467;]</SPAN>, so another process joined its waiting room. At level zero, then, even if all<SPAN>&nbsp;</SPAN><SPAN class="texhtml mvar" style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; FONT-STYLE: italic; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'>N</SPAN><SPAN>&nbsp;</SPAN>processes were to enter waiting room zero at the same time, no more than<SPAN>&nbsp;</SPAN><SPAN class=texhtml style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'><I>N</I>&nbsp;&#8722;&nbsp;1</SPAN><SPAN>&nbsp;</SPAN>will proceed to the next room, the final one finding itself the last to enter the room. Similarly, at the next level,<SPAN>&nbsp;</SPAN><SPAN class=texhtml style='FONT-SIZE: 18px; FONT-FAMILY: "Nimbus Roman No9 L", "Times New Roman", Times, serif; WHITE-SPACE: nowrap; LINE-HEIGHT: 1; font-kerning: none; font-variant-numeric: lining-nums tabular-nums'><I>N</I>&nbsp;&#8722;&nbsp;2</SPAN><SPAN>&nbsp;</SPAN>will proceed,<SPAN>&nbsp;</SPAN><A title="Mathematical induction" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/Mathematical_induction">etc.</A>, until at the final level, only one process is allowed to leave the waiting room and enter the critical section, giving mutual exclusion.<SUP id=cite_ref-raynal_4-3 class=reference style="FONT-SIZE: 12px; WHITE-SPACE: nowrap; FONT-WEIGHT: normal; FONT-STYLE: normal; LINE-HEIGHT: 1"><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/Peterson%27s_algorithm#cite_note-raynal-4"><FONT style="BACKGROUND-COLOR: #ffffff" face=Arial>[4]</FONT></A></SUP><SUP class="reference nowrap" style="FONT-SIZE: 12px; WHITE-SPACE: nowrap; FONT-WEIGHT: normal; FONT-STYLE: normal; LINE-HEIGHT: 1"><SPAN title="Page / location: 22&#8211;24"><FONT style="BACKGROUND-COLOR: #ffffff" color=#202122 face=Arial>:&#8202;22&#8211;24&#8202;</FONT></SPAN></SUP></P>
<P style="FONT-SIZE: 16px; FONT-FAMILY: sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(32,33,34); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.5em 0px 1em; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">Unlike the two-process Peterson algorithm, the filter algorithm does not guarantee bounded waiting.<SUP id=cite_ref-raynal_4-4 class=reference style="FONT-SIZE: 12px; WHITE-SPACE: nowrap; FONT-WEIGHT: normal; FONT-STYLE: normal; LINE-HEIGHT: 1"><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: ; border-radius: 2px; overflow-wrap: break-word" href="https://en.wikipedia.org/wiki/Peterson%27s_algorithm#cite_note-raynal-4"><FONT style="BACKGROUND-COLOR: #ffffff" face=Arial>[4]</FONT></A></SUP><SUP class="reference nowrap" style="FONT-SIZE: 12px; WHITE-SPACE: nowrap; FONT-WEIGHT: normal; FONT-STYLE: normal; LINE-HEIGHT: 1"><SPAN title="Page / location: 25&#8211;26"><FONT style="BACKGROUND-COLOR: #ffffff" color=#202122 face=Arial>:&#8202;25&#8211;26&#8202;</FONT></SPAN></SUP></P>
<DIV class="mw-heading mw-heading2" style='FONT-SIZE: 1.5em; OVERFLOW: hidden; FONT-FAMILY: "Linux Libertine", Georgia, Times, "Source Serif Pro", serif; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: 1px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: ; PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.25em 0px; LETTER-SPACING: normal; LINE-HEIGHT: 1.375; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>