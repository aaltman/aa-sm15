<b> : </b>Hyperloglog<A aria-label="Direct link to Hyperloglog" title="Direct link to Hyperloglog" class=hash-link style="BOX-SIZING: border-box; TEXT-DECORATION: ; COLOR: ; transition: opacity var(--ifm-transition-fast); opacity: 0; user-select: none" href="https://microsoft.github.io/garnet/docs/benchmarking/results-resp-bench#hyperloglog">&#8203;</A></H4>
<P style='BOX-SIZING: border-box; FONT-SIZE: 17px; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(28,30,33); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><STRONG style="BOX-SIZING: border-box">Garnet</STRONG><SPAN>&nbsp;</SPAN>supports its own built-in Hyperloglog (HLL) data structure. This is implemented using C# and it supports operations such as update (PFADD), compute an estimate (PFCOUNT) and merge (PFMERGE) two or more distinct HLL structures. HLL data structures are often optimized in terms of their memory footprint. Our implementation is no different, utilizing a sparse representation when the number of nonzero counts is low and a dense representation beyond a given fixed threshold for which the trade-off between memory savings and the additional work performed for decompression is no longer attractive. Enabling efficient updates to the HyperLogLog (HLL) structure is essential for concurrent systems, such as Garnet. For this reason, our experiments forcus specifically on the performance of PFADD and are deliberately designed to stress test our system for the following scenarios:</P>
<OL style='BOX-SIZING: border-box; FONT-SIZE: 17px; MARGIN-BOTTOM: 0px; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(28,30,33); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; MARGIN-RIGHT: 0px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<LI style="BOX-SIZING: border-box; overflow-wrap: break-word">Large number of high contention updates (i.e. batchsize 4096, DB of 1024 keys) for increasing number of threads or increasing payload size After a few insertions, the constructed HyperLogLog (HLL) structures will transition to utilizing the dense representation.</LI>
<LI style="BOX-SIZING: border-box; overflow-wrap: break-word">Large number of low contention updates (i.e. batchsize 4096, DB of 256M keys) for increasing number of threads or increasing payload size This adjustment will increase the likelihood that the constructed HyperLogLog (HLL) structures utilize the sparse representation. Consequently, our measurements will consider the added overhead of working with compressed data or incrementally allocating more space for non-zero values</LI></OL>
<P style='BOX-SIZING: border-box; FONT-SIZE: 17px; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(28,30,33); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>In Figure 5, we present the results for first experimental scenario.<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box">Garnet</STRONG><SPAN>&nbsp;</SPAN>scales very well under high contention and consistently outperforms every other system in terms of raw throughput for increasing number of threads. Similarly, for increasing payload size<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box">Garnet</STRONG><SPAN>&nbsp;</SPAN>exhibits higher total throughput compared to other systems. Across all tested systems, we noticed a noticeable decrease in throughput as the payload size increased. This behavior is anticipated due to the inherent TCP network bottleneck.</P><DETAILS class="details_lb9f isBrowser_bmU9 alert alert--info details_b_Ee" style='BOX-SIZING: border-box; FONT-SIZE: 17px; MARGIN-BOTTOM: 0px; BORDER-TOP: 1px solid; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; BORDER-RIGHT: 1px solid; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 0px; BORDER-BOTTOM: 1px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: ; FONT-STYLE: normal; BORDER-LEFT: 1px solid; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; MARGIN-RIGHT: 0px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; --ifm-alert-background-color: var(--ifm-color-info-contrast-background); --ifm-alert-background-color-highlight: #54c7ec26; --ifm-alert-foreground-color: var(--ifm-color-info-contrast-foreground); --ifm-alert-border-color: var(--ifm-color-info-dark); --ifm-code-background: var(--ifm-alert-background-color-highlight); --ifm-link-color: var(--ifm-alert-foreground-color); --ifm-link-hover-color: var(--ifm-alert-foreground-color); --ifm-link-decoration: underline; --ifm-tabs-color: var(--ifm-alert-foreground-color); --ifm-tabs-color-active: var(--ifm-alert-foreground-color); --ifm-tabs-color-active-border: var(--ifm-alert-border-color); border-radius: var(--ifm-alert-border-radius); box-shadow: var(--ifm-alert-shadow); --docusaurus-details-summary-arrow-size: 0.38rem; --docusaurus-details-transition: transform var(--ifm-transition-fast) ease; --docusaurus-details-decoration-color: var(--ifm-alert-border-color)' data-collapsed="true"><SUMMARY style="LIST-STYLE-TYPE: none; BOX-SIZING: border-box; CURSOR: pointer; POSITION: relative">Varying number of client sessions or payload size while operating on few keys</SUMMARY></DETAILS>
<TABLE style='BOX-SIZING: border-box; FONT-SIZE: 17px; OVERFLOW: auto; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(28,30,33); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; DISPLAY: block; LETTER-SPACING: normal; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<THEAD style="BOX-SIZING: border-box">
<TR style="BOX-SIZING: border-box; BORDER-BOTTOM: 2px solid">
<TH style="BOX-SIZING: border-box; COLOR: ; TEXT-ALIGN: center"><IMG class=img_ev3q style="BOX-SIZING: border-box; MAX-WIDTH: 100%; HEIGHT: auto" alt=tpt-pfadd-few-keys.png src="https://microsoft.github.io/garnet/assets/images/tpt-pfadd-few-keys-5052fa1e913d184cd21e6f3971a9cb13.png" width=1990 height=667 loading="lazy" decoding="async"></TH></TR></THEAD>
<TBODY style="BOX-SIZING: border-box">
<TR style="BOX-SIZING: border-box">
<TD style="BOX-SIZING: border-box; COLOR: ; TEXT-ALIGN: center">Figure 5: Throughput (log-scale), for (a) increasing number of client sessions, and (b) increasing payload size, for a database size of 1024 keys.</TD></TR></TBODY></TABLE>
<P style='BOX-SIZING: border-box; FONT-SIZE: 17px; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(28,30,33); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Figure 6 shows the results for the second experimental scenario as described above. Even while operating on the HLL sparse representation,<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box">Garnet</STRONG><SPAN>&nbsp;</SPAN>performs better that any other system and achieves consistently higher throughput while scaling very well for increasing numbers of client sessions. Similarly, for increasing payload size,<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box">Garnet</STRONG><SPAN>&nbsp;</SPAN>outperforms the competition by scoring overall higher throughput. Notice in both cases the throughput is lower compared to the previous experiment due to the overhead of operating on compressed data.</P><DETAILS class="details_lb9f isBrowser_bmU9 alert alert--info details_b_Ee" style='BOX-SIZING: border-box; FONT-SIZE: 17px; MARGIN-BOTTOM: 0px; BORDER-TOP: 1px solid; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; BORDER-RIGHT: 1px solid; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 0px; BORDER-BOTTOM: 1px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: ; FONT-STYLE: normal; BORDER-LEFT: 1px solid; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; MARGIN-RIGHT: 0px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; --ifm-alert-background-color: var(--ifm-color-info-contrast-background); --ifm-alert-background-color-highlight: #54c7ec26; --ifm-alert-foreground-color: var(--ifm-color-info-contrast-foreground); --ifm-alert-border-color: var(--ifm-color-info-dark); --ifm-code-background: var(--ifm-alert-background-color-highlight); --ifm-link-color: var(--ifm-alert-foreground-color); --ifm-link-hover-color: var(--ifm-alert-foreground-color); --ifm-link-decoration: underline; --ifm-tabs-color: var(--ifm-alert-foreground-color); --ifm-tabs-color-active: var(--ifm-alert-foreground-color); --ifm-tabs-color-active-border: var(--ifm-alert-border-color); border-radius: var(--ifm-alert-border-radius); box-shadow: var(--ifm-alert-shadow); --docusaurus-details-summary-arrow-size: 0.38rem; --docusaurus-details-transition: transform var(--ifm-transition-fast) ease; --docusaurus-details-decoration-color: var(--ifm-alert-border-color)' data-collapsed="true"><SUMMARY style="LIST-STYLE-TYPE: none; BOX-SIZING: border-box; CURSOR: pointer; POSITION: relative">Varying number of client sessions or payload size while operating on many keys (PFADD)</SUMMARY></DETAILS>
<TABLE style='BOX-SIZING: border-box; FONT-SIZE: 17px; OVERFLOW: auto; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(28,30,33); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; DISPLAY: block; LETTER-SPACING: normal; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<THEAD style="BOX-SIZING: border-box">
<TR style="BOX-SIZING: border-box; BORDER-BOTTOM: 2px solid">
<TH style="BOX-SIZING: border-box; COLOR: ; TEXT-ALIGN: center"><IMG class=img_ev3q style="BOX-SIZING: border-box; MAX-WIDTH: 100%; HEIGHT: auto" alt=tpt-pfadd-few-keys.png src="https://microsoft.github.io/garnet/assets/images/tpt-pfadd-many-keys-8e6963a116394d6bddc7c9e39dd803a5.png" width=1793 height=602 loading="lazy" decoding="async"></TH></TR></THEAD>
<TBODY style="BOX-SIZING: border-box">
<TR style="BOX-SIZING: border-box">
<TD style="BOX-SIZING: border-box; COLOR: ; TEXT-ALIGN: center">Figure 6: Throughput (log-scale), for (a) increasing number of client sessions, and (b) increasing payload size, for a database size of 1M keys.</TD></TR></TBODY></TABLE>
<P style='BOX-SIZING: border-box; FONT-SIZE: 17px; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(28,30,33); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>In Figure 7, we perform the same type of experiment as previously stated fixing the number of client sessions to 64, and the payload to 128 bytes while increasing the batchsize. Note that even for batch size of 4,<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box">Garnet's</STRONG><SPAN>&nbsp;</SPAN>throughput gains are noticeably higher than any other system that we tested. This demonstrates that even for small batch size we still outperform the competing systems.</P>
<TABLE style='BOX-SIZING: border-box; FONT-SIZE: 17px; OVERFLOW: auto; FONT-FAMILY: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(28,30,33); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; DISPLAY: block; LETTER-SPACING: normal; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<THEAD style="BOX-SIZING: border-box">
<TR style="BOX-SIZING: border-box; BORDER-BOTTOM: 2px solid">
<TH style="BOX-SIZING: border-box; COLOR: ; TEXT-ALIGN: center"><IMG class=img_ev3q style="BOX-SIZING: border-box; MAX-WIDTH: 100%; HEIGHT: auto" alt=tpt-pfadd-batchsize.png src="https://microsoft.github.io/garnet/assets/images/tpt-pfadd-batchsize-23481d24c0c83e9727ddbd4363660274.png" width=1805 height=602 loading="lazy" decoding="async"></TH></TR></THEAD>
<TBODY style="BOX-SIZING: border-box">
<TR style="BOX-SIZING: border-box">
<TD style="BOX-SIZING: border-box; COLOR: ; TEXT-ALIGN: center">Figure 7: Throughput (log-scale), for increasing batchsize by 64 client sessions on a DB with (a) 1024 keys, (b) 1M keys.</TD></TR></TBODY></TABLE>