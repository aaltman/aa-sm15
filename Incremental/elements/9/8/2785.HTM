<b> : </b>The problem</H2>
<P style="BOX-SIZING: border-box; FONT-FAMILY: var(--desktop-large-body-copy-family); WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">Failures in which the application doesn&#8217;t get a response from the database within the expected time frame, such as a temporary network disruption, can result in an amplification of the load imposed on the entire system. Factors contributing to this load amplification include the increased time network connections remain open waiting on a response, the overhead of churning connections that timeout, application retry policies, and back-pressure queueing mechanisms.</P>
<P style="BOX-SIZING: border-box; FONT-FAMILY: var(--desktop-large-body-copy-family); WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">When applications perform high volumes of concurrent database operations at scale, this load amplification can be significantly greater than during steady-state. In extreme cases, this type of scenario can manifest as a<SPAN>&nbsp;</SPAN><A style='BOX-SIZING: border-box; CURSOR: pointer; TEXT-DECORATION: none; FONT-FAMILY: var(--helvetica, "Neue Helvetica Now Pro"),Helvetica; BORDER-BOTTOM: rgb(0,122,171) 1px solid; COLOR: ' href="https://sigops.org/s/conferences/hotos/2021/papers/hotos21-s11-bronson.pdf">metastable failure</A><SPAN>&nbsp;</SPAN>where the load amplification becomes a sustaining feedback loop that results in the failed state persisting even when the original trigger of the failure state (network disruption) has been resolved.</P>
<P style="BOX-SIZING: border-box; FONT-FAMILY: var(--desktop-large-body-copy-family); WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">As a simple example, consider a typical HTTP-based API in which an HTTP request to the application results in a single database read. This is illustrated in the sequence diagram below:</P><FIGURE class=_figure_abn6g_1 style='BOX-SIZING: border-box; FONT-SIZE: medium; FONT-FAMILY: "Neue Helvetica Now Pro", system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); OUTLINE-WIDTH: 1px; FONT-STYLE: normal; OUTLINE-STYLE: solid; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 20px; DISPLAY: flex; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; flex-direction: column'><IMG class="_image_espsy_21 _img_abn6g_17" style="BOX-SIZING: border-box; MARGIN-BOTTOM: 0px; CURSOR: pointer; MAX-WIDTH: 100%; HEIGHT: auto" alt=circuit-breaker-pattern-http-response src="https://images.ctfassets.net/drk57q8lctrm/5PLRLvJUt7qeXEow4fXtnv/52b6fab645bdf74d96fe4296becf93d7/circuit-breaker-pattern-http-response.webp" width=1920 height=684 data-id="5PLRLvJUt7qeXEow4fXtnv"><FIGCAPTION class=_figcaption_abn6g_8 style="BOX-SIZING: border-box; COLOR: ; PADDING-BOTTOM: 0.5em; FONT-STYLE: italic; TEXT-ALIGN: right; PADDING-TOP: 0.8em; PADDING-LEFT: 0.8em; PADDING-RIGHT: 0.8em">A diagram with six boxes, three above and three below with arrows going right and left throughout.</FIGCAPTION></FIGURE>
<P style="BOX-SIZING: border-box; FONT-FAMILY: var(--desktop-large-body-copy-family); WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">The system load created from this steady-state usage pattern is often what the system is designed to be able to sustain.</P>
<P style="BOX-SIZING: border-box; FONT-FAMILY: var(--desktop-large-body-copy-family); WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">But now consider what happens when there is a network failure that results in the application timing out database operations. Since the application doesn&#8217;t know the nature of the network timeout, it might also close the TCP connection and open a new one (connection churn). Churning connections can be expensive&#8211;especially when connecting must do a<SPAN>&nbsp;</SPAN><A style='BOX-SIZING: border-box; CURSOR: pointer; TEXT-DECORATION: none; FONT-FAMILY: var(--helvetica, "Neue Helvetica Now Pro"),Helvetica; BORDER-BOTTOM: rgb(0,122,171) 1px solid; COLOR: ' href="https://en.wikipedia.org/wiki/Transport_Layer_Security#TLS_handshake">TLS handshake</A>. Database applications designed for high availability often retry read operations against replicas (Aerospike does by default), which, during this type of failure, could also timeout and churn another connection per retry.</P>
<P style="BOX-SIZING: border-box; FONT-FAMILY: var(--desktop-large-body-copy-family); WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">This is illustrated in the sequence diagram below:</P><FIGURE class=_figure_abn6g_1 style='BOX-SIZING: border-box; FONT-SIZE: medium; FONT-FAMILY: "Neue Helvetica Now Pro", system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); OUTLINE-WIDTH: 1px; FONT-STYLE: normal; OUTLINE-STYLE: solid; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 20px; DISPLAY: flex; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; flex-direction: column'><IMG class="_image_espsy_21 _img_abn6g_17" style="BOX-SIZING: border-box; MARGIN-BOTTOM: 0px; CURSOR: pointer; MAX-WIDTH: 100%; HEIGHT: auto" alt=circuit-breaker-pattern-http-client-db-node src="https://images.ctfassets.net/drk57q8lctrm/3ZZ9ZQm6y1ddjHNR0kqWMR/bbcb6c8c1b7c8eb4b61ddbd82f012ba4/circuit-breaker-pattern-http-client-db-node.webp" width=1920 height=1121 data-id="3ZZ9ZQm6y1ddjHNR0kqWMR"><FIGCAPTION class=_figcaption_abn6g_8 style="BOX-SIZING: border-box; COLOR: ; PADDING-BOTTOM: 0.5em; FONT-STYLE: italic; TEXT-ALIGN: right; PADDING-TOP: 0.8em; PADDING-LEFT: 0.8em; PADDING-RIGHT: 0.8em">A technical diagram with four boxes above and below with many arrows going side to side.</FIGCAPTION></FIGURE>
<P style="BOX-SIZING: border-box; FONT-FAMILY: var(--desktop-large-body-copy-family); WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">Each attempted transaction is now consuming significantly more time and resources than it would during steady state. This is &#8220;load amplification&#8221; triggered by the network outage.</P>
<P style="BOX-SIZING: border-box; FONT-FAMILY: var(--desktop-large-body-copy-family); WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(26,26,26); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">Now imagine hundreds or thousands of concurrent application threads performing hundreds, thousands, or millions of database operations per second. The cost of churning a connection adds up at scale. A network outage lasting mere seconds can trigger a metastable failure that lasts far beyond the trigger event, and the only way to recover is to reduce the load on the system. Simply scaling the system to handle the worst-case load amplification wouldn&#8217;t be practical or cost-effective.