<b> : </b>Solution</H2></DIV>
<P style='FONT-SIZE: 16px; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 1px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); MARGIN-RIGHT: 1px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; overflow-wrap: break-word'>The Circuit Breaker pattern, popularized by Michael Nygard in his book,<SPAN>&nbsp;</SPAN><A style="CURSOR: pointer; TEXT-DECORATION: none; COLOR: ; OUTLINE-WIDTH: 0px; OUTLINE-COLOR: ; overflow-wrap: break-word" href="https://pragprog.com/titles/mnee2/" data-linktype="external">Release It!</A>, can prevent an application from repeatedly trying to execute an operation that's likely to fail. Allowing it to continue without waiting for the fault to be fixed or wasting CPU cycles while it determines that the fault is long lasting. The Circuit Breaker pattern also enables an application to detect whether the fault has been resolved. If the problem appears to have been fixed, the application can try to invoke the operation.</P>
<BLOCKQUOTE style='FONT-SIZE: 16px; BORDER-TOP: 0px solid; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; BORDER-RIGHT: 0px solid; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: 0px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0.8em; BORDER-LEFT: 3px solid; ORPHANS: 2; WIDOWS: 2; MARGIN: 1.2em 0px 2em; DISPLAY: block; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0.8em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<P style="MARGIN-TOP: 1px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; MARGIN-RIGHT: 1px; overflow-wrap: break-word">The purpose of the Circuit Breaker pattern is different than the Retry pattern. The Retry pattern enables an application to retry an operation in the expectation that it'll succeed. The Circuit Breaker pattern prevents an application from performing an operation that is likely to fail. An application can combine these two patterns by using the Retry pattern to invoke an operation through a circuit breaker. However, the retry logic should be sensitive to any exceptions returned by the circuit breaker and abandon retry attempts if the circuit breaker indicates that a fault is not transient.</P></BLOCKQUOTE>
<P style='FONT-SIZE: 16px; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 1px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); MARGIN-RIGHT: 1px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; overflow-wrap: break-word'>A circuit breaker acts as a proxy for operations that might fail. The proxy should monitor the number of recent failures that have occurred, and use this information to decide whether to allow the operation to proceed, or simply return an exception immediately.</P>
<P style='FONT-SIZE: 16px; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 1px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); MARGIN-RIGHT: 1px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; overflow-wrap: break-word'>The proxy can be implemented as a state machine with the following states that mimic the functionality of an electrical circuit breaker:</P>
<UL style='LIST-STYLE-TYPE: none; FONT-SIZE: 16px; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 16px 0px 16px 38px; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<LI style="LIST-STYLE-TYPE: disc; OUTLINE-WIDTH: 0px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px">
<P style="MARGIN-TOP: 1px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; MARGIN-RIGHT: 1px; overflow-wrap: break-word"><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Closed</STRONG>: The request from the application is routed to the operation. The proxy maintains a count of the number of recent failures, and if the call to the operation is unsuccessful the proxy increments this count. If the number of recent failures exceeds a specified threshold within a given time period, the proxy is placed into the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Open</STRONG><SPAN>&nbsp;</SPAN>state. At this point the proxy starts a timeout timer, and when this timer expires the proxy is placed into the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Half-Open</STRONG><SPAN>&nbsp;</SPAN>state.</P>
<BLOCKQUOTE style="BORDER-TOP: 0px solid; BORDER-RIGHT: 0px solid; BORDER-BOTTOM: 0px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0.8em; BORDER-LEFT: 3px solid; MARGIN: 1.2em 0px 2em; DISPLAY: block; OUTLINE-COLOR: ; PADDING-RIGHT: 0.8em">
<P style="MARGIN-TOP: 1px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; MARGIN-RIGHT: 1px; overflow-wrap: break-word">The purpose of the timeout timer is to give the system time to fix the problem that caused the failure before allowing the application to try to perform the operation again.</P></BLOCKQUOTE></LI>
<LI style="LIST-STYLE-TYPE: disc; OUTLINE-WIDTH: 0px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px">
<P style="MARGIN-TOP: 1px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; MARGIN-RIGHT: 1px; overflow-wrap: break-word"><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Open</STRONG>: The request from the application fails immediately and an exception is returned to the application.</P></LI>
<LI style="LIST-STYLE-TYPE: disc; OUTLINE-WIDTH: 0px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px">
<P style="MARGIN-TOP: 1px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; MARGIN-RIGHT: 1px; overflow-wrap: break-word"><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Half-Open</STRONG>: A limited number of requests from the application are allowed to pass through and invoke the operation. If these requests are successful, it's assumed that the fault that was previously causing the failure has been fixed and the circuit breaker switches to the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Closed</STRONG><SPAN>&nbsp;</SPAN>state (the failure counter is reset). If any request fails, the circuit breaker assumes that the fault is still present so it reverts to the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Open</STRONG><SPAN>&nbsp;</SPAN>state and restarts the timeout timer to give the system a further period of time to recover from the failure.</P>
<BLOCKQUOTE style="BORDER-TOP: 0px solid; BORDER-RIGHT: 0px solid; BORDER-BOTTOM: 0px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0.8em; BORDER-LEFT: 3px solid; MARGIN: 1.2em 0px 2em; DISPLAY: block; OUTLINE-COLOR: ; PADDING-RIGHT: 0.8em">
<P style="MARGIN-TOP: 1px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; MARGIN-RIGHT: 1px; overflow-wrap: break-word">The<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Half-Open</STRONG><SPAN>&nbsp;</SPAN>state is useful to prevent a recovering service from suddenly being flooded with requests. As a service recovers, it might be able to support a limited volume of requests until the recovery is complete, but while recovery is in progress a flood of work can cause the service to time out or fail again.</P></BLOCKQUOTE></LI></UL>
<P style='FONT-SIZE: 16px; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 1px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); MARGIN-RIGHT: 1px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; overflow-wrap: break-word'><IMG style="MAX-WIDTH: 100%; BORDER-TOP: 0px; HEIGHT: auto; BORDER-RIGHT: 0px; VERTICAL-ALIGN: baseline; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; DISPLAY: inline-block; OUTLINE-COLOR: " alt="Circuit Breaker states" src="https://learn.microsoft.com/en-us/azure/architecture/patterns/_images/circuit-breaker-diagram.png" data-linktype="absolute-path"></P>
<P style='FONT-SIZE: 16px; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 1px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); MARGIN-RIGHT: 1px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; overflow-wrap: break-word'>In the figure, the failure counter used by the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Closed</STRONG><SPAN>&nbsp;</SPAN>state is time based. It's automatically reset at periodic intervals. This helps to prevent the circuit breaker from entering the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Open</STRONG><SPAN>&nbsp;</SPAN>state if it experiences occasional failures. The failure threshold that trips the circuit breaker into the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Open</STRONG><SPAN>&nbsp;</SPAN>state is only reached when a specified number of failures have occurred during a specified interval. The counter used by the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Half-Open</STRONG><SPAN>&nbsp;</SPAN>state records the number of successful attempts to invoke the operation. The circuit breaker reverts to the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Closed</STRONG><SPAN>&nbsp;</SPAN>state after a specified number of consecutive operation invocations have been successful. If any invocation fails, the circuit breaker enters the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Open</STRONG><SPAN>&nbsp;</SPAN>state immediately and the success counter will be reset the next time it enters the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Half-Open</STRONG><SPAN>&nbsp;</SPAN>state.</P>
<BLOCKQUOTE style='FONT-SIZE: 16px; BORDER-TOP: 0px solid; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; BORDER-RIGHT: 0px solid; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: 0px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0.8em; BORDER-LEFT: 3px solid; ORPHANS: 2; WIDOWS: 2; MARGIN: 1.2em 0px 2em; DISPLAY: block; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0.8em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<P style="MARGIN-TOP: 1px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; MARGIN-RIGHT: 1px; overflow-wrap: break-word">How the system recovers is handled externally, possibly by restoring or restarting a failed component or repairing a network connection.</P></BLOCKQUOTE>
<P style='FONT-SIZE: 16px; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 1px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); MARGIN-RIGHT: 1px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; overflow-wrap: break-word'>The Circuit Breaker pattern provides stability while the system recovers from a failure and minimizes the impact on performance. It can help to maintain the response time of the system by quickly rejecting a request for an operation that's likely to fail, rather than waiting for the operation to time out, or never return. If the circuit breaker raises an event each time it changes state, this information can be used to monitor the health of the part of the system protected by the circuit breaker, or to alert an administrator when a circuit breaker trips to the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Open</STRONG><SPAN>&nbsp;</SPAN>state.</P>
<P style='FONT-SIZE: 16px; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 1px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN-LEFT: 1px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; OUTLINE-COLOR: ; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); MARGIN-RIGHT: 1px; TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; overflow-wrap: break-word'>The pattern is customizable and can be adapted according to the type of the possible failure. For example, you can apply an increasing timeout timer to a circuit breaker. You could place the circuit breaker in the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Open</STRONG><SPAN>&nbsp;</SPAN>state for a few seconds initially, and then if the failure hasn't been resolved increase the timeout to a few minutes, and so on. In some cases, rather than the<SPAN>&nbsp;</SPAN><STRONG style="FONT-WEIGHT: 600; OUTLINE-COLOR: ">Open</STRONG><SPAN>&nbsp;</SPAN>state returning failure and raising an exception, it could be useful to return a default value that is meaningful to the application.</P>
<DIV class=heading-wrapper style='FONT-SIZE: 16px; FONT-FAMILY: "Segoe UI", SegoeUI, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; POSITION: relative; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(22,22,22); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; OUTLINE-COLOR: ; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial' data-heading-level="h2"><A aria-label="Section titled: Issues and considerations" class="anchor-link docon docon-link" style="OVERFLOW: hidden; CURSOR: pointer; TEXT-DECORATION: none; BORDER-TOP: 0px; CLIP: rect(1px 1px 1px 1px); HEIGHT: 1px; FONT-FAMILY: docons; BORDER-RIGHT: 0px; FONT-VARIANT: normal; WIDTH: 1px; BORDER-BOTTOM: 0px; POSITION: absolute; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: ; OUTLINE-WIDTH: 0px; PADDING-BOTTOM: 0px; DIRECTION: ltr; FONT-STYLE: normal; TEXT-ALIGN: center; PADDING-TOP: 0px; PADDING-LEFT: 0px; BORDER-LEFT: 0px; MARGIN: -1px; DISPLAY: inline-block; OUTLINE-COLOR: ; LINE-HEIGHT: 16px; PADDING-RIGHT: 0px; overflow-wrap: normal; speak: none; -webkit-font-smoothing: antialiased; transition: opacity 0.1s linear; inset-inline-start: -1.875rem; transform: translateY(-50%) scale(1); inset-block-start: 1.38125rem; clip-path: inset(50%); opacity: 0" href="https://learn.microsoft.com/en-us/azure/architecture/patterns/circuit-breaker#issues-and-considerations"></A>