<b> : </b><SPAN role=heading aria-level=3 class=devsite-heading>Setting the lifespan of a message</SPAN></H3>
<P></P>
<P></P>
<P><SPAN class=notranslate>FCM</SPAN> usually delivers messages immediately after they are sent. However, this might not always be possible. For example, if the platform is Android, the device could be turned off, offline, or otherwise unavailable. Or <SPAN class=notranslate>FCM</SPAN> might intentionally delay messages to prevent an app from consuming excessive resources and negatively affecting battery life.</P>
<P></P>
<P></P>
<P>When this happens, <SPAN class=notranslate>FCM</SPAN> stores the message and delivers it as soon as it's feasible. While this is fine in most cases, there are some apps for which a late message might as well never be delivered. For example, if the message is an incoming call or video chat notification, it is meaningful only for a short period of time before the call is terminated. Or if the message is an invitation to an event, it is useless if received after the event has ended. </P>
<P></P>
<P></P>
<P>On Android and Web/JavaScript, you can specify the maximum lifespan of a message. The value must be a duration from 0 to 2,419,200 seconds (28 days), and it corresponds to the maximum period of time for which <SPAN class=notranslate>FCM</SPAN> stores and attempts to deliver the message. Requests that don't contain this field default to the maximum period of four weeks.</P>
<P></P>
<P></P>
<P>Here are some possible uses for this feature:</P>
<UL>
<LI>Video chat incoming calls</LI>
<LI>Expiring invitation events</LI>
<LI>Calendar events</LI></UL>
<P></P>
<P></P>
<P>Another advantage of specifying the lifespan of a message is that <SPAN class=notranslate>FCM</SPAN> doesn't apply collapsible message throttling to messages with a time-to-live value of 0 seconds. <SPAN class=notranslate>FCM</SPAN> provides best effort handling of messages that must be delivered "now or never." Keep in mind that a <CODE dir=ltr translate="no">time_to_live</CODE> value of 0 means messages that can't be delivered immediately are discarded. However, because such messages are never stored, this provides the best latency for sending notification messages.</P>
<P></P>
<P></P>
<P>Here is an example of a request that includes TTL:</P><DEVSITE-CODE data-copy-event-label="">
<DIV role=group aria-label="Action buttons" class=devsite-code-buttons-container></DIV></DEVSITE-CODE><DEVSITE-CODE data-copy-event-label=""><PRE class=pretty-json dir=ltr translate="no" is-upgraded=""><SPAN class=pun>{</SPAN><SPAN class=pln><BR>&nbsp; </SPAN><SPAN class=str>"message"</SPAN><SPAN class=pun>:{</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; </SPAN><SPAN class=str>"token"</SPAN><SPAN class=pun>:</SPAN><SPAN class=str>"bk3RNwTe3H0:CI2k_HHwgIpoDKCIZvvDMExUdFQ3P1..."</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; </SPAN><SPAN class=str>"data"</SPAN><SPAN class=pun>:{</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; </SPAN><SPAN class=str>"Nick"</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>:</SPAN><SPAN class=pln> </SPAN><SPAN class=str>"Mario"</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; </SPAN><SPAN class=str>"body"</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>:</SPAN><SPAN class=pln> </SPAN><SPAN class=str>"great match!"</SPAN><SPAN class=pun>,</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; </SPAN><SPAN class=str>"Room"</SPAN><SPAN class=pln> </SPAN><SPAN class=pun>:</SPAN><SPAN class=pln> </SPAN><SPAN class=str>"PortugalVSDenmark"</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; </SPAN><SPAN class=pun>},</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; </SPAN><SPAN class=str>"apns"</SPAN><SPAN class=pun>:{</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; </SPAN><SPAN class=str>"headers"</SPAN><SPAN class=pun>:{</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; &nbsp; </SPAN><SPAN class=str>"apns-expiration"</SPAN><SPAN class=pun>:</SPAN><SPAN class=str>"1604750400"</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; </SPAN><SPAN class=pun>},</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; </SPAN><SPAN class=str>"android"</SPAN><SPAN class=pun>:{</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; </SPAN><SPAN class=str>"ttl"</SPAN><SPAN class=pun>:</SPAN><SPAN class=str>"4500s"</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; </SPAN><SPAN class=pun>},</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; </SPAN><SPAN class=str>"webpush"</SPAN><SPAN class=pun>:{</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; </SPAN><SPAN class=str>"headers"</SPAN><SPAN class=pun>:{</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; &nbsp; </SPAN><SPAN class=str>"TTL"</SPAN><SPAN class=pun>:</SPAN><SPAN class=str>"4500"</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; &nbsp; </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln><BR>&nbsp; &nbsp; </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln><BR>&nbsp; </SPAN><SPAN class=pun>}</SPAN><SPAN class=pln><BR></SPAN><SPAN class=pun>}</SPAN></PRE></DEVSITE-CODE>