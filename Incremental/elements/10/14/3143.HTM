<H3 style='FONT-SIZE: 16px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 1.1em; PADDING-LEFT: 0.75em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; PADDING-RIGHT: 0px; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Constants class=mw-headline>Constants</SPAN></H3>
<TABLE class=t-dsc-begin style='FONT-SIZE: 12px; MAX-WIDTH: 60em; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; BORDER-SPACING: 0px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<TBODY>
<TR class=t-dsc-header>
<TD style="FONT-SIZE: 0.8em; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; LINE-HEIGHT: 1em; PADDING-RIGHT: 0px" colSpan=2>
<DIV style="MARGIN-LEFT: 2em">Defined in header<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'><A title=cpp/header/atomic style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/header/atomic">&lt;atomic&gt;</A></CODE></DIV></TD></TR>
<TR class=t-dsc-hitem>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WHITE-SPACE: nowrap; FONT-WEIGHT: bold; PADDING-BOTTOM: 0.25em; PADDING-TOP: 0.2em; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.1em; PADDING-RIGHT: 0px">Name</TD>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WHITE-SPACE: nowrap; FONT-WEIGHT: bold; PADDING-BOTTOM: 0.25em; PADDING-TOP: 0.2em; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.1em; PADDING-RIGHT: 0px">Explanation</TD></TR>
<TR class=t-dsc>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WIDTH: 154px; WHITE-SPACE: nowrap; PADDING-BOTTOM: 0.25em; PADDING-TOP: 0.2em; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.2em; PADDING-RIGHT: 0px"><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_relaxed</CODE></TD>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WHITE-SPACE: normal; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.1em">Relaxed operation: there are no synchronization or ordering constraints imposed on other reads or writes, only this operation's atomicity is guaranteed (see<SPAN>&nbsp;</SPAN><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/memory_order#Relaxed_ordering">Relaxed ordering</A><SPAN>&nbsp;</SPAN>below).</TD></TR>
<TR class=t-dsc>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WIDTH: 154px; WHITE-SPACE: nowrap; PADDING-BOTTOM: 0.25em; PADDING-TOP: 0.2em; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.2em; PADDING-RIGHT: 0px"><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_consume</CODE></TD>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WHITE-SPACE: normal; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.1em">A load operation with this memory order performs a<SPAN>&nbsp;</SPAN><I>consume operation</I><SPAN>&nbsp;</SPAN>on the affected memory location: no reads or writes in the current thread dependent on the value currently loaded can be reordered before this load. Writes to data-dependent variables in other threads that release the same atomic variable are visible in the current thread. On most platforms, this affects compiler optimizations only (see<SPAN>&nbsp;</SPAN><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/memory_order#Release-Consume_ordering">Release-Consume ordering</A><SPAN>&nbsp;</SPAN>below).</TD></TR>
<TR class=t-dsc>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WIDTH: 154px; WHITE-SPACE: nowrap; PADDING-BOTTOM: 0.25em; PADDING-TOP: 0.2em; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.2em; PADDING-RIGHT: 0px"><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_acquire</CODE></TD>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WHITE-SPACE: normal; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.1em">A load operation with this memory order performs the<SPAN>&nbsp;</SPAN><I>acquire operation</I><SPAN>&nbsp;</SPAN>on the affected memory location: no reads or writes in the current thread can be reordered before this load. All writes in other threads that release the same atomic variable are visible in the current thread (see<SPAN>&nbsp;</SPAN><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/memory_order#Release-Acquire_ordering">Release-Acquire ordering</A><SPAN>&nbsp;</SPAN>below).</TD></TR>
<TR class=t-dsc>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WIDTH: 154px; WHITE-SPACE: nowrap; PADDING-BOTTOM: 0.25em; PADDING-TOP: 0.2em; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.2em; PADDING-RIGHT: 0px"><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_release</CODE></TD>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WHITE-SPACE: normal; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.1em">A store operation with this memory order performs the<SPAN>&nbsp;</SPAN><I>release operation</I>: no reads or writes in the current thread can be reordered after this store. All writes in the current thread are visible in other threads that acquire the same atomic variable (see<SPAN>&nbsp;</SPAN><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/memory_order#Release-Acquire_ordering">Release-Acquire ordering</A><SPAN>&nbsp;</SPAN>below) and writes that carry a dependency into the atomic variable become visible in other threads that consume the same atomic (see<SPAN>&nbsp;</SPAN><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/memory_order#Release-Consume_ordering">Release-Consume ordering</A><SPAN>&nbsp;</SPAN>below).</TD></TR>
<TR class=t-dsc>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WIDTH: 154px; WHITE-SPACE: nowrap; PADDING-BOTTOM: 0.25em; PADDING-TOP: 0.2em; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.2em; PADDING-RIGHT: 0px"><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_acq_rel</CODE></TD>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WHITE-SPACE: normal; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.1em">A read-modify-write operation with this memory order is both an<SPAN>&nbsp;</SPAN><I>acquire operation</I><SPAN>&nbsp;</SPAN>and a<SPAN>&nbsp;</SPAN><I>release operation</I>. No memory reads or writes in the current thread can be reordered before the load, nor after the store. All writes in other threads that release the same atomic variable are visible before the modification and the modification is visible in other threads that acquire the same atomic variable.</TD></TR>
<TR class=t-dsc>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WIDTH: 154px; WHITE-SPACE: nowrap; PADDING-BOTTOM: 0.25em; PADDING-TOP: 0.2em; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.2em; PADDING-RIGHT: 0px"><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE></TD>
<TD style="BORDER-TOP: rgb(204,204,204) 1px solid; WHITE-SPACE: normal; PADDING-LEFT: 0.75em; LINE-HEIGHT: 1.1em">A load operation with this memory order performs an<SPAN>&nbsp;</SPAN><I>acquire operation</I>, a store performs a<SPAN>&nbsp;</SPAN><I>release operation</I>, and read-modify-write performs both an<SPAN>&nbsp;</SPAN><I>acquire operation</I><SPAN>&nbsp;</SPAN>and a<SPAN>&nbsp;</SPAN><I>release operation</I>, plus a single total order exists in which all threads observe all modifications in the same order (see<SPAN>&nbsp;</SPAN><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/memory_order#Sequentially-consistent_ordering">Sequentially-consistent ordering</A><SPAN>&nbsp;</SPAN>below).</TD></TR></TBODY></TABLE>
<H3 style='FONT-SIZE: 16px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 1.1em; PADDING-LEFT: 0.75em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; PADDING-RIGHT: 0px; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Formal_description class=mw-headline>Formal description</SPAN></H3>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Inter-thread synchronization and memory ordering determine how<SPAN>&nbsp;</SPAN><I>evaluations</I><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><I>side effects</I><SPAN>&nbsp;</SPAN>of expressions are ordered between different threads of execution. They are defined in the following terms:</P>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Sequenced-before class=mw-headline>Sequenced-before</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Within the same thread, evaluation A may be<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>evaluation B, as described in<SPAN>&nbsp;</SPAN><A title="cpp/language/eval order" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/language/eval_order">evaluation order</A>.</P>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Carries_dependency class=mw-headline>Carries dependency</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Within the same thread, evaluation A that is<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>evaluation B may also carry a dependency into B (that is, B depends on A), if any of the following is true:</P>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>The value of A is used as an operand of B,<SPAN>&nbsp;</SPAN><B style="FONT-WEIGHT: bold; TEXT-INDENT: 0em">except</B></DIV>
<DIV class=t-li2 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 5em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">a)</SPAN><SPAN>&nbsp;</SPAN>if B is a call to<SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; TEXT-INDENT: 0em'><A title="cpp/atomic/kill dependency" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/kill_dependency">std::kill_dependency</A></SPAN>,</DIV>
<DIV class=t-li2 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 5em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">b)</SPAN><SPAN>&nbsp;</SPAN>if A is the left operand of the built-in<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; TEXT-INDENT: 0em; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal"><SPAN class=sy3 style="COLOR: rgb(0,0,64)">&amp;&amp;</SPAN></SPAN></SPAN>,<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; TEXT-INDENT: 0em; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal"><SPAN class=sy3 style="COLOR: rgb(0,0,64)">||</SPAN></SPAN></SPAN>,<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; TEXT-INDENT: 0em; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal"><SPAN class=sy4 style="COLOR: rgb(0,128,128)">?:</SPAN></SPAN></SPAN>, or<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; TEXT-INDENT: 0em; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal">,</SPAN></SPAN><SPAN>&nbsp;</SPAN>operators.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>A writes to a scalar object M, B reads from M.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">3)</SPAN><SPAN>&nbsp;</SPAN>A carries dependency into another evaluation X, and X carries dependency into B.</DIV>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Modification_order class=mw-headline>Modification order</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>All modifications to any particular atomic variable occur in a total order that is specific to this one atomic variable.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>The following four requirements are guaranteed for all atomic operations:</P>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN><B style="FONT-WEIGHT: bold; TEXT-INDENT: 0em">Write-write coherence</B>: If evaluation A that modifies some atomic M (a write)<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>evaluation B that modifies M, then A appears earlier than B in the<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">modification order</I><SPAN>&nbsp;</SPAN>of M.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN><B style="FONT-WEIGHT: bold; TEXT-INDENT: 0em">Read-read coherence</B>: if a value computation A of some atomic M (a read)<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>a value computation B on M, and if the value of A comes from a write X on M, then the value of B is either the value stored by X, or the value stored by a side effect Y on M that appears later than X in the<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">modification order</I><SPAN>&nbsp;</SPAN>of M.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">3)</SPAN><SPAN>&nbsp;</SPAN><B style="FONT-WEIGHT: bold; TEXT-INDENT: 0em">Read-write coherence</B>: if a value computation A of some atomic M (a read)<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>an operation B on M (a write), then the value of A comes from a side-effect (a write) X that appears earlier than B in the<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">modification order</I><SPAN>&nbsp;</SPAN>of M.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">4)</SPAN><SPAN>&nbsp;</SPAN><B style="FONT-WEIGHT: bold; TEXT-INDENT: 0em">Write-read coherence</B>: if a side effect (a write) X on an atomic object M<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>a value computation (a read) B of M, then the evaluation B shall take its value from X or from a side effect Y that follows X in the modification order of M.</DIV>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Release_sequence class=mw-headline>Release sequence</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>After a<SPAN>&nbsp;</SPAN><I>release operation</I><SPAN>&nbsp;</SPAN>A is performed on an atomic object M, the longest continuous subsequence of the modification order of M that consists of:</P>
<TABLE class=t-rev-begin style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; BORDER-SPACING: 0px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<TBODY>
<TR class="t-rev t-until-cxx20">
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: medium none; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: silver 1px solid; PADDING-RIGHT: 0.2em; border-image: initial">
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>Writes performed by the same thread that performed A.</DIV></TD>
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: silver 1px solid; WHITE-SPACE: nowrap; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: medium none; PADDING-RIGHT: 0.2em; border-image: initial"><SPAN class="t-mark-rev t-until-cxx20" style="FONT-SIZE: 0.8em; COLOR: rgb(0,128,0)">(until C++20)</SPAN></TD></TR></TBODY></TABLE>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>Atomic read-modify-write operations made to M by any thread.</DIV>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Is known as<SPAN>&nbsp;</SPAN><I>release sequence headed by A</I>.</P>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Synchronizes_with class=mw-headline>Synchronizes with</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>If an atomic store in thread A is a<SPAN>&nbsp;</SPAN><I>release operation</I>, an atomic load in thread B from the same variable is an<SPAN>&nbsp;</SPAN><I>acquire operation</I>, and the load in thread B reads a value written by the store in thread A, then the store in thread A<SPAN>&nbsp;</SPAN><I>synchronizes-with</I><SPAN>&nbsp;</SPAN>the load in thread B.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Also, some library calls may be defined to<SPAN>&nbsp;</SPAN><I>synchronize-with</I><SPAN>&nbsp;</SPAN>other library calls on other threads.</P>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Dependency-ordered_before class=mw-headline>Dependency-ordered before</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Between threads, evaluation A is<SPAN>&nbsp;</SPAN><I>dependency-ordered before</I><SPAN>&nbsp;</SPAN>evaluation B if any of the following is true:</P>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>A performs a<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">release operation</I><SPAN>&nbsp;</SPAN>on some atomic M, and, in a different thread, B performs a<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">consume operation</I><SPAN>&nbsp;</SPAN>on the same atomic M, and B reads a value written<SPAN>&nbsp;</SPAN><SPAN class="t-rev-inl t-until-cxx20" style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: silver 1px solid; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; BORDER-LEFT: silver 1px solid; MARGIN: 0px; PADDING-RIGHT: 0px; TEXT-INDENT: 0em"><SPAN style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px">by any part of the release sequence headed</SPAN><SPAN style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px"><SPAN class="t-mark-rev t-until-cxx20" style="FONT-SIZE: 0.8em; COLOR: rgb(0,128,0)">(until C++20)</SPAN></SPAN></SPAN><SPAN>&nbsp;</SPAN>by A.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>A is dependency-ordered before X and X carries a dependency into B.</DIV>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Inter-thread_happens-before class=mw-headline>Inter-thread happens-before</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Between threads, evaluation A<SPAN>&nbsp;</SPAN><I>inter-thread happens before</I><SPAN>&nbsp;</SPAN>evaluation B if any of the following is true:</P>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">synchronizes-with</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>A is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">dependency-ordered before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">3)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">synchronizes-with</I><SPAN>&nbsp;</SPAN>some evaluation X, and X is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">sequenced-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">4)</SPAN><SPAN>&nbsp;</SPAN>A is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">sequenced-before</I><SPAN>&nbsp;</SPAN>some evaluation X, and X<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">inter-thread happens-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">5)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">inter-thread happens-before</I><SPAN>&nbsp;</SPAN>some evaluation X, and X<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">inter-thread happens-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Happens-before class=mw-headline>Happens-before</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Regardless of threads, evaluation A<SPAN>&nbsp;</SPAN><I>happens-before</I><SPAN>&nbsp;</SPAN>evaluation B if any of the following is true:</P>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>A is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">sequenced-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">inter-thread happens before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>The implementation is required to ensure that the<SPAN>&nbsp;</SPAN><I>happens-before</I><SPAN>&nbsp;</SPAN>relation is acyclic, by introducing additional synchronization if necessary (it can only be necessary if a consume operation is involved, see<SPAN>&nbsp;</SPAN><A class="external text" style="TEXT-DECORATION: none; BACKGROUND: url(//upload.cppreference.com/mwiki/images/2/23/Icons-mini-file_acrobat.gif) no-repeat right center; COLOR: rgb(51,102,187); PADDING-RIGHT: 18px" href="https://www.cl.cam.ac.uk/~pes20/cpp/popl085ap-sewell.pdf" rel=nofollow>Batty et al</A>).</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>If one evaluation modifies a memory location, and the other reads or modifies the same memory location, and if at least one of the evaluations is not an atomic operation, the behavior of the program is undefined (the program has a<SPAN>&nbsp;</SPAN><A title="cpp/language/memory model" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/language/memory_model">data race</A>) unless there exists a<SPAN>&nbsp;</SPAN><I>happens-before</I><SPAN>&nbsp;</SPAN>relationship between these two evaluations.</P>
<TABLE class=t-rev-begin style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; BORDER-SPACING: 0px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<TBODY>
<TR class="t-rev t-since-cxx20">
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: medium none; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: silver 1px solid; PADDING-RIGHT: 0.2em; border-image: initial">
<H4 style="FONT-SIZE: 14px; OVERFLOW: hidden; WIDTH: auto; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: medium none; FONT-WEIGHT: bold; COLOR: black; PADDING-BOTTOM: 0.17em; PADDING-TOP: 0.5em; MARGIN: 0px 0px 0.3em"><SPAN id=Simply_happens-before class=mw-headline>Simply happens-before</SPAN></H4>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">Regardless of threads, evaluation A<SPAN>&nbsp;</SPAN><I>simply happens-before</I><SPAN>&nbsp;</SPAN>evaluation B if any of the following is true:</P>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>A is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">sequenced-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">synchronizes-with</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">3)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">simply happens-before</I><SPAN>&nbsp;</SPAN>X, and X<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">simply happens-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<P style="MARGIN: 0.4em 0px 0em; LINE-HEIGHT: 1.2em">Note: without consume operations,<SPAN>&nbsp;</SPAN><I>simply happens-before</I><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><I>happens-before</I><SPAN>&nbsp;</SPAN>relations are the same.</P></TD>
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: silver 1px solid; WHITE-SPACE: nowrap; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: medium none; PADDING-RIGHT: 0.2em; border-image: initial"><SPAN class="t-mark-rev t-since-cxx20" style="FONT-SIZE: 0.8em; COLOR: rgb(0,128,0)">(since C++20)</SPAN></TD></TR></TBODY></TABLE>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Strongly_happens-before class=mw-headline>Strongly happens-before</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Regardless of threads, evaluation A<SPAN>&nbsp;</SPAN><I>strongly happens-before</I><SPAN>&nbsp;</SPAN>evaluation B if any of the following is true:</P>
<TABLE class=t-rev-begin style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; BORDER-SPACING: 0px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<TBODY>
<TR class="t-rev t-until-cxx20">
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: medium none; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: silver 1px solid; PADDING-RIGHT: 0.2em; border-image: initial">
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>A is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">sequenced-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">synchronizes-with</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">3)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">strongly happens-before</I><SPAN>&nbsp;</SPAN>X, and X<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">strongly happens-before</I><SPAN>&nbsp;</SPAN>B.</DIV></TD>
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: silver 1px solid; WHITE-SPACE: nowrap; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: medium none; PADDING-RIGHT: 0.2em; border-image: initial"><SPAN class="t-mark-rev t-until-cxx20" style="FONT-SIZE: 0.8em; COLOR: rgb(0,128,0)">(until C++20)</SPAN></TD></TR>
<TR class="t-rev t-since-cxx20">
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: medium none; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: silver 1px solid; PADDING-RIGHT: 0.2em; border-image: initial">
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>A is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">sequenced-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">synchronizes with</I><SPAN>&nbsp;</SPAN>B, and both A and B are sequentially consistent atomic operations.</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">3)</SPAN><SPAN>&nbsp;</SPAN>A is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">sequenced-before</I><SPAN>&nbsp;</SPAN>X, X<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">simply happens-before</I><SPAN>&nbsp;</SPAN>Y, and Y is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">sequenced-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">4)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">strongly happens-before</I><SPAN>&nbsp;</SPAN>X, and X<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">strongly happens-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">Note: informally, if A<SPAN>&nbsp;</SPAN><I>strongly happens-before</I><SPAN>&nbsp;</SPAN>B, then A appears to be evaluated before B in all contexts.</P>
<P style="MARGIN: 0.4em 0px 0em; LINE-HEIGHT: 1.2em">Note:<SPAN>&nbsp;</SPAN><I>strongly happens-before</I><SPAN>&nbsp;</SPAN>excludes consume operations.</P></TD>
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: silver 1px solid; WHITE-SPACE: nowrap; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: medium none; PADDING-RIGHT: 0.2em; border-image: initial"><SPAN class="t-mark-rev t-since-cxx20" style="FONT-SIZE: 0.8em; COLOR: rgb(0,128,0)">(since C++20)</SPAN></TD></TR></TBODY></TABLE>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Visible_side-effects class=mw-headline>Visible side-effects</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>The side-effect A on a scalar M (a write) is<SPAN>&nbsp;</SPAN><I>visible</I><SPAN>&nbsp;</SPAN>with respect to value computation B on M (a read) if both of the following are true:</P>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<DIV class=t-li1 style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: -5em; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>There is no other side effect X to M where A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>X and X<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>If side-effect A is visible with respect to the value computation B, then the longest contiguous subset of the side-effects to M, in<SPAN>&nbsp;</SPAN><I>modification order</I>, where B does not<SPAN>&nbsp;</SPAN><I>happen-before</I><SPAN>&nbsp;</SPAN>it is known as the<SPAN>&nbsp;</SPAN><I>visible sequence of side-effects</I><SPAN>&nbsp;</SPAN>(the value of M, determined by B, will be the value stored by one of these side effects).</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Note: inter-thread synchronization boils down to preventing data races (by establishing happens-before relationships) and defining which side effects become visible under what conditions.</P>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Consume_operation class=mw-headline>Consume operation</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Atomic load with<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_consume</CODE><SPAN>&nbsp;</SPAN>or stronger is a consume operation. Note that<SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/atomic/atomic thread fence" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/atomic_thread_fence">std::atomic_thread_fence</A></SPAN><SPAN>&nbsp;</SPAN>imposes stronger synchronization requirements than a consume operation.</P>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Acquire_operation class=mw-headline>Acquire operation</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Atomic load with<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_acquire</CODE><SPAN>&nbsp;</SPAN>or stronger is an acquire operation. The lock() operation on a<SPAN>&nbsp;</SPAN><A title="cpp/named req/Mutex" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/named_req/Mutex"><SPAN style='FONT-FAMILY: Georgia, "DejaVu Serif", serif; FONT-STYLE: italic'>Mutex</SPAN></A><SPAN>&nbsp;</SPAN>is also an acquire operation. Note that<SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/atomic/atomic thread fence" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/atomic_thread_fence">std::atomic_thread_fence</A></SPAN><SPAN>&nbsp;</SPAN>imposes stronger synchronization requirements than an acquire operation.</P>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Release_operation class=mw-headline>Release operation</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Atomic store with<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_release</CODE><SPAN>&nbsp;</SPAN>or stronger is a release operation. The unlock() operation on a<SPAN>&nbsp;</SPAN><A title="cpp/named req/Mutex" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/named_req/Mutex"><SPAN style='FONT-FAMILY: Georgia, "DejaVu Serif", serif; FONT-STYLE: italic'>Mutex</SPAN></A><SPAN>&nbsp;</SPAN>is also a release operation. Note that<SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/atomic/atomic thread fence" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/atomic_thread_fence">std::atomic_thread_fence</A></SPAN><SPAN>&nbsp;</SPAN>imposes stronger synchronization requirements than a release operation.</P>
<H3 style='FONT-SIZE: 16px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 1.1em; PADDING-LEFT: 0.75em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; PADDING-RIGHT: 0px; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Explanation class=mw-headline>Explanation</SPAN></H3>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Relaxed_ordering class=mw-headline>Relaxed ordering</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Atomic operations tagged<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal">memory_order_relaxed</SPAN></SPAN><SPAN>&nbsp;</SPAN>are not synchronization operations; they do not impose an order among concurrent memory accesses. They only guarantee atomicity and modification order consistency.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>For example, with<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>x</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>y</CODE><SPAN>&nbsp;</SPAN>initially zero,</P>
<DIV class=mw-geshi style='FONT-SIZE: 12px; OVERFLOW: auto; BORDER-TOP: silver 1px solid; FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BORDER-RIGHT: silver 1px solid; WIDTH: 55em; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: silver 1px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 1em; FONT-STYLE: normal; TEXT-ALIGN: left; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: silver 1px solid; ORPHANS: 2; WIDOWS: 2; MARGIN: 1em 0px; LETTER-SPACING: normal; PADDING-RIGHT: 1em; BACKGROUND-COLOR: rgb(249,249,249); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; border-radius: 5px' dir=ltr>
<DIV class="cpp source-cpp" style="FONT-FAMILY: monospace; LINE-HEIGHT: normal"><PRE class=de1 style="OVERFLOW: auto; BORDER-TOP: white 0px; BORDER-RIGHT: white 0px; WIDTH: 55em; VERTICAL-ALIGN: top; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: white 0px; COLOR: black; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; FONT: 1em/1.2em monospace; PADDING-LEFT: 0px; BORDER-LEFT: white 0px; MARGIN: 0px; PADDING-RIGHT: 0px; border-radius: 5px"><SPAN class=co1 style="COLOR: rgb(144,144,144)">// Thread 1:</SPAN>
r1 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> y.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// A</SPAN>
x.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>r1, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// B</SPAN>
<SPAN class=co1 style="COLOR: rgb(144,144,144)">// Thread 2:</SPAN>
r2 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> x.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// C </SPAN>
y.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// D</SPAN></PRE></DIV></DIV>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>is allowed to produce<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>r1 == r2 == 42</CODE><SPAN>&nbsp;</SPAN>because, although A is<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>B within thread 1 and C is<SPAN>&nbsp;</SPAN><I>sequenced before</I><SPAN>&nbsp;</SPAN>D within thread 2, nothing prevents D from appearing before A in the modification order of y, and B from appearing before C in the modification order of x. The side-effect of D on y could be visible to the load A in thread 1 while the side effect of B on x could be visible to the load C in thread 2. In particular, this may occur if D is completed before C in thread 2, either due to compiler reordering or at runtime.</P>
<TABLE class=t-rev-begin style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; BORDER-SPACING: 0px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<TBODY>
<TR class="t-rev t-since-cxx14">
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: medium none; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: silver 1px solid; PADDING-RIGHT: 0.2em; border-image: initial">
<P style="MARGIN: 0em 0px 0.5em; LINE-HEIGHT: 1.2em">Even with relaxed memory model, out-of-thin-air values are not allowed to circularly depend on their own computations, for example, with<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>x</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>y</CODE><SPAN>&nbsp;</SPAN>initially zero,</P>
<DIV class=mw-geshi style='OVERFLOW: auto; BORDER-TOP: silver 1px solid; FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BORDER-RIGHT: silver 1px solid; WIDTH: 55em; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 1em; TEXT-ALIGN: left; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: silver 1px solid; MARGIN: 1em 0px; PADDING-RIGHT: 1em; BACKGROUND-COLOR: rgb(249,249,249); border-radius: 5px' dir=ltr>
<DIV class="cpp source-cpp" style="FONT-FAMILY: monospace; LINE-HEIGHT: normal"><PRE class=de1 style="OVERFLOW: auto; BORDER-TOP: white 0px; BORDER-RIGHT: white 0px; WIDTH: 55em; VERTICAL-ALIGN: top; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: white 0px; COLOR: black; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; FONT: 1em/1.2em monospace; PADDING-LEFT: 0px; BORDER-LEFT: white 0px; MARGIN: 0px; PADDING-RIGHT: 0px; border-radius: 5px"><SPAN class=co1 style="COLOR: rgb(144,144,144)">// Thread 1:</SPAN>
r1 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> y.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=kw1 style="COLOR: rgb(0,0,221)">if</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>r1 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">==</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN> x.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>r1, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=co1 style="COLOR: rgb(144,144,144)">// Thread 2:</SPAN>
r2 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> x.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=kw1 style="COLOR: rgb(0,0,221)">if</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>r2 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">==</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN> y.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN></PRE></DIV></DIV>
<P style="MARGIN: 0.4em 0px 0em; LINE-HEIGHT: 1.2em">is not allowed to produce<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>r1 == r2 == 42</CODE><SPAN>&nbsp;</SPAN>since the store of 42 to y is only possible if the store to x stores 42, which circularly depends on the store to y storing 42. Note that until C++14, this was technically allowed by the specification, but not recommended for implementors.</P></TD>
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: silver 1px solid; WHITE-SPACE: nowrap; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: medium none; PADDING-RIGHT: 0.2em; border-image: initial"><SPAN class="t-mark-rev t-since-cxx14" style="FONT-SIZE: 0.8em; COLOR: rgb(0,128,0)">(since C++14)</SPAN></TD></TR></TBODY></TABLE>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Typical use for relaxed memory ordering is incrementing counters, such as the reference counters of<SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/memory/shared ptr" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/memory/shared_ptr">std::shared_ptr</A></SPAN>, since this only requires atomicity, but not ordering or synchronization (note that decrementing the shared_ptr counters requires acquire-release synchronization with the destructor).</P>
<DIV class=t-example style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<DIV class=t-example-live-link style="WIDTH: 55em; MARGIN-TOP: 1em; POSITION: relative; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 1em; DISPLAY: none; PADDING-RIGHT: 1em">
<DIV class="coliru-btn coliru-btn-run-init" style="FONT-SIZE: 0.8em; CURSOR: pointer; BORDER-TOP: rgb(204,204,204) 1px solid; BORDER-RIGHT: rgb(204,204,204) 1px solid; BACKGROUND-REPEAT: repeat-x; BORDER-BOTTOM: rgb(204,204,204) 1px solid; FONT-WEIGHT: bold; COLOR: rgb(51,51,51); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; BORDER-LEFT: rgb(204,204,204) 1px solid; MARGIN: 3px; DISPLAY: inline-block; LINE-HEIGHT: 1em; PADDING-RIGHT: 3px; BACKGROUND-COLOR: rgb(238,238,238); border-radius: 3px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 0px">Run this code</DIV></DIV>
<DIV class="mw-geshi t-example-code" style='OVERFLOW: auto; BORDER-TOP: silver 1px solid; FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BORDER-RIGHT: silver 1px solid; WIDTH: 55em; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 1em; TEXT-ALIGN: left; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: silver 1px solid; MARGIN: 0px 0px 1em; PADDING-RIGHT: 1em; BACKGROUND-COLOR: rgb(249,249,249); border-radius: 5px' dir=ltr>
<DIV class="cpp source-cpp" style="FONT-FAMILY: monospace; LINE-HEIGHT: normal"><PRE class=de1 style="OVERFLOW: auto; BORDER-TOP: white 0px; BORDER-RIGHT: white 0px; WIDTH: 55em; VERTICAL-ALIGN: top; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: white 0px; COLOR: black; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; FONT: 1em/1.2em monospace; PADDING-LEFT: 0px; BORDER-LEFT: white 0px; MARGIN: 0px; PADDING-RIGHT: 0px; border-radius: 5px"><SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;atomic&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;iostream&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;thread&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;vector&gt;</SPAN>
&nbsp;
<A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/atomic/atomic"><SPAN class=kw2070>std::<SPAN class=me2>atomic</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN><SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&gt;</SPAN> cnt <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">0</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> f<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">for</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> n <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">0</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> n <SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">1000</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=sy2 style="COLOR: rgb(0,0,64)">++</SPAN>n<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        cnt.<SPAN class=me1>fetch_add</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">1</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> main<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/container/vector"><SPAN class=kw1272>std::<SPAN class=me2>vector</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&gt;</SPAN> v<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">for</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> n <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">0</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> n <SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">10</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=sy2 style="COLOR: rgb(0,0,64)">++</SPAN>n<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        v.<SPAN class=me1>emplace_back</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>f<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">for</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=kw4 style="COLOR: rgb(0,0,255)">auto</SPAN><SPAN class=sy3 style="COLOR: rgb(0,0,64)">&amp;</SPAN> t <SPAN class=sy4 style="COLOR: rgb(0,128,128)">:</SPAN> v<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        t.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/io/cout"><SPAN class=kw1762>std::<SPAN class=me2>cout</SPAN></SPAN></A> <SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;&lt;</SPAN> <SPAN class=st0 style="COLOR: rgb(0,128,0)">"Final counter value is "</SPAN> <SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;&lt;</SPAN> cnt <SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;&lt;</SPAN> <SPAN class=st0 style="COLOR: rgb(0,128,0)">'<SPAN class=es1 style="FONT-WEIGHT: bold; COLOR: rgb(0,128,0)">\n</SPAN>'</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN></PRE></DIV></DIV>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">Output:</P>
<DIV class=mw-geshi style='OVERFLOW: auto; BORDER-TOP: silver 1px solid; FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BORDER-RIGHT: silver 1px solid; WIDTH: 55em; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 1em; TEXT-ALIGN: left; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: silver 1px solid; MARGIN: 0px 0px 1em; PADDING-RIGHT: 1em; BACKGROUND-COLOR: rgb(249,249,249); border-radius: 5px' dir=ltr>
<DIV class="text source-text" style="FONT-FAMILY: monospace; LINE-HEIGHT: normal"><PRE class=de1 style="OVERFLOW: auto; BORDER-TOP: white 0px; BORDER-RIGHT: white 0px; WIDTH: 55em; VERTICAL-ALIGN: top; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: white 0px; COLOR: black; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; FONT: 1em/1.2em monospace; PADDING-LEFT: 0px; BORDER-LEFT: white 0px; MARGIN: 0px; PADDING-RIGHT: 0px; border-radius: 5px">Final counter value is 10000</PRE></DIV></DIV></DIV>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Release-Acquire_ordering class=mw-headline>Release-Acquire ordering</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>If an atomic store in thread A is tagged<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal">memory_order_release</SPAN></SPAN>, an atomic load in thread B from the same variable is tagged<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal">memory_order_acquire</SPAN></SPAN>, and the load in thread B reads a value written by the store in thread A, then the store in thread A<SPAN>&nbsp;</SPAN><I>synchronizes-with</I><SPAN>&nbsp;</SPAN>the load in thread B.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>All memory writes (including non-atomic and relaxed atomic) that<SPAN>&nbsp;</SPAN><I>happened-before</I><SPAN>&nbsp;</SPAN>the atomic store from the point of view of thread A, become<SPAN>&nbsp;</SPAN><I>visible side-effects</I><SPAN>&nbsp;</SPAN>in thread B. That is, once the atomic load is completed, thread B is guaranteed to see everything thread A wrote to memory. This promise only holds if B actually returns the value that A stored, or a value from later in the release sequence.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>The synchronization is established only between the threads<SPAN>&nbsp;</SPAN><I>releasing</I><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><I>acquiring</I><SPAN>&nbsp;</SPAN>the same atomic variable. Other threads can see different order of memory accesses than either or both of the synchronized threads.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>On strongly-ordered systems &#8212; x86, SPARC TSO, IBM mainframe, etc. &#8212; release-acquire ordering is automatic for the majority of operations. No additional CPU instructions are issued for this synchronization mode; only certain compiler optimizations are affected (e.g., the compiler is prohibited from moving non-atomic stores past the atomic store-release or performing non-atomic loads earlier than the atomic load-acquire). On weakly-ordered systems (ARM, Itanium, PowerPC), special CPU load or memory fence instructions are used.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Mutual exclusion locks, such as<SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title=cpp/thread/mutex style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/thread/mutex">std::mutex</A></SPAN><SPAN>&nbsp;</SPAN>or<SPAN>&nbsp;</SPAN><A title="cpp/atomic/atomic flag" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/atomic_flag">atomic spinlock</A>, are an example of release-acquire synchronization: when the lock is released by thread A and acquired by thread B, everything that took place in the critical section (before the release) in the context of thread A has to be visible to thread B (after the acquire) which is executing the same critical section.</P>
<DIV class=t-example style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<DIV class=t-example-live-link style="WIDTH: 55em; MARGIN-TOP: 1em; POSITION: relative; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 1em; DISPLAY: none; PADDING-RIGHT: 1em">
<DIV class="coliru-btn coliru-btn-run-init" style="FONT-SIZE: 0.8em; CURSOR: pointer; BORDER-TOP: rgb(204,204,204) 1px solid; BORDER-RIGHT: rgb(204,204,204) 1px solid; BACKGROUND-REPEAT: repeat-x; BORDER-BOTTOM: rgb(204,204,204) 1px solid; FONT-WEIGHT: bold; COLOR: rgb(51,51,51); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; BORDER-LEFT: rgb(204,204,204) 1px solid; MARGIN: 3px; DISPLAY: inline-block; LINE-HEIGHT: 1em; PADDING-RIGHT: 3px; BACKGROUND-COLOR: rgb(238,238,238); border-radius: 3px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 0px">Run this code</DIV></DIV>
<DIV class=mw-geshi style='OVERFLOW: auto; BORDER-TOP: silver 1px solid; FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BORDER-RIGHT: silver 1px solid; WIDTH: 55em; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 1em; TEXT-ALIGN: left; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: silver 1px solid; MARGIN: 0px 0px 1em; PADDING-RIGHT: 1em; BACKGROUND-COLOR: rgb(249,249,249); border-radius: 5px' dir=ltr>
<DIV class="cpp source-cpp" style="FONT-FAMILY: monospace; LINE-HEIGHT: normal"><PRE class=de1 style="OVERFLOW: auto; BORDER-TOP: white 0px; BORDER-RIGHT: white 0px; WIDTH: 55em; VERTICAL-ALIGN: top; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: white 0px; COLOR: black; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; FONT: 1em/1.2em monospace; PADDING-LEFT: 0px; BORDER-LEFT: white 0px; MARGIN: 0px; PADDING-RIGHT: 0px; border-radius: 5px"><SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;atomic&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;cassert&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;string&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;thread&gt;</SPAN>
&nbsp;
<A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/atomic/atomic"><SPAN class=kw2070>std::<SPAN class=me2>atomic</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/string/basic_string"><SPAN class=kw1233>std::<SPAN class=me2>string</SPAN></SPAN></A><SPAN class=sy2 style="COLOR: rgb(0,0,64)">*</SPAN><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&gt;</SPAN> ptr<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> data<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> producer<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/string/basic_string"><SPAN class=kw1233>std::<SPAN class=me2>string</SPAN></SPAN></A><SPAN class=sy2 style="COLOR: rgb(0,0,64)">*</SPAN> p <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> new <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/string/basic_string"><SPAN class=kw1233>std::<SPAN class=me2>string</SPAN></SPAN></A><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=st0 style="COLOR: rgb(0,128,0)">"Hello"</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    data <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    ptr.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>p, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_release</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> consumer<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/string/basic_string"><SPAN class=kw1233>std::<SPAN class=me2>string</SPAN></SPAN></A><SPAN class=sy2 style="COLOR: rgb(0,0,64)">*</SPAN> p2<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">while</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=sy3 style="COLOR: rgb(0,0,64)">!</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>p2 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> ptr.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_acquire</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        <SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/error/assert"><SPAN class=kw776>assert</SPAN></A><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=sy2 style="COLOR: rgb(0,0,64)">*</SPAN>p2 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">==</SPAN> <SPAN class=st0 style="COLOR: rgb(0,128,0)">"Hello"</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// never fires</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/error/assert"><SPAN class=kw776>assert</SPAN></A><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>data <SPAN class=sy1 style="COLOR: rgb(0,0,128)">==</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// never fires</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> main<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> t1<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>producer<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> t2<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>consumer<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    t1.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> t2.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN></PRE></DIV></DIV></DIV>
<DIV class=t-example style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">The following example demonstrates transitive release-acquire ordering across three threads, using a release sequence.</P>
<DIV class=t-example-live-link style="WIDTH: 55em; MARGIN-TOP: 1em; POSITION: relative; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 1em; DISPLAY: none; PADDING-RIGHT: 1em">
<DIV class="coliru-btn coliru-btn-run-init" style="FONT-SIZE: 0.8em; CURSOR: pointer; BORDER-TOP: rgb(204,204,204) 1px solid; BORDER-RIGHT: rgb(204,204,204) 1px solid; BACKGROUND-REPEAT: repeat-x; BORDER-BOTTOM: rgb(204,204,204) 1px solid; FONT-WEIGHT: bold; COLOR: rgb(51,51,51); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; BORDER-LEFT: rgb(204,204,204) 1px solid; MARGIN: 3px; DISPLAY: inline-block; LINE-HEIGHT: 1em; PADDING-RIGHT: 3px; BACKGROUND-COLOR: rgb(238,238,238); border-radius: 3px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 0px">Run this code</DIV></DIV>
<DIV class=mw-geshi style='OVERFLOW: auto; BORDER-TOP: silver 1px solid; FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BORDER-RIGHT: silver 1px solid; WIDTH: 55em; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 1em; TEXT-ALIGN: left; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: silver 1px solid; MARGIN: 0px 0px 1em; PADDING-RIGHT: 1em; BACKGROUND-COLOR: rgb(249,249,249); border-radius: 5px' dir=ltr>
<DIV class="cpp source-cpp" style="FONT-FAMILY: monospace; LINE-HEIGHT: normal"><PRE class=de1 style="OVERFLOW: auto; BORDER-TOP: white 0px; BORDER-RIGHT: white 0px; WIDTH: 55em; VERTICAL-ALIGN: top; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: white 0px; COLOR: black; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; FONT: 1em/1.2em monospace; PADDING-LEFT: 0px; BORDER-LEFT: white 0px; MARGIN: 0px; PADDING-RIGHT: 0px; border-radius: 5px"><SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;atomic&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;cassert&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;thread&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;vector&gt;</SPAN>
&nbsp;
<A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/container/vector"><SPAN class=kw1272>std::<SPAN class=me2>vector</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN><SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&gt;</SPAN> data<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/atomic/atomic"><SPAN class=kw2070>std::<SPAN class=me2>atomic</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN><SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&gt;</SPAN> flag <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">0</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> thread_1<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    data.<SPAN class=me1>push_back</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    flag.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">1</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_release</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> thread_2<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> expected <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">1</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <SPAN class=co1 style="COLOR: rgb(144,144,144)">// memory_order_relaxed is okay because this is an RMW,</SPAN>
    <SPAN class=co1 style="COLOR: rgb(144,144,144)">// and RMWs (with any ordering) following a release form a release sequence</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">while</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=sy3 style="COLOR: rgb(0,0,64)">!</SPAN>flag.<SPAN class=me1>compare_exchange_strong</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>expected, <SPAN class=nu0 style="COLOR: rgb(0,0,128)">2</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
    <SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
        expected <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">1</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> thread_3<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">while</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>flag.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_acquire</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN> <SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">2</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        <SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <SPAN class=co1 style="COLOR: rgb(144,144,144)">// if we read the value 2 from the atomic flag, we see 42 in the vector</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/error/assert"><SPAN class=kw776>assert</SPAN></A><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>data.<SPAN class=me1>at</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">0</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN> <SPAN class=sy1 style="COLOR: rgb(0,0,128)">==</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// will never fire</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> main<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> a<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>thread_1<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> b<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>thread_2<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> c<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>thread_3<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    a.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> b.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> c.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN></PRE></DIV></DIV></DIV>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Release-Consume_ordering class=mw-headline>Release-Consume ordering</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>If an atomic store in thread A is tagged<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal">memory_order_release</SPAN></SPAN>, an atomic load in thread B from the same variable is tagged<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal">memory_order_consume</SPAN></SPAN>, and the load in thread B reads a value written by the store in thread A, then the store in thread A is<SPAN>&nbsp;</SPAN><I>dependency-ordered before</I><SPAN>&nbsp;</SPAN>the load in thread B.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>All memory writes (non-atomic and relaxed atomic) that<SPAN>&nbsp;</SPAN><I>happened-before</I><SPAN>&nbsp;</SPAN>the atomic store from the point of view of thread A, become<SPAN>&nbsp;</SPAN><I>visible side-effects</I><SPAN>&nbsp;</SPAN>within those operations in thread B into which the load operation<SPAN>&nbsp;</SPAN><I>carries dependency</I>, that is, once the atomic load is completed, those operators and functions in thread B that use the value obtained from the load are guaranteed to see what thread A wrote to memory.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>The synchronization is established only between the threads<SPAN>&nbsp;</SPAN><I>releasing</I><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><I>consuming</I><SPAN>&nbsp;</SPAN>the same atomic variable. Other threads can see different order of memory accesses than either or both of the synchronized threads.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>On all mainstream CPUs other than DEC Alpha, dependency ordering is automatic, no additional CPU instructions are issued for this synchronization mode, only certain compiler optimizations are affected (e.g. the compiler is prohibited from performing speculative loads on the objects that are involved in the dependency chain).</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Typical use cases for this ordering involve read access to rarely written concurrent data structures (routing tables, configuration, security policies, firewall rules, etc) and publisher-subscriber situations with pointer-mediated publication, that is, when the producer publishes a pointer through which the consumer can access information: there is no need to make everything else the producer wrote to memory visible to the consumer (which may be an expensive operation on weakly-ordered architectures). An example of such scenario is<SPAN>&nbsp;</SPAN><A title=enwiki:Read-copy-update class=extiw style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(51,102,187); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px" href="https://en.wikipedia.org/wiki/Read-copy-update">rcu_dereference</A>.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>See also<SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/atomic/kill dependency" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/kill_dependency">std::kill_dependency</A></SPAN><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>[[<A title="cpp/language/attributes/carries dependency" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/language/attributes/carries_dependency">carries_dependency</A>]]</CODE><SPAN>&nbsp;</SPAN>for fine-grained dependency chain control.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Note that currently (2/2015) no known production compilers track dependency chains: consume operations are lifted to acquire operations.</P>
<TABLE class=t-rev-begin style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; BORDER-SPACING: 0px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<TBODY>
<TR class="t-rev t-since-cxx17">
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: medium none; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: silver 1px solid; PADDING-RIGHT: 0.2em; border-image: initial">
<P style="MARGIN: 0em 0px; LINE-HEIGHT: 1.2em">The specification of release-consume ordering is being revised, and the use of<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_consume</CODE><SPAN>&nbsp;</SPAN>is temporarily discouraged.</P></TD>
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: silver 1px solid; WHITE-SPACE: nowrap; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: medium none; PADDING-RIGHT: 0.2em; border-image: initial"><SPAN class="t-mark-rev t-since-cxx17" style="FONT-SIZE: 0.8em; COLOR: rgb(0,128,0)">(since C++17)</SPAN></TD></TR></TBODY></TABLE>
<DIV class=t-example style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">This example demonstrates dependency-ordered synchronization for pointer-mediated publication: the integer data is not related to the pointer to string by a data-dependency relationship, thus its value is undefined in the consumer.</P>
<DIV class=t-example-live-link style="WIDTH: 55em; MARGIN-TOP: 1em; POSITION: relative; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 1em; DISPLAY: none; PADDING-RIGHT: 1em">
<DIV class="coliru-btn coliru-btn-run-init" style="FONT-SIZE: 0.8em; CURSOR: pointer; BORDER-TOP: rgb(204,204,204) 1px solid; BORDER-RIGHT: rgb(204,204,204) 1px solid; BACKGROUND-REPEAT: repeat-x; BORDER-BOTTOM: rgb(204,204,204) 1px solid; FONT-WEIGHT: bold; COLOR: rgb(51,51,51); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; BORDER-LEFT: rgb(204,204,204) 1px solid; MARGIN: 3px; DISPLAY: inline-block; LINE-HEIGHT: 1em; PADDING-RIGHT: 3px; BACKGROUND-COLOR: rgb(238,238,238); border-radius: 3px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 0px">Run this code</DIV></DIV>
<DIV class=mw-geshi style='OVERFLOW: auto; BORDER-TOP: silver 1px solid; FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BORDER-RIGHT: silver 1px solid; WIDTH: 55em; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 1em; TEXT-ALIGN: left; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: silver 1px solid; MARGIN: 0px 0px 1em; PADDING-RIGHT: 1em; BACKGROUND-COLOR: rgb(249,249,249); border-radius: 5px' dir=ltr>
<DIV class="cpp source-cpp" style="FONT-FAMILY: monospace; LINE-HEIGHT: normal"><PRE class=de1 style="OVERFLOW: auto; BORDER-TOP: white 0px; BORDER-RIGHT: white 0px; WIDTH: 55em; VERTICAL-ALIGN: top; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: white 0px; COLOR: black; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; FONT: 1em/1.2em monospace; PADDING-LEFT: 0px; BORDER-LEFT: white 0px; MARGIN: 0px; PADDING-RIGHT: 0px; border-radius: 5px"><SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;atomic&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;cassert&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;string&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;thread&gt;</SPAN>
&nbsp;
<A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/atomic/atomic"><SPAN class=kw2070>std::<SPAN class=me2>atomic</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN><A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/string/basic_string"><SPAN class=kw1233>std::<SPAN class=me2>string</SPAN></SPAN></A><SPAN class=sy2 style="COLOR: rgb(0,0,64)">*</SPAN><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&gt;</SPAN> ptr<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> data<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> producer<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/string/basic_string"><SPAN class=kw1233>std::<SPAN class=me2>string</SPAN></SPAN></A><SPAN class=sy2 style="COLOR: rgb(0,0,64)">*</SPAN> p <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> new <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/string/basic_string"><SPAN class=kw1233>std::<SPAN class=me2>string</SPAN></SPAN></A><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=st0 style="COLOR: rgb(0,128,0)">"Hello"</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    data <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    ptr.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>p, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_release</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> consumer<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/string/basic_string"><SPAN class=kw1233>std::<SPAN class=me2>string</SPAN></SPAN></A><SPAN class=sy2 style="COLOR: rgb(0,0,64)">*</SPAN> p2<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">while</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=sy3 style="COLOR: rgb(0,0,64)">!</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>p2 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> ptr.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_consume</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        <SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/error/assert"><SPAN class=kw776>assert</SPAN></A><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=sy2 style="COLOR: rgb(0,0,64)">*</SPAN>p2 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">==</SPAN> <SPAN class=st0 style="COLOR: rgb(0,128,0)">"Hello"</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// never fires: *p2 carries dependency from ptr</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/error/assert"><SPAN class=kw776>assert</SPAN></A><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>data <SPAN class=sy1 style="COLOR: rgb(0,0,128)">==</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">42</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// may or may not fire: data does not carry dependency from ptr</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> main<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> t1<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>producer<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> t2<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>consumer<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    t1.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> t2.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN></PRE></DIV></DIV></DIV>
<H4 style='FONT-SIZE: 14px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.17em; FONT-STYLE: normal; PADDING-TOP: 0.5em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Sequentially-consistent_ordering class=mw-headline>Sequentially-consistent ordering</SPAN></H4>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Atomic operations tagged<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal">memory_order_seq_cst</SPAN></SPAN><SPAN>&nbsp;</SPAN>not only order memory the same way as release/acquire ordering (everything that<SPAN>&nbsp;</SPAN><I>happened-before</I><SPAN>&nbsp;</SPAN>a store in one thread becomes a<SPAN>&nbsp;</SPAN><I>visible side effect</I><SPAN>&nbsp;</SPAN>in the thread that did a load), but also establish a<SPAN>&nbsp;</SPAN><I>single total modification order</I><SPAN>&nbsp;</SPAN>of all atomic operations that are so tagged.</P>
<TABLE class=t-rev-begin style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; BORDER-SPACING: 0px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<TBODY>
<TR class="t-rev t-until-cxx20">
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: medium none; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: silver 1px solid; PADDING-RIGHT: 0.2em; border-image: initial">Formally,
<P style="MARGIN: 0em 0px 0.5em; LINE-HEIGHT: 1.2em">each<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>operation B that loads from atomic variable M, observes one of the following:</P>
<UL style="LIST-STYLE-TYPE: square; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; LIST-STYLE-IMAGE: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAANCAMAAABW4lS6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRFAFKM////QIUK9QAAAAJ0Uk5T/wDltzBKAAAAGklEQVR42mJgBAEGokgGBjBGBxBxsBqAAAMACHwALd5r8ygAAAAASUVORK5CYII=); MARGIN: 0.3em 0px 0.5em 1.6em; LINE-HEIGHT: 1.5em; PADDING-RIGHT: 0px">
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">the result of the last operation A that modified M, which appears before B in the single total order,</LI>
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">OR, if there was such an A, B may observe the result of some modification on M that is not<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>and does not<SPAN>&nbsp;</SPAN><I>happen-before</I><SPAN>&nbsp;</SPAN>A,</LI>
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">OR, if there wasn't such an A, B may observe the result of some unrelated modification of M that is not<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE>.</LI></UL>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">If there was a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/atomic/atomic thread fence" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/atomic_thread_fence">std::atomic_thread_fence</A></SPAN><SPAN>&nbsp;</SPAN>operation X<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>B, then B observes one of the following:</P>
<UL style="LIST-STYLE-TYPE: square; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; LIST-STYLE-IMAGE: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAANCAMAAABW4lS6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRFAFKM////QIUK9QAAAAJ0Uk5T/wDltzBKAAAAGklEQVR42mJgBAEGokgGBjBGBxBxsBqAAAMACHwALd5r8ygAAAAASUVORK5CYII=); MARGIN: 0.3em 0px 0.5em 1.6em; LINE-HEIGHT: 1.5em; PADDING-RIGHT: 0px">
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">the last<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>modification of M that appears before X in the single total order,</LI>
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">some unrelated modification of M that appears later in M's modification order.</LI></UL>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">For a pair of atomic operations on M called A and B, where A writes and B reads M's value, if there are two<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/atomic/atomic thread fence" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/atomic_thread_fence">std::atomic_thread_fence</A></SPAN>s X and Y, and if A is<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>X, Y is<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>B, and X appears before Y in the Single Total Order, then B observes either:</P>
<UL style="LIST-STYLE-TYPE: square; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; LIST-STYLE-IMAGE: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAANCAMAAABW4lS6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRFAFKM////QIUK9QAAAAJ0Uk5T/wDltzBKAAAAGklEQVR42mJgBAEGokgGBjBGBxBxsBqAAAMACHwALd5r8ygAAAAASUVORK5CYII=); MARGIN: 0.3em 0px 0.5em 1.6em; LINE-HEIGHT: 1.5em; PADDING-RIGHT: 0px">
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">the effect of A,</LI>
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">some unrelated modification of M that appears after A in M's modification order.</LI></UL>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">For a pair of atomic modifications of M called A and B, B occurs after A in M's modification order if</P>
<UL style="LIST-STYLE-TYPE: square; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; LIST-STYLE-IMAGE: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAANCAMAAABW4lS6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRFAFKM////QIUK9QAAAAJ0Uk5T/wDltzBKAAAAGklEQVR42mJgBAEGokgGBjBGBxBxsBqAAAMACHwALd5r8ygAAAAASUVORK5CYII=); MARGIN: 0.3em 0px 0.5em 1.6em; LINE-HEIGHT: 1.5em; PADDING-RIGHT: 0px">
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">there is a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/atomic/atomic thread fence" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/atomic_thread_fence">std::atomic_thread_fence</A></SPAN><SPAN>&nbsp;</SPAN>X such that A is<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>X and X appears before B in the Single Total Order,</LI>
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">or, there is a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/atomic/atomic thread fence" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/atomic_thread_fence">std::atomic_thread_fence</A></SPAN><SPAN>&nbsp;</SPAN>Y such that Y is<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>B and A appears before Y in the Single Total Order,</LI>
<LI style="MARGIN-BOTTOM: 0.1em; MARGIN-TOP: 0.3em; LINE-HEIGHT: 1.2em">or, there are<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title="cpp/atomic/atomic thread fence" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/atomic/atomic_thread_fence">std::atomic_thread_fence</A></SPAN>s X and Y such that A is<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>X, Y is<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>B, and X appears before Y in the Single Total Order.</LI></UL>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">Note that this means that:</P>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>as soon as atomic operations that are not tagged<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>enter the picture, the sequential consistency is lost,</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>the sequentially-consistent fences are only establishing total ordering for the fences themselves, not for the atomic operations in the general case (<I style="TEXT-INDENT: 0em">sequenced-before</I><SPAN>&nbsp;</SPAN>is not a cross-thread relationship, unlike<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I>).</DIV></TD>
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: silver 1px solid; WHITE-SPACE: nowrap; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: medium none; PADDING-RIGHT: 0.2em; border-image: initial"><SPAN class="t-mark-rev t-until-cxx20" style="FONT-SIZE: 0.8em; COLOR: rgb(0,128,0)">(until C++20)</SPAN></TD></TR>
<TR class="t-rev t-since-cxx20">
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: medium none; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: silver 1px solid; PADDING-RIGHT: 0.2em; border-image: initial">Formally,
<P style="MARGIN: 0em 0px 0.5em; LINE-HEIGHT: 1.2em">an atomic operation A on some atomic object M is<SPAN>&nbsp;</SPAN><I>coherence-ordered-before</I><SPAN>&nbsp;</SPAN>another atomic operation B on M if any of the following is true:</P>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>A is a modification, and B reads the value stored by A,</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>A precedes B in the<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">modification order</I><SPAN>&nbsp;</SPAN>of M,</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">3)</SPAN><SPAN>&nbsp;</SPAN>A reads the value stored by an atomic modification X, X precedes B in the<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">modification order</I>, and A and B are not the same atomic read-modify-write operation,</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">4)</SPAN><SPAN>&nbsp;</SPAN>A is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">coherence-ordered-before</I><SPAN>&nbsp;</SPAN>X, and X is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">coherence-ordered-before</I><SPAN>&nbsp;</SPAN>B.</DIV>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">There is a single total order S on all<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>operations, including fences, that satisfies the following constraints:</P>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>if A and B are<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>operations, and A<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">strongly happens-before</I><SPAN>&nbsp;</SPAN>B, then A precedes B in S,</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>for every pair of atomic operations A and B on an object M, where A is<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">coherence-ordered-before</I><SPAN>&nbsp;</SPAN>B:</DIV>
<DIV class=t-li2 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 5em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">a)</SPAN><SPAN>&nbsp;</SPAN>if A and B are both<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>operations, then A precedes B in S,</DIV>
<DIV class=t-li2 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 5em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">b)</SPAN><SPAN>&nbsp;</SPAN>if A is a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>operation, and B<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>fence Y, then A precedes Y in S,</DIV>
<DIV class=t-li2 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 5em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">c)</SPAN><SPAN>&nbsp;</SPAN>if a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>fence X<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>A, and B is a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>operation, then X precedes B in S,</DIV>
<DIV class=t-li2 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 5em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">d)</SPAN><SPAN>&nbsp;</SPAN>if a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>fence X<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>A, and B<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happens-before</I><SPAN>&nbsp;</SPAN>a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>fence Y, then X precedes Y in S.</DIV>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">The formal definition ensures that:</P>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>the single total order is consistent with the<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">modification order</I><SPAN>&nbsp;</SPAN>of any atomic object,</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>a<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>load gets its value either from the last<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>modification, or from some non-<CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>modification that does not<SPAN>&nbsp;</SPAN><I style="TEXT-INDENT: 0em">happen-before</I><SPAN>&nbsp;</SPAN>preceding<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>modifications.</DIV>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">The single total order might not be consistent with<SPAN>&nbsp;</SPAN><I>happens-before</I>. This allows more efficient implementation of<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_acquire</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_release</CODE><SPAN>&nbsp;</SPAN>on some CPUs. It can produce surprising results when<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_acquire</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_release</CODE><SPAN>&nbsp;</SPAN>are mixed with<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE>.</P>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">For example, with<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>x</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>y</CODE><SPAN>&nbsp;</SPAN>initially zero,</P>
<DIV class=mw-geshi style='OVERFLOW: auto; BORDER-TOP: silver 1px solid; FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BORDER-RIGHT: silver 1px solid; WIDTH: 55em; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 1em; TEXT-ALIGN: left; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: silver 1px solid; MARGIN: 1em 0px; PADDING-RIGHT: 1em; BACKGROUND-COLOR: rgb(249,249,249); border-radius: 5px' dir=ltr>
<DIV class="cpp source-cpp" style="FONT-FAMILY: monospace; LINE-HEIGHT: normal"><PRE class=de1 style="OVERFLOW: auto; BORDER-TOP: white 0px; BORDER-RIGHT: white 0px; WIDTH: 55em; VERTICAL-ALIGN: top; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: white 0px; COLOR: black; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; FONT: 1em/1.2em monospace; PADDING-LEFT: 0px; BORDER-LEFT: white 0px; MARGIN: 0px; PADDING-RIGHT: 0px; border-radius: 5px"><SPAN class=co1 style="COLOR: rgb(144,144,144)">// Thread 1:</SPAN>
x.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">1</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// A</SPAN>
y.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">1</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_release</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// B</SPAN>
<SPAN class=co1 style="COLOR: rgb(144,144,144)">// Thread 2:</SPAN>
r1 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> y.<SPAN class=me1>fetch_add</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">1</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// C</SPAN>
r2 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> y.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_relaxed</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// D</SPAN>
<SPAN class=co1 style="COLOR: rgb(144,144,144)">// Thread 3:</SPAN>
y.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">3</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// E</SPAN>
r3 <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> x.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// F</SPAN></PRE></DIV></DIV>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">is allowed to produce<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>r1 == 1 &amp;&amp; r2 == 3 &amp;&amp; r3 == 0</CODE>, where A<SPAN>&nbsp;</SPAN><I>happens-before</I><SPAN>&nbsp;</SPAN>C, but C precedes A in the single total order C-E-F-A of<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>(see<SPAN>&nbsp;</SPAN><A class="external text" style="TEXT-DECORATION: none; BACKGROUND: url(//upload.cppreference.com/mwiki/images/2/23/Icons-mini-file_acrobat.gif) no-repeat right center; COLOR: rgb(51,102,187); PADDING-RIGHT: 18px" href="https://plv.mpi-sws.org/scfix/paper.pdf" rel=nofollow>Lahav et al</A>).</P>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">Note that:</P>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">1)</SPAN><SPAN>&nbsp;</SPAN>as soon as atomic operations that are not tagged<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>enter the picture, the sequential consistency guarantee for the program is lost,</DIV>
<DIV class=t-li1 style="PADDING-BOTTOM: 0.2em; PADDING-TOP: 0.2em; PADDING-LEFT: 3em; PADDING-RIGHT: 0px; TEXT-INDENT: -5em"><SPAN class=t-li style="WIDTH: 5em; TEXT-ALIGN: right; DISPLAY: inline-block; TEXT-INDENT: 0em">2)</SPAN><SPAN>&nbsp;</SPAN>in many cases,<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent; TEXT-INDENT: 0em'>memory_order_seq_cst</CODE><SPAN>&nbsp;</SPAN>atomic operations are reorderable with respect to other atomic operations performed by the same thread.</DIV></TD>
<TD style="BORDER-TOP: silver 1px solid; BORDER-RIGHT: silver 1px solid; WHITE-SPACE: nowrap; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 0.3em; PADDING-TOP: 0.3em; PADDING-LEFT: 0.2em; BORDER-LEFT: medium none; PADDING-RIGHT: 0.2em; border-image: initial"><SPAN class="t-mark-rev t-since-cxx20" style="FONT-SIZE: 0.8em; COLOR: rgb(0,128,0)">(since C++20)</SPAN></TD></TR></TBODY></TABLE>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Sequential ordering may be necessary for multiple producer-multiple consumer situations where all consumers must observe the actions of all producers occurring in the same order.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Total sequential ordering requires a full memory fence CPU instruction on all multi-core systems. This may become a performance bottleneck since it forces the affected memory accesses to propagate to every core.</P>
<DIV class=t-example style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<P style="MARGIN: 0.4em 0px 0.5em; LINE-HEIGHT: 1.2em">This example demonstrates a situation where sequential ordering is necessary. Any other ordering may trigger the assert because it would be possible for the threads<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>c</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>d</CODE><SPAN>&nbsp;</SPAN>to observe changes to the atomics<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>x</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BACKGROUND-COLOR: transparent'>y</CODE><SPAN>&nbsp;</SPAN>in opposite order.</P>
<DIV class=t-example-live-link style="WIDTH: 55em; MARGIN-TOP: 1em; POSITION: relative; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 1em; DISPLAY: none; PADDING-RIGHT: 1em">
<DIV class="coliru-btn coliru-btn-run-init" style="FONT-SIZE: 0.8em; CURSOR: pointer; BORDER-TOP: rgb(204,204,204) 1px solid; BORDER-RIGHT: rgb(204,204,204) 1px solid; BACKGROUND-REPEAT: repeat-x; BORDER-BOTTOM: rgb(204,204,204) 1px solid; FONT-WEIGHT: bold; COLOR: rgb(51,51,51); PADDING-BOTTOM: 3px; PADDING-TOP: 3px; PADDING-LEFT: 3px; BORDER-LEFT: rgb(204,204,204) 1px solid; MARGIN: 3px; DISPLAY: inline-block; LINE-HEIGHT: 1em; PADDING-RIGHT: 3px; BACKGROUND-COLOR: rgb(238,238,238); border-radius: 3px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 0px">Run this code</DIV></DIV>
<DIV class=mw-geshi style='OVERFLOW: auto; BORDER-TOP: silver 1px solid; FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important; BORDER-RIGHT: silver 1px solid; WIDTH: 55em; BORDER-BOTTOM: silver 1px solid; PADDING-BOTTOM: 1em; TEXT-ALIGN: left; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: silver 1px solid; MARGIN: 0px 0px 1em; PADDING-RIGHT: 1em; BACKGROUND-COLOR: rgb(249,249,249); border-radius: 5px' dir=ltr>
<DIV class="cpp source-cpp" style="FONT-FAMILY: monospace; LINE-HEIGHT: normal"><PRE class=de1 style="OVERFLOW: auto; BORDER-TOP: white 0px; BORDER-RIGHT: white 0px; WIDTH: 55em; VERTICAL-ALIGN: top; BACKGROUND: none transparent scroll repeat 0% 0%; BORDER-BOTTOM: white 0px; COLOR: black; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; FONT: 1em/1.2em monospace; PADDING-LEFT: 0px; BORDER-LEFT: white 0px; MARGIN: 0px; PADDING-RIGHT: 0px; border-radius: 5px"><SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;atomic&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;cassert&gt;</SPAN>
<SPAN class=co2 style="COLOR: rgb(51,153,0)">#include &lt;thread&gt;</SPAN>
&nbsp;
<A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/atomic/atomic"><SPAN class=kw2070>std::<SPAN class=me2>atomic</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN><SPAN class=kw4 style="COLOR: rgb(0,0,255)">bool</SPAN><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&gt;</SPAN> x <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN><SPAN class=kw2 style="COLOR: rgb(0,0,255)">false</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/atomic/atomic"><SPAN class=kw2070>std::<SPAN class=me2>atomic</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN><SPAN class=kw4 style="COLOR: rgb(0,0,255)">bool</SPAN><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&gt;</SPAN> y <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN><SPAN class=kw2 style="COLOR: rgb(0,0,255)">false</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/atomic/atomic"><SPAN class=kw2070>std::<SPAN class=me2>atomic</SPAN></SPAN></A><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&lt;</SPAN><SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN><SPAN class=sy1 style="COLOR: rgb(0,0,128)">&gt;</SPAN> z <SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN><SPAN class=nu0 style="COLOR: rgb(0,0,128)">0</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> write_x<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    x.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=kw2 style="COLOR: rgb(0,0,255)">true</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> write_y<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    y.<SPAN class=me1>store</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=kw2 style="COLOR: rgb(0,0,255)">true</SPAN>, std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> read_x_then_y<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">while</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=sy3 style="COLOR: rgb(0,0,64)">!</SPAN>x.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        <SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">if</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>y.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        <SPAN class=sy2 style="COLOR: rgb(0,0,64)">++</SPAN>z<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">void</SPAN> read_y_then_x<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">while</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=sy3 style="COLOR: rgb(0,0,64)">!</SPAN>y.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        <SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <SPAN class=kw1 style="COLOR: rgb(0,0,221)">if</SPAN> <SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>x.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>std<SPAN class=sy4 style="COLOR: rgb(0,128,128)">::</SPAN><SPAN class=me2>memory_order_seq_cst</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
        <SPAN class=sy2 style="COLOR: rgb(0,0,64)">++</SPAN>z<SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN>
&nbsp;
<SPAN class=kw4 style="COLOR: rgb(0,0,255)">int</SPAN> main<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">{</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> a<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>write_x<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> b<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>write_y<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> c<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>read_x_then_y<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/thread/thread"><SPAN class=kw2143>std::<SPAN class=me2>thread</SPAN></SPAN></A> d<SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>read_y_then_x<SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    a.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> b.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> c.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> d.<SPAN class=me1>join</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN>
    <A style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(0,48,128)" href="http://en.cppreference.com/w/cpp/error/assert"><SPAN class=kw776>assert</SPAN></A><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN>z.<SPAN class=me1>load</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">(</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN> <SPAN class=sy3 style="COLOR: rgb(0,0,64)">!</SPAN><SPAN class=sy1 style="COLOR: rgb(0,0,128)">=</SPAN> <SPAN class=nu0 style="COLOR: rgb(0,0,128)">0</SPAN><SPAN class=br0 style="COLOR: rgb(0,128,0)">)</SPAN><SPAN class=sy4 style="COLOR: rgb(0,128,128)">;</SPAN> <SPAN class=co1 style="COLOR: rgb(144,144,144)">// will never happen</SPAN>
<SPAN class=br0 style="COLOR: rgb(0,128,0)">}</SPAN></PRE></DIV></DIV></DIV>
<H3 style='FONT-SIZE: 16px; OVERFLOW: hidden; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WIDTH: auto; BACKGROUND: rgb(255,255,255); WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: medium none; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.2em; FONT-STYLE: normal; PADDING-TOP: 1.1em; PADDING-LEFT: 0.75em; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0.3em; LETTER-SPACING: normal; PADDING-RIGHT: 0px; TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN id=Relationship_with_volatile class=mw-headline>Relationship with<SPAN>&nbsp;</SPAN><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal"><SPAN class=kw4 style="COLOR: rgb(0,0,255)">volatile</SPAN></SPAN></SPAN></H3>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>Within a thread of execution, accesses (reads and writes) through<SPAN>&nbsp;</SPAN><A title=cpp/language/cv style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/language/cv">volatile glvalues</A><SPAN>&nbsp;</SPAN>cannot be reordered past observable side-effects (including other volatile accesses) that are<SPAN>&nbsp;</SPAN><I>sequenced-before</I><SPAN>&nbsp;</SPAN>or<SPAN>&nbsp;</SPAN><I>sequenced-after</I><SPAN>&nbsp;</SPAN>within the same thread, but this order is not guaranteed to be observed by another thread, since volatile access does not establish inter-thread synchronization.</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>In addition, volatile accesses are not atomic (concurrent read and write is a<SPAN>&nbsp;</SPAN><A title="cpp/language/memory model" style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/language/memory_model">data race</A>) and do not order memory (non-volatile memory accesses may be freely reordered around the volatile access).</P>
<P style='FONT-SIZE: 12px; FONT-FAMILY: DejaVuSans, "DejaVu Sans", arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 0.4em 0px 0.5em; LETTER-SPACING: normal; LINE-HEIGHT: 1.2em; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>One notable exception is Visual Studio, where, with default settings, every volatile write has release semantics and every volatile read has acquire semantics (<A class="external text" style="TEXT-DECORATION: none; BACKGROUND: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIVJREFUeF6tjzsKg0AQhi09mimsFJLCzpNYCGKbK3gAtfUIljaCoKCCZIs8MMV2v+yCg8siWlh8zOtjhjEAEFmeIopDQtTrTJNEZIxhWysiNfULJFJjDzGnba/aBt4+wAuBzD+tg6a8SVkXf4GET96xmDxNzP39IvE/PPDtXIyVpYinv14A5F0laJ8oYFgAAAAASUVORK5CYII=) no-repeat right center; COLOR: rgb(51,102,187); PADDING-RIGHT: 13px" href="https://docs.microsoft.com/en-us/cpp/cpp/volatile-cpp" rel=nofollow>Microsoft Docs</A>), and thus volatiles may be used for inter-thread synchronization. Standard<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal"><SPAN class=kw4 style="COLOR: rgb(0,0,255)">volatile</SPAN></SPAN></SPAN><SPAN>&nbsp;</SPAN>semantics are not applicable to multithreaded programming, although they are sufficient for e.g. communication with a<SPAN>&nbsp;</SPAN><SPAN class=t-lc style='FONT-FAMILY: DejaVuSansMono, "DejaVu Sans Mono", courier, monospace !important'><A title=cpp/utility/program/signal style="TEXT-DECORATION: none; BACKGROUND: none transparent scroll repeat 0% 0%; COLOR: rgb(6,69,173)" href="https://en.cppreference.com/w/cpp/utility/program/signal">std::signal</A></SPAN><SPAN>&nbsp;</SPAN>handler that runs in the same thread when applied to<SPAN>&nbsp;</SPAN><SPAN class=t-c style="BORDER-TOP: rgb(214,214,214) 1px solid; BORDER-RIGHT: rgb(214,214,214) 1px solid; BORDER-BOTTOM: rgb(214,214,214) 1px solid; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 2px; BORDER-LEFT: rgb(214,214,214) 1px solid; MARGIN: 0px 2px; DISPLAY: inline-block; PADDING-RIGHT: 2px; border-radius: 3px"><SPAN class="mw-geshi cpp source-cpp" style="FONT-FAMILY: monospace; WHITE-SPACE: nowrap; LINE-HEIGHT: normal">sig_atomic_t</SPAN></SPAN><SPAN>&nbsp;</SPAN>variables.