<b> : </b>How to use range partitioning &amp; Citus sharding together for time series</H2>
<P style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 300; COLOR: rgb(51,51,51); FONT-STYLE: normal; TEXT-ALIGN: left; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>&nbsp;</P>
<P style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 300; COLOR: rgb(51,51,51); FONT-STYLE: normal; TEXT-ALIGN: left; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>If you work on an application that deals with time series data, specifically append-mostly time series data, you&#8217;ll likely find this post about<SPAN>&nbsp;</SPAN><A style="BOX-SIZING: border-box; TEXT-DECORATION: underline; COLOR: rgb(20,108,172); BACKGROUND-COLOR: transparent" href="https://www.citusdata.com/blog/2021/10/22/how-to-scale-postgres-for-time-series-data-with-citus/" rel="noopener nofollow noreferrer" target=_blank>using Postgres range partitioning and Citus sharding together</A><SPAN>&nbsp;</SPAN>to scale time series workloads to be useful additional reading.</P>
<P style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 300; COLOR: rgb(51,51,51); FONT-STYLE: normal; TEXT-ALIGN: left; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>&nbsp;</P>
<P style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 300; COLOR: rgb(51,51,51); FONT-STYLE: normal; TEXT-ALIGN: left; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>The time series post covers:</P>
<UL style='BOX-SIZING: border-box; FONT-SIZE: 16px; MARGIN-BOTTOM: 12px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; MARGIN-TOP: 0px; LIST-STYLE-POSITION: outside; TEXT-TRANSFORM: none; FONT-WEIGHT: 300; COLOR: rgb(51,51,51); FONT-STYLE: normal; TEXT-ALIGN: left; PADDING-LEFT: 2.5em; CLEAR: left; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>
<LI style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif'>Built-in Postgres partitioning</LI>
<LI style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif'>Citus UDFs that simplify partition management:<SPAN>&nbsp;</SPAN><CODE style='BOX-SIZING: border-box; FONT-SIZE: 12px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; COLOR: black; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; PADDING-LEFT: 4px; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(249,242,244); border-radius: 4px'>create_time_partitions</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE style='BOX-SIZING: border-box; FONT-SIZE: 12px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; COLOR: black; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; PADDING-LEFT: 4px; PADDING-RIGHT: 4px; BACKGROUND-COLOR: rgb(249,242,244); border-radius: 4px'>drop_old_time_partitions</CODE></LI>
<LI style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif'>Compression (if you use<SPAN>&nbsp;</SPAN><A style="BOX-SIZING: border-box; TEXT-DECORATION: underline; COLOR: rgb(20,108,172); BACKGROUND-COLOR: transparent" href="https://docs.citusdata.com/en/stable/admin_guide/table_management.html#columnar-storage" rel="noopener nofollow noreferrer" target=_blank>Citus columnar</A>)</LI>
<LI style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif'>Automation via<SPAN>&nbsp;</SPAN><A style="BOX-SIZING: border-box; TEXT-DECORATION: underline; COLOR: rgb(20,108,172); BACKGROUND-COLOR: transparent" href="https://github.com/citusdata/pg_cron" rel="noopener noreferrer" target=_blank>pg_cron</A></LI>
<LI style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif'>Sharding &amp; distributing across nodes with Citus</LI></UL>
<P style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 300; COLOR: rgb(51,51,51); FONT-STYLE: normal; TEXT-ALIGN: left; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>The bottom line of the<SPAN>&nbsp;</SPAN><A style="BOX-SIZING: border-box; TEXT-DECORATION: underline; COLOR: rgb(20,108,172); BACKGROUND-COLOR: transparent" href="https://www.citusdata.com/blog/2021/10/22/how-to-scale-postgres-for-time-series-data-with-citus/" rel="noopener nofollow noreferrer" target=_blank>time series blog post</A><SPAN>&nbsp;</SPAN>is that you can use Postgres built-in range partitioning to partition your tables by time ranges (super useful for time series data) and then&#8212;assuming your application needs more cpu and memory than you can get on a single node&#8212;you can also use Citus database sharding to distribute sharded partitions across a multi-node cluster.</P>
<P style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 300; COLOR: rgb(51,51,51); FONT-STYLE: normal; TEXT-ALIGN: left; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>&nbsp;</P>
<P style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 300; COLOR: rgb(51,51,51); FONT-STYLE: normal; TEXT-ALIGN: left; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'><SPAN class="lia-inline-image-display-wrapper lia-image-align-inline" style='BOX-SIZING: border-box; MAX-WIDTH: 100%; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WIDTH: 999px; POSITION: relative; DISPLAY: inline-block' image-alt="Figure 1: This diagram shows how you can use Postgres partitioning and sharding together for applications (such as time series) that can benefit from partitioning data BY RANGE and sharding those time-partitions across a multi-node cluster."><SPAN class="lia-message-image-wrapper lia-message-image-actions-narrow lia-message-image-actions-below" style='BOX-SIZING: border-box; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif'><IMG role=button tabIndex=0 class=lia-media-image style="BOX-SIZING: border-box; CURSOR: zoom-in; MAX-WIDTH: 100%; BORDER-TOP: 0px; HEIGHT: auto; BORDER-RIGHT: 0px; VERTICAL-ALIGN: middle; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; DISPLAY: block" alt="thumbnail image 1 captioned Figure 1: This diagram shows how you can use Postgres partitioning and sharding together for applications (such as time series) that can benefit from partitioning data BY RANGE and sharding those time-partitions across a multi-node cluster." src="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/495236iEA590C00DA7A1DDB/image-size/large?v=v2&amp;px=999" li-compiled="true" li-use-hover-links="false" li-bypass-lightbox-when-linked="true" li-bindable="" li-messages-message-image="true" li-message-uid="'3891629'" li-image-display-id="'495236iEA590C00DA7A1DDB'" li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/495236iEA590C00DA7A1DDB?v=v2"></SPAN><SPAN class=lia-inline-image-caption style='BOX-SIZING: border-box; FONT-SIZE: 14px; CURSOR: text; HEIGHT: auto; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; COLOR: rgb(102,102,102); FONT-STYLE: italic; TEXT-ALIGN: left; MARGIN: 10px 0px 20px; DISPLAY: block'>Figure 1: This diagram shows how you can use Postgres partitioning and sharding together for applications (such as time series) that can benefit from partitioning data BY RANGE and sharding those time-partitions across a multi-node cluster.</SPAN></SPAN></P>
<P style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: SegoeUI, Lato, "Helvetica Neue", Helvetica, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 300; COLOR: rgb(51,51,51); FONT-STYLE: normal; TEXT-ALIGN: left; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial'>&nbsp;