<b> : </b>Tip</H3>
<P style="BOX-SIZING: border-box; MARGIN-BOTTOM: 0px !important; MARGIN-TOP: 0px">A special heuristic is applied to determine whether a deduplication pass in a unique index should take place. It can often skip straight to splitting a leaf page, avoiding a performance penalty from wasting cycles on unhelpful deduplication passes. If you're concerned about the overhead of deduplication, consider setting<SPAN>&nbsp;</SPAN><CODE class=literal style="BOX-SIZING: border-box; FONT-SIZE: 1em; BORDER-TOP: medium none; FONT-FAMILY: monospace, monospace; BORDER-RIGHT: medium none; MARGIN-TOP: 0px; BORDER-BOTTOM: medium none; FONT-WEIGHT: 400; COLOR:  !important; PADDING-BOTTOM: 0px !important; PADDING-TOP: 0px !important; PADDING-LEFT: 0px !important; MARGIN-LEFT: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px !important; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">deduplicate_items = off</CODE><SPAN>&nbsp;</SPAN>selectively. Leaving deduplication enabled in unique indexes has little downside.</P></DIV>
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px">Deduplication cannot be used in all cases due to implementation-level restrictions. Deduplication safety is determined when<SPAN>&nbsp;</SPAN><CODE class=command style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">CREATE INDEX</CODE><SPAN>&nbsp;</SPAN>or<SPAN>&nbsp;</SPAN><CODE class=command style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">REINDEX</CODE><SPAN>&nbsp;</SPAN>is run.</P>
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px">Note that deduplication is deemed unsafe and cannot be used in the following cases involving semantically significant differences among equal datums:</P>
<DIV class=itemizedlist style="BOX-SIZING: border-box">
<UL class=itemizedlist style="LIST-STYLE-TYPE: disc; BOX-SIZING: border-box; MARGIN-TOP: 0px">
<LI class=listitem style="BOX-SIZING: border-box">
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-LEFT: 0px !important"><CODE class=type style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">text</CODE>,<SPAN>&nbsp;</SPAN><CODE class=type style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">varchar</CODE>, and<SPAN>&nbsp;</SPAN><CODE class=type style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">char</CODE><SPAN>&nbsp;</SPAN>cannot use deduplication when a<SPAN>&nbsp;</SPAN><SPAN class=emphasis style="BOX-SIZING: border-box"><EM style="BOX-SIZING: border-box; FONT-STYLE: italic">nondeterministic</EM></SPAN><SPAN>&nbsp;</SPAN>collation is used. Case and accent differences must be preserved among equal datums.</P></LI>
<LI class=listitem style="BOX-SIZING: border-box">
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-LEFT: 0px !important"><CODE class=type style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">numeric</CODE><SPAN>&nbsp;</SPAN>cannot use deduplication. Numeric display scale must be preserved among equal datums.</P></LI>
<LI class=listitem style="BOX-SIZING: border-box">
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-LEFT: 0px !important"><CODE class=type style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">jsonb</CODE><SPAN>&nbsp;</SPAN>cannot use deduplication, since the<SPAN>&nbsp;</SPAN><CODE class=type style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">jsonb</CODE><SPAN>&nbsp;</SPAN>B-Tree operator class uses<SPAN>&nbsp;</SPAN><CODE class=type style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">numeric</CODE><SPAN>&nbsp;</SPAN>internally.</P></LI>
<LI class=listitem style="BOX-SIZING: border-box">
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-LEFT: 0px !important"><CODE class=type style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">float4</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE class=type style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">float8</CODE><SPAN>&nbsp;</SPAN>cannot use deduplication. These types have distinct representations for<SPAN>&nbsp;</SPAN><CODE class=literal style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">-0</CODE><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><CODE class=literal style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">0</CODE>, which are nevertheless considered equal. This difference must be preserved.</P></LI></UL></DIV>
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px">There is one further implementation-level restriction that may be lifted in a future version of<SPAN>&nbsp;</SPAN><SPAN class=productname style="BOX-SIZING: border-box">PostgreSQL</SPAN>:</P>
<DIV class=itemizedlist style="BOX-SIZING: border-box">
<UL class=itemizedlist style="LIST-STYLE-TYPE: disc; BOX-SIZING: border-box; MARGIN-TOP: 0px">
<LI class=listitem style="BOX-SIZING: border-box">
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-LEFT: 0px !important">Container types (such as composite types, arrays, or range types) cannot use deduplication.</P></LI></UL></DIV>
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px">There is one further implementation-level restriction that applies regardless of the operator class or collation used:</P>
<DIV class=itemizedlist style="BOX-SIZING: border-box">
<UL class=itemizedlist style="LIST-STYLE-TYPE: disc; BOX-SIZING: border-box; MARGIN-TOP: 0px">
<LI class=listitem style="BOX-SIZING: border-box">
<P style="BOX-SIZING: border-box; MARGIN-TOP: 0px; MARGIN-LEFT: 0px !important"><CODE class=literal style="BOX-SIZING: border-box; FONT-SIZE: 1em; FONT-FAMILY: monospace, monospace; MARGIN-TOP: 0px; FONT-WEIGHT: 400; COLOR:  !important; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px; overflow-wrap: break-word; border-radius: 0.25rem">INCLUDE</CODE><SPAN>&nbsp;</SPAN>indexes can never use deduplication.</P></LI></UL></DIV></DIV>