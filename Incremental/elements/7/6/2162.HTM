<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Apart from its other technical merits, Apache Kafka&#174; is known for its scalability and performance. Given differing production environments and workloads, many users like to run benchmarking tests for purposes such as optimizing for throughput or for capacity planning.</FONT></P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>This page describes how to benchmark Kafka&#8217;s performance on the latest hardware in the cloud, in a repeatable and fully automated manner, and it documents the results from running these tests. The experiments focus on system throughput and system latency, as these are the primary performance metrics for event streaming systems in production. In particular, the throughput test measures how efficient Kafka is in utilizing the hardware, specifically the disks and the CPU. The latency test measures how close Kafka is to delivering real-time messaging including tail latencies of up to p99.9th percentile, a key requirement for real-time and mission-critical applications as well as microservices architectures.</FONT></P>
<H2 id=synopsis-of-testing style="BOX-SIZING: border-box; FONT-SIZE: 28px; FONT-FAMILY: Inter-Bold, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 500; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 100px 0px 40px; LETTER-SPACING: normal; LINE-HEIGHT: 35px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Synopsis of Testing</FONT><A tabIndex=-1 aria-hidden=true style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://developer.confluent.io/learn/kafka-performance/#synopsis-of-testing" data-original-href="#synopsis-of-testing"><SPAN class=header-link style="BOX-SIZING: border-box; FONT-SIZE: 14px; MARGIN-LEFT: 5px; opacity: 0"></SPAN></A></H2>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>We conducted benchmarking tests on Kafka and share the information here. The following sections first walk you through a summary of throughput and latency results, then describe the benchmarking framework, testbed, and the workloads. We will finish with a deeper explanation of the results using the various system and application metrics. All of these are<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://github.com/confluentinc/openmessaging-benchmark/" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://github.com/confluentinc/openmessaging-benchmark/"><FONT class=extract>open source</FONT></A><FONT class=extract>, so curious readers can reproduce the results for themselves or dig deeper into the collected Prometheus metrics. It is always recommended to compare using one&#8217;s own workloads and setups, to understand how the results below translate to production deployments.</FONT></P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>First, here is a summary of the conducted experiments.</FONT></P>
<TABLE style="BOX-SIZING: border-box; FONT-SIZE: 16px; OVERFLOW: auto; MAX-WIDTH: 100%; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WIDTH: 950px; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; BORDER-SPACING: 0px; ORPHANS: 2; WIDOWS: 2; DISPLAY: inline-block; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">
<TBODY style="BOX-SIZING: border-box">
<TR style="BOX-SIZING: border-box; BACKGROUND: rgb(255,255,255)">
<TD style="BOX-SIZING: border-box; BORDER-TOP: 1px solid; BORDER-RIGHT: 0px solid; BORDER-BOTTOM: 2px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 1em; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: 0px solid; PADDING-RIGHT: 1em; border-image: initial"><FONT class=extract><IMG style="BORDER-TOP-STYLE: none; BOX-SIZING: border-box; CURSOR: zoom-in; MAX-WIDTH: 100%; BORDER-LEFT-STYLE: none; WIDTH: auto; BORDER-BOTTOM-STYLE: none; POSITION: relative; BORDER-RIGHT-STYLE: none; LEFT: 0px; MIN-HEIGHT: 200px; MARGIN: auto; DISPLAY: block; transform: translateX(-50%)" alt="Kafka Throughput" src="https://images.contentful.com/gt6dp23g0g38/4HsVJ5JBcWi0rki2997vNV/c11ff3d6d4e2490d4b090b51edc15072/kafka-throughput-v2.png"></FONT></TD>
<TD style="BOX-SIZING: border-box; BORDER-TOP: 1px solid; BORDER-RIGHT: 0px solid; BORDER-BOTTOM: 2px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 1em; PADDING-TOP: 1em; PADDING-LEFT: 1em; BORDER-LEFT: 0px solid; PADDING-RIGHT: 1em; border-image: initial"><FONT class=extract><IMG style="BORDER-TOP-STYLE: none; BOX-SIZING: border-box; CURSOR: zoom-in; MAX-WIDTH: 100%; BORDER-LEFT-STYLE: none; WIDTH: auto; BORDER-BOTTOM-STYLE: none; POSITION: relative; BORDER-RIGHT-STYLE: none; LEFT: 0px; MIN-HEIGHT: 200px; MARGIN: auto; DISPLAY: block; transform: translateX(-50%)" alt="Kafka Latency" src="https://images.contentful.com/gt6dp23g0g38/1iUk2oJgsnFE37Dvu1OpZQ/cbc161daac1009ddd9ac49154d206815/unnamed-10.png"></FONT></TD></TR></TBODY></TABLE><SPAN style="FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FLOAT: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; DISPLAY: inline !important; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"></SPAN>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><EM style="BOX-SIZING: border-box"><FONT class=extract>Figures: Summary of results</FONT></EM></P>
<TABLE style="BOX-SIZING: border-box; FONT-SIZE: 16px; OVERFLOW: auto; MAX-WIDTH: 100%; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WIDTH: 950px; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-COLLAPSE: collapse; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; BORDER-SPACING: 0px; ORPHANS: 2; WIDOWS: 2; DISPLAY: inline-block; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">
<THEAD style="BOX-SIZING: border-box">
<TR style="BOX-SIZING: border-box; BACKGROUND: rgb(248,248,248)">
<TH style="BOX-SIZING: border-box; FONT-SIZE: 12px; BORDER-TOP: 1px solid; FONT-FAMILY: Inter-Medium, Arial, sans-serif; BORDER-RIGHT: 0px solid; BACKGROUND: rgb(255,255,255); BORDER-BOTTOM: 2px solid; TEXT-TRANSFORM: uppercase; FONT-WEIGHT: 500; COLOR: rgb(23,51,97); PADDING-BOTTOM: 0px; FONT-STYLE: normal; TEXT-ALIGN: left; PADDING-TOP: 0px; PADDING-LEFT: 15px; BORDER-LEFT: 0px solid; LETTER-SPACING: 0.1em; LINE-HEIGHT: 15px; PADDING-RIGHT: 15px; border-image: initial"><FONT class=extract></FONT></TH>
<TH style="BOX-SIZING: border-box; FONT-SIZE: 12px; BORDER-TOP: 1px solid; FONT-FAMILY: Inter-Medium, Arial, sans-serif; BORDER-RIGHT: 0px solid; BACKGROUND: rgb(255,255,255); BORDER-BOTTOM: 2px solid; TEXT-TRANSFORM: uppercase; FONT-WEIGHT: 500; COLOR: rgb(23,51,97); PADDING-BOTTOM: 0px; FONT-STYLE: normal; TEXT-ALIGN: left; PADDING-TOP: 0px; PADDING-LEFT: 15px; BORDER-LEFT: 0px solid; LETTER-SPACING: 0.1em; LINE-HEIGHT: 15px; PADDING-RIGHT: 15px; border-image: initial"><FONT class=extract>Result</FONT></TH></TR></THEAD>
<TBODY style="BOX-SIZING: border-box">
<TR style="BOX-SIZING: border-box; BACKGROUND: rgb(248,248,248)">
<TD style="BOX-SIZING: border-box; BORDER-TOP: 1px solid; BORDER-RIGHT: 0px solid; BORDER-BOTTOM: 2px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 15px; BORDER-LEFT: 0px solid; PADDING-RIGHT: 15px; border-image: initial"><FONT class=extract>Peak Throughput</FONT></TD>
<TD style="BOX-SIZING: border-box; BORDER-TOP: 1px solid; BORDER-RIGHT: 0px solid; BORDER-BOTTOM: 2px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 15px; BORDER-LEFT: 0px solid; PADDING-RIGHT: 15px; border-image: initial"><FONT class=extract>605 MB/s</FONT></TD></TR>
<TR style="BOX-SIZING: border-box">
<TD style="BOX-SIZING: border-box; BORDER-TOP: 1px solid; BORDER-RIGHT: 0px solid; BORDER-BOTTOM: 2px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 15px; BORDER-LEFT: 0px solid; PADDING-RIGHT: 15px; border-image: initial"><FONT class=extract>p99 Latency</FONT></TD>
<TD style="BOX-SIZING: border-box; BORDER-TOP: 1px solid; BORDER-RIGHT: 0px solid; BORDER-BOTTOM: 2px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 15px; BORDER-LEFT: 0px solid; PADDING-RIGHT: 15px; border-image: initial"><FONT class=extract>5 ms (200 MB/s load)</FONT></TD></TR></TBODY></TABLE><SPAN style="FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FLOAT: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; DISPLAY: inline !important; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"></SPAN>
<H2 id=benchmarking-setup style="BOX-SIZING: border-box; FONT-SIZE: 28px; FONT-FAMILY: Inter-Bold, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 500; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 100px 0px 40px; LETTER-SPACING: normal; LINE-HEIGHT: 35px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Benchmarking Setup</FONT><A tabIndex=-1 aria-hidden=true style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://developer.confluent.io/learn/kafka-performance/#benchmarking-setup" data-original-href="#benchmarking-setup"><SPAN class=header-link style="BOX-SIZING: border-box; FONT-SIZE: 14px; MARGIN-LEFT: 5px; opacity: 0"></SPAN></A></H2>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>The benchmarks were performed using<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://github.com/confluentinc/openmessaging-benchmark" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://github.com/confluentinc/openmessaging-benchmark"><FONT class=extract>this benchmarking code</FONT></A><FONT class=extract>. All tests deploy four worker instances to drive workload, three broker/server instances, a three-instance Apache ZooKeeper cluster for Kafka, and one instance that runs the monitoring setup (e.g., Prometheus). The network/storage-optimized class of Amazon EC2 instances was selected with enough CPU cores and network bandwidth to support disk I/O bound workloads. In the sections below, any changes made to the baseline configurations are called out.</FONT></P>
<H3 id=disks style="BOX-SIZING: border-box; FONT-SIZE: 22px; FONT-FAMILY: Inter-Bold, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 500; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 100px 0px 40px; LETTER-SPACING: normal; LINE-HEIGHT: 27px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Disks</FONT><A tabIndex=-1 aria-hidden=true style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://developer.confluent.io/learn/kafka-performance/#disks" data-original-href="#disks"><SPAN class=header-link style="BOX-SIZING: border-box; FONT-SIZE: 14px; MARGIN-LEFT: 5px; opacity: 0"></SPAN></A></H3>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>The<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://aws.amazon.com/ec2/instance-types/i3en/" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://aws.amazon.com/ec2/instance-types/i3en/"><FONT class=extract>i3en.2xlarge</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>instance type (with 8 vCores, 64 GB RAM, 2 x 2,500 GB NVMe SSDs) was selected for its high 25 Gbps network transfer limit that ensures that the test setup is not network bound. This means that the tests measure the respective maximum server performance measures, not simply how fast the network is.<SPAN>&nbsp;</SPAN><SPAN class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; FONT-WEIGHT: 400; COLOR: rgb(216,54,93); PADDING-BOTTOM: 0.1em; PADDING-TOP: 0.1em; PADDING-LEFT: 0.1em; LINE-HEIGHT: 26px; PADDING-RIGHT: 0.1em; border-radius: 4px'>i3en.2xlarge</SPAN><SPAN>&nbsp;</SPAN>instances support up to ~655 MB/s of write throughput across two disks, which is plenty to stress the servers. See the full<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://aws.amazon.com/ec2/instance-types/i3en/" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://aws.amazon.com/ec2/instance-types/i3en/"><FONT class=extract>instance type definition</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>for details.</FONT></P>
<DIV style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract><IMG style="BORDER-TOP-STYLE: none; BOX-SIZING: border-box; CURSOR: zoom-in; MAX-WIDTH: 100%; BORDER-LEFT-STYLE: none; HEIGHT: auto; MIN-WIDTH: 300px; BORDER-BOTTOM-STYLE: none; POSITION: relative; BORDER-RIGHT-STYLE: none; LEFT: 0px; MARGIN: auto; DISPLAY: block; transform: translateX(-50%)" alt="Kafka Performance: Disk IO" src="https://images.contentful.com/gt6dp23g0g38/2ch8jGPvYmBgZ2xM5iwnRg/b6736e6937d89657318cab4c26a78de5/unnamed-5.png"></FONT></DIV>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><EM style="BOX-SIZING: border-box"><FONT class=extract>Figure 1. Establishing the maximum disk bandwidth of<SPAN>&nbsp;</SPAN><SPAN class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; FONT-WEIGHT: 400; COLOR: rgb(216,54,93); PADDING-BOTTOM: 0.1em; PADDING-TOP: 0.1em; PADDING-LEFT: 0.1em; LINE-HEIGHT: 26px; PADDING-RIGHT: 0.1em; border-radius: 4px'>i3en.2xlarge</SPAN><SPAN>&nbsp;</SPAN>instances across two disks, tested using the<SPAN>&nbsp;</SPAN><SPAN class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; FONT-WEIGHT: 400; COLOR: rgb(216,54,93); PADDING-BOTTOM: 0.1em; PADDING-TOP: 0.1em; PADDING-LEFT: 0.1em; LINE-HEIGHT: 26px; PADDING-RIGHT: 0.1em; border-radius: 4px'>dd</SPAN><SPAN>&nbsp;</SPAN>Linux command, to serve as a north star for throughput tests</FONT></EM></P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>The maximum disk bandwidth of the selected instances was established with the following<SPAN>&nbsp;</SPAN><SPAN class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; FONT-WEIGHT: 400; COLOR: rgb(216,54,93); PADDING-BOTTOM: 0.1em; PADDING-TOP: 0.1em; PADDING-LEFT: 0.1em; LINE-HEIGHT: 26px; PADDING-RIGHT: 0.1em; border-radius: 4px'>dd</SPAN><SPAN>&nbsp;</SPAN>Linux commands, which is a metric of the environment setup that we need for e.g. interpreting the benchmarking results:</FONT></P>
<DIV class=gatsby-highlight style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; POSITION: relative; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial" data-language="text">
<DIV class=copy-container style="BOX-SIZING: border-box; CURSOR: pointer; RIGHT: 10px; POSITION: absolute; COLOR: rgb(130,148,148); DISPLAY: flex; TOP: 10px; align-items: center" data-block="1"><SPAN class=copy style="BOX-SIZING: border-box"><FONT class=extract><IMG class=no-zoom style="BORDER-TOP-STYLE: none; BOX-SIZING: border-box; CURSOR: inherit; MAX-WIDTH: 100%; BORDER-LEFT-STYLE: none; HEIGHT: auto; WIDTH: auto; BORDER-BOTTOM-STYLE: none; BORDER-RIGHT-STYLE: none; LEFT: auto; MARGIN: auto; DISPLAY: block; transform: none; margin-inline-end: 2px" src="https://developer.confluent.io/images/icons/icon-copy.svg">Copy</FONT></SPAN></DIV><PRE class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 12px; OVERFLOW: auto; MAX-WIDTH: 100%; FONT-FAMILY: Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace; BACKGROUND: rgb(245,242,240); WHITE-SPACE: pre; WORD-SPACING: normal; WORD-BREAK: normal; COLOR: rgb(0,0,0); PADDING-BOTTOM: 25px; TEXT-ALIGN: left; PADDING-TOP: 40px; PADDING-LEFT: 25px; MARGIN: 0.5em 0px; LINE-HEIGHT: 1.5; PADDING-RIGHT: 25px; overflow-wrap: normal; hyphens: none; tab-size: 4; text-shadow: rgb(255, 255, 255) 0px 1px'><SPAN class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0.1em; PADDING-TOP: 0.1em; PADDING-LEFT: 0.1em; LINE-HEIGHT: 26px; PADDING-RIGHT: 0.1em; BACKGROUND-COLOR: transparent; border-radius: 4px'><FONT class=extract>Disk 1
dd if=/dev/zero of=/mnt/data-1/test bs=1M count=65536 oflag=direct
65536+0 records in
65536+0 records out
68719476736 bytes (69 GB) copied, 210.278 s, 327 MB/s

Disk 2
dd if=/dev/zero of=/mnt/data-2/test bs=1M count=65536 oflag=direct
65536+0 records in
65536+0 records out
68719476736 bytes (69 GB) copied, 209.594 s, 328 MB/s</FONT></SPAN></PRE></DIV>
<H3 id=os-tuning style="BOX-SIZING: border-box; FONT-SIZE: 22px; FONT-FAMILY: Inter-Bold, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 500; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 100px 0px 40px; LETTER-SPACING: normal; LINE-HEIGHT: 27px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>OS tuning</FONT><A tabIndex=-1 aria-hidden=true style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://developer.confluent.io/learn/kafka-performance/#os-tuning" data-original-href="#os-tuning"><SPAN class=header-link style="BOX-SIZING: border-box; FONT-SIZE: 14px; MARGIN-LEFT: 5px; opacity: 0"></SPAN></A></H3>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Similar to what many system administrators do for Kafka production environments, we optimized several OS settings. Specifically, the OS was tuned for better latency performance using<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/power_management_guide/tuned-adm" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/power_management_guide/tuned-adm"><FONT class=extract>tuned-adm</FONT></A><FONT class=extract>&#8217;s latency performance profile, which disables any dynamic tuning mechanisms for disk and network schedulers and uses the performance governor for CPU frequency tuning. It pegs the p-states at the highest possible frequency for each core, and it sets the I/O scheduler to the<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/performance_tuning_guide/ch06s04s02" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/performance_tuning_guide/ch06s04s02"><FONT class=extract>deadline</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>to offer a predictable upper bound on disk request latency. Finally, it also tunes the<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://www.kernel.org/doc/html/v5.0/admin-guide/pm/cpuidle.html#power-management-quality-of-service-for-cpus" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://www.kernel.org/doc/html/v5.0/admin-guide/pm/cpuidle.html#power-management-quality-of-service-for-cpus"><FONT class=extract>power management quality of service</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>(QoS) in the kernel for performance over power savings.</FONT></P>
<H2 id=throughput-test style="BOX-SIZING: border-box; FONT-SIZE: 28px; FONT-FAMILY: Inter-Bold, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 500; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 100px 0px 40px; LETTER-SPACING: normal; LINE-HEIGHT: 35px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Throughput test</FONT><A tabIndex=-1 aria-hidden=true style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://developer.confluent.io/learn/kafka-performance/#throughput-test" data-original-href="#throughput-test"><SPAN class=header-link style="BOX-SIZING: border-box; FONT-SIZE: 14px; MARGIN-LEFT: 5px; opacity: 0"></SPAN></A></H2>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>The first measurement was to determine the peak stable throughput that Kafka could achieve. Peak stable throughput is defined as the highest average producer throughput at which consumers can keep up without an ever-growing backlog.</FONT></P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>The experiment was designed according to the following principles and expected guarantees:</FONT></P>
<UL style="LIST-STYLE-TYPE: disc; BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; LIST-STYLE-POSITION: outside; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0px 40px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">
<LI style="BOX-SIZING: border-box; MARGIN: 20px 0px"><FONT class=extract>Kafka was configured with<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box; FONT-WEIGHT: bolder">100 partitions</STRONG><SPAN>&nbsp;</SPAN>across one topic. </FONT>
<LI style="BOX-SIZING: border-box; MARGIN: 20px 0px"><FONT class=extract>Messages are<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box; FONT-WEIGHT: bolder">replicated 3x</STRONG><SPAN>&nbsp;</SPAN>for fault tolerance (see below for specific configs). </FONT>
<LI style="BOX-SIZING: border-box; MARGIN: 20px 0px"><FONT class=extract>Batching was enabled to optimize for throughput. Up to<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box; FONT-WEIGHT: bolder">1 MB</STRONG><SPAN>&nbsp;</SPAN>of data is batched for a maximum of<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box; FONT-WEIGHT: bolder">10 ms</STRONG>.</FONT></LI></UL>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Kafka delivered high throughput, near-saturating the disk I/O available in the testbed. Given its design, each byte produced was written just once onto disk on a code path that has been optimized for almost a decade by thousands of organizations across the world.</FONT></P>
<DIV style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract><IMG style="BORDER-TOP-STYLE: none; BOX-SIZING: border-box; CURSOR: zoom-in; MAX-WIDTH: 100%; BORDER-LEFT-STYLE: none; WIDTH: auto; BORDER-BOTTOM-STYLE: none; POSITION: relative; BORDER-RIGHT-STYLE: none; LEFT: 0px; MIN-HEIGHT: 200px; MARGIN: auto; DISPLAY: block; transform: translateX(-50%)" alt="Kafka Throughput" src="https://images.contentful.com/gt6dp23g0g38/4HsVJ5JBcWi0rki2997vNV/c11ff3d6d4e2490d4b090b51edc15072/kafka-throughput-v2.png"></FONT></DIV>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><EM style="BOX-SIZING: border-box"><FONT class=extract>Figure 2. Peak stable throughput of Kafka: 100 topic partitions with 1 KB messages, using four producers and four consumers against a three-node Kafka cluster</FONT></EM></P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Kafka was configured to use<SPAN>&nbsp;</SPAN><SPAN class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; FONT-WEIGHT: 400; COLOR: rgb(216,54,93); PADDING-BOTTOM: 0.1em; PADDING-TOP: 0.1em; PADDING-LEFT: 0.1em; LINE-HEIGHT: 26px; PADDING-RIGHT: 0.1em; border-radius: 4px'>batch.size=1MB</SPAN><SPAN>&nbsp;</SPAN>and<SPAN>&nbsp;</SPAN><SPAN class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; FONT-WEIGHT: 400; COLOR: rgb(216,54,93); PADDING-BOTTOM: 0.1em; PADDING-TOP: 0.1em; PADDING-LEFT: 0.1em; LINE-HEIGHT: 26px; PADDING-RIGHT: 0.1em; border-radius: 4px'>linger.ms=10</SPAN><SPAN>&nbsp;</SPAN>for the producer to effectively batch writes sent to the brokers. In addition,<SPAN>&nbsp;</SPAN><SPAN class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; FONT-WEIGHT: 400; COLOR: rgb(216,54,93); PADDING-BOTTOM: 0.1em; PADDING-TOP: 0.1em; PADDING-LEFT: 0.1em; LINE-HEIGHT: 26px; PADDING-RIGHT: 0.1em; border-radius: 4px'>acks=all</SPAN><SPAN>&nbsp;</SPAN>was configured in the producer along with<SPAN>&nbsp;</SPAN><SPAN class=language-text style='BOX-SIZING: border-box; FONT-SIZE: 14px; FONT-FAMILY: Menlo, Monaco, Consolas, "Courier New", monospace; FONT-WEIGHT: 400; COLOR: rgb(216,54,93); PADDING-BOTTOM: 0.1em; PADDING-TOP: 0.1em; PADDING-LEFT: 0.1em; LINE-HEIGHT: 26px; PADDING-RIGHT: 0.1em; border-radius: 4px'>min.insync.replicas=2</SPAN><SPAN>&nbsp;</SPAN>to ensure every message was replicated to at least two brokers before acknowledging it back to the producer. Kafka was able to efficiently max out both the disks on each of the brokers&#8212;the ideal outcome for a storage system. See Kafka's<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://github.com/confluentinc/openmessaging-benchmark/blob/master/driver-kafka/kafka-group-all.yaml" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://github.com/confluentinc/openmessaging-benchmark/blob/master/driver-kafka/kafka-group-all.yaml"><FONT class=extract>driver configuration</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>for details.</FONT></P>
<DIV style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract><IMG style="BORDER-TOP-STYLE: none; BOX-SIZING: border-box; CURSOR: zoom-in; MAX-WIDTH: 100%; BORDER-LEFT-STYLE: none; HEIGHT: auto; MIN-WIDTH: 250px; BORDER-BOTTOM-STYLE: none; POSITION: relative; BORDER-RIGHT-STYLE: none; LEFT: 0px; MARGIN: auto; DISPLAY: block; transform: translateX(-50%)" alt="Kafka Producer/Consumer Throughput" src="https://images.contentful.com/gt6dp23g0g38/4TAQDRZUX42aI4DFfFp4Um/e39cafd87fba7f8aab5ee6795b79e3fe/unnamed-7.png"></FONT></DIV>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><EM style="BOX-SIZING: border-box"><FONT class=extract>Figure 3. The graph shows I/O utilization on Kafka brokers and the corresponding producer/consumer throughput (source: Prometheus node metrics). See<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://github.com/confluentinc/openmessaging-benchmark/blob/master/blog/results/kafka/throughput/default-sync.json" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://github.com/confluentinc/openmessaging-benchmark/blob/master/blog/results/kafka/throughput/default-sync.json"><FONT class=extract>raw results</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>for details.</FONT></EM></P>
<H2 id=latency-test style="BOX-SIZING: border-box; FONT-SIZE: 28px; FONT-FAMILY: Inter-Bold, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 500; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 100px 0px 40px; LETTER-SPACING: normal; LINE-HEIGHT: 35px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Latency test</FONT><A tabIndex=-1 aria-hidden=true style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://developer.confluent.io/learn/kafka-performance/#latency-test" data-original-href="#latency-test"><SPAN class=header-link style="BOX-SIZING: border-box; FONT-SIZE: 14px; MARGIN-LEFT: 5px; opacity: 0"></SPAN></A></H2>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Given the ever-growing popularity of stream processing and event-driven architectures, another key aspect of messaging systems is end-to-end latency for a message to traverse the pipeline from the producer through the system to the consumer. A useful experiment is therefore to measure the highest stable throughput that Kafka can sustain without showing any signs of over-utilization.</FONT></P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>To optimize for latency, the producer configuration was configured to batch messages up to a maximum of 1 ms only (versus the 10 ms used for throughput tests), and to also leave Kafka at its default recommended configuration while ensuring high availability. Kafka was configured to use its default fsync settings (i.e., fsync off). Based on repeated runs, it was decided to measure Kafka&#8217;s latency at<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box; FONT-WEIGHT: bolder">200K messages/s</STRONG><SPAN>&nbsp;</SPAN>or<SPAN>&nbsp;</SPAN><STRONG style="BOX-SIZING: border-box; FONT-WEIGHT: bolder">200 MB/s</STRONG>, which is below the single disk throughput limit of 300 MB/s on this testbed.</FONT></P>
<DIV style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract><IMG style="BORDER-TOP-STYLE: none; BOX-SIZING: border-box; CURSOR: zoom-in; MAX-WIDTH: 100%; BORDER-LEFT-STYLE: none; WIDTH: auto; BORDER-BOTTOM-STYLE: none; POSITION: relative; BORDER-RIGHT-STYLE: none; LEFT: 0px; MIN-HEIGHT: 200px; MARGIN: auto; DISPLAY: block; transform: translateX(-50%)" alt="Kafka Latency" src="https://images.contentful.com/gt6dp23g0g38/1iUk2oJgsnFE37Dvu1OpZQ/cbc161daac1009ddd9ac49154d206815/unnamed-10.png"></FONT></DIV>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><EM style="BOX-SIZING: border-box"><FONT class=extract>Figure 4. End-to-end latency for Kafka, measured at 200K messages/s (1 KB message size). See the<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://github.com/confluentinc/openmessaging-benchmark/tree/master/blog/results/kafka/latency" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://github.com/confluentinc/openmessaging-benchmark/tree/master/blog/results/kafka/latency"><FONT class=extract>raw results</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>for details. Note: Latency (ms)&#8212;lower is better.</FONT></EM></P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Kafka consistently delivered low latencies. Since the experiment was deliberately set up so that consumers were always able to keep up with the producers, all of the reads were served off of the cache.</FONT></P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Much of Kafka&#8217;s performance can be attributed to a heavily optimized read implementation for consumers, built on efficient data organization, without any additional overheads like data skipping. Kafka deeply leverages the Linux page cache and<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://www.linuxjournal.com/article/6345" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://www.linuxjournal.com/article/6345"><FONT class=extract>zero-copy</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>mechanism to avoid copying data into user space. Typically many systems, like databases, have built out application-level caches that give them more flexibility to support random read/write workloads. However, for a messaging system, relying on the page cache is a great choice because typical workloads do sequential read/writes. The Linux kernel has been optimized for many years to be smart about detecting these patterns and employ techniques like readahead to vastly improve read performance. Similarly, building on top of the page cache allows Kafka to employ<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://man7.org/linux/man-pages/man2/sendfile.2.html" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://man7.org/linux/man-pages/man2/sendfile.2.html"><FONT class=extract>sendfile-based</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>network transfers that avoid additional data copies.</FONT></P>
<H2 id=where-to-go-from-here--further-resources style="BOX-SIZING: border-box; FONT-SIZE: 28px; FONT-FAMILY: Inter-Bold, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 500; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 100px 0px 40px; LETTER-SPACING: normal; LINE-HEIGHT: 35px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>Where To Go From Here &amp; Further Resources</FONT><A tabIndex=-1 aria-hidden=true style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://developer.confluent.io/learn/kafka-performance/#where-to-go-from-here--further-resources" data-original-href="#where-to-go-from-here--further-resources"><SPAN class=header-link style="BOX-SIZING: border-box; FONT-SIZE: 14px; MARGIN-LEFT: 5px; opacity: 0"></SPAN></A></H2>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>If you are interested in running your own benchmarks in a repeatable and fully automated manner, the<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://github.com/confluentinc/openmessaging-benchmark" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://github.com/confluentinc/openmessaging-benchmark"><FONT class=extract>benchmarking code is publicly available</FONT></A><FONT class=extract><SPAN>&nbsp;</SPAN>and can be used to run the performance experiments described in the previous sections.</FONT></P>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>To learn more about Kafka&#8217;s performance, benchmarking, and tuning:</FONT></P>
<UL style="LIST-STYLE-TYPE: disc; BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; LIST-STYLE-POSITION: outside; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); PADDING-BOTTOM: 0px; FONT-STYLE: normal; PADDING-TOP: 0px; PADDING-LEFT: 0px; ORPHANS: 2; WIDOWS: 2; MARGIN: 0px 0px 0px 40px; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial">
<LI style="BOX-SIZING: border-box; MARGIN: 20px 0px"><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://assets.confluent.io/m/2d7c883a8aa6a71d/original/20200501-WP-Benchmark_Your_Dedicated_Apache_Kafka_Cluster_on_Confluent_Cloud.pdf" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://assets.confluent.io/m/2d7c883a8aa6a71d/original/20200501-WP-Benchmark_Your_Dedicated_Apache_Kafka_Cluster_on_Confluent_Cloud.pdf"><FONT class=extract>Benchmark Your Dedicated Apache Kafka&#174; Cluster on Confluent Cloud</FONT></A><FONT class=extract> </FONT>
<LI style="BOX-SIZING: border-box; MARGIN: 20px 0px"><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://engineering.linkedin.com/kafka/benchmarking-apache-kafka-2-million-writes-second-three-cheap-machines" rel="nofollow noopener noreferrer" target=_blank data-original-href="https://engineering.linkedin.com/kafka/benchmarking-apache-kafka-2-million-writes-second-three-cheap-machines"><FONT class=extract>Benchmarking Apache Kafka&#174;: 2 Million Writes Per Second (On Three Cheap Machines)</FONT></A></LI></UL>
<P style="BOX-SIZING: border-box; FONT-SIZE: 16px; FONT-FAMILY: Inter-Regular, Arial, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(21,32,43); FONT-STYLE: normal; ORPHANS: 2; WIDOWS: 2; MARGIN: 15px 0px; LETTER-SPACING: normal; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial"><FONT class=extract>To learn more about other types of testing for your Kafka applications and the ecosystem of related tools, see<SPAN>&nbsp;</SPAN></FONT><A style="BOX-SIZING: border-box; TEXT-DECORATION: none; COLOR: rgb(37,123,215); BACKGROUND-COLOR: transparent" href="https://developer.confluent.io/learn/testing-kafka" data-original-href="/learn/testing-kafka"><FONT class=extract>Testing Apache Kafka&#174;</FONT></A><FONT class=extract>.</FONT>